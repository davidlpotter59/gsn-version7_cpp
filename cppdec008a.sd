%%
/*
Date Written: October 24, 2011

Name: cppdec008a.sd -- commercial inland marine dec page

Copyright (c) 2000, SCIPS.com Inc.

Modify
Date                   By                  Comment
--------------------------------------------------------------
10/24/2011             JLB            commercial inland marine dec for starr
===========================
*/

Program
  Name = "cppdec008a";
  Type = "File";
  Domain = "SFPPRINT1";
  Padcharacter = Space;

 String L_FILE_NAME[13] = "cppdec008a.cq";
 String L_COPY_NAME[20] ;
 String I_REV_NAME2[50] ;
 String L_POLICY_FORM;
 String L_TYPE_STR[50];
 String L_POLICY_DECLARATION[60];
 String L_TRANS_EFF;
 String L_AUDIT;
 String L_PREV_STRING[9];
 String L_INSURED_CITY_STATE[50];
 String L_SFPNAME_ZIP="";
 String L_SFSAGENT;
 string l_first[1]="Y";
 string l_font[35]="" ;
 String L_SFSMORT_ZIP[10];
 String L_SFPSUPP_ZIP[10];
 String L_AGENT_ADDRESS;
 String L_FOB[75];
 String L_AGENT_TEL[13];
 String L_AGENT_ZIP[10];
 String L_MORGAGE_ID[10];
 String L_COMPANY_ID[10];
 String L_LOB_CODE[10];
 String L_MORTGAGE_TYPE_1[1];
 String L_BILL_PLAN[2];
 String L_STATE;
 String L_COMPANY_ZIP[10];
 String L_SFPLOCATION_ZIP[10];
 String L_TERROR_FORM[7];
 String L_EXPOSURE_BASE[2];
 String L_MORTGAGE_TYPE_2[1];

 Number L_TRANS_CODE;
 Number L_MM_1;
 Number L_DD_1;
 Number L_YY_1;
 Number L_RENEWAL[9];

 unsigned ascii number l_sub_code[4]=0;
 Unsigned Ascii Number L_DO_MORT[1];
 Unsigned Ascii Number L_SUPPLEMENTAL_SWITCH;
 Unsigned Ascii Number L_DECIPOINT;
 Unsigned Ascii Number L_CHARACTER_PER_INCH;
 Unsigned Ascii Number L_PAGE_MIDDLE;
 Unsigned Ascii Number L_HALF_MULTIPLIER;
 Unsigned Ascii Number L_no_locations[4]=0;
 Unsigned Ascii Number L_CHAR_MULTIPLIER[10]/decimals=4;
 Unsigned Ascii Number L_PAGE_NUMBER = 1;
 Unsigned Ascii Number L_ITEM_COUNTER;
 Unsigned Ascii Number L_LINE_COUNTER/decimals=2;
 Unsigned Ascii Number L_MED_LIMIT;
 Unsigned Ascii Number L_S_LINE_FOR_AGENT = 0; --start line for agent
 Unsigned Ascii Number L_S_LINE_FOR_LOCATION = 0; --start line for location
 Unsigned Ascii Number L_BIGGER_LINE =0;
 Unsigned Ascii Number L_SCREEN_COR= 0;
 Unsigned Ascii Number L_E_LINE_FOR_INSURED = 0;
 Unsigned Ascii Number L_PAGENUMBER;
 Unsigned Ascii Number L_MAX_LINES[60];
 Unsigned Ascii Number L_LOCATION_COUNTER;
 Unsigned Ascii Number L_SIZE_COUNTER;
 Unsigned Ascii Number L_LIABILITY;
 Unsigned Ascii Number L_LINE_OF_BUSINESS[4];
 Unsigned Ascii Number L_INSURED_COUNTER;
 Unsigned Ascii Number L_AGENT_COUNTER;
 Unsigned Ascii Number L_TWO_PLACER;
 Unsigned Ascii Number L_SFSFORM[2];
 Unsigned Ascii Number L_SFSEND_FORM[2];
 Unsigned Ascii Number L_SFPMASTER_FORM[1];
 Unsigned Ascii Number L_LOOP;
 Unsigned Ascii Number L_TOTAL[9];
 Unsigned Ascii Number L_STATE2[2];
 Unsigned Ascii Number L_COUNTY[3];
 Unsigned Ascii Number I_STATE[2];
 Unsigned Ascii Number L_SUBTOTAL_PREM[9];
 Unsigned Ascii Number L_SUBTOTAL_PRCO[9];
 Unsigned Ascii Number L_BLANKET_SWITCH[1];
 signed ascii number L_OPTIONAL_COVERAGES[9];
 String L_STATE_STR[2];

 Unsigned Ascii Number L_ADD_SPACE[4];
 Unsigned Ascii Number L_FORM[2];
 String L_VERT_POS_1[5];
 String L_NEWLINE;
 String L_SIGNATURE_STRING[100];
 Wdate L_MESSAGE_EFF_DATE;
 Wdate L_MESSAGE_EXP_DATE;

 Include "csfonts.inc"
 Include "sfsrevname.var"
 Include "header.var"
 Include "line_spacing.var"

Initialization
Deletefile (L_FILE_NAME);

L_COPY_NAME = Uppercase(COMMANDLINE[1,20])

Update

Access SFPNAME,
   Set SFPNAME:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPNAME:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPNAME:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

access sfscompany,
   set sfscompany:company_id = sfpname:company_id, generic

L_LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS

Access CPPGENERAL ,
   Set CPPGENERAL:POLICY_NO    = SFPPRINT1:POLICY_NO,
       CPPGENERAL:POL_YEAR     = SFPPRINT1:POL_YEAR,
       CPPGENERAL:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access CPPINLAND ,
   Set CPPINLAND:POLICY_NO    = SFPPRINT1:POLICY_NO,
       CPPINLAND:POL_YEAR     = SFPPRINT1:POL_YEAR,
       CPPINLAND:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPMASTER,
   Set SFPMASTER:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPMASTER:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPMASTER:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access CPPLIABILITY,
   Set CPPLIABILITY:POLICY_NO    = SFPPRINT1:POLICY_NO,
       CPPLIABILITY:POL_YEAR     = SFPPRINT1:POL_YEAR,
       CPPLIABILITY:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPLOCATION,
   Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPEND,
   Set SFPEND:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPEND:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPEND:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPPRINT3,
   Set SFPPRINT3:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPPRINT3:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPPRINT3:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

L_COMPANY_ID = SFPNAME:COMPANY_ID
L_STATE2 = SFPMASTER:STATE
L_COUNTY = CPPLIABILITY:COUNTY

Access SFPSUPP,
   Set SFPSUPP:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPSUPP:POL_YEAR     = SFPPRINT1:POL_YEAR ,
       SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic;

Access SFSCOMPANY,
   Set SFSCOMPANY:COMPANY_ID = SFPNAME:COMPANY_ID, Exact

Access SFPCURRENT,
   Set SFPCURRENT:POLICY_NO = SFPPRINT1:POLICY_NO, Exact

Access SFSLINE,
   Set SFSLINE:COMPANY_ID       = L_COMPANY_ID,
       SFSLINE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS,
       sfsline:lob_subline      = "00", exact

Access SFSLINE2,
   Set SFSLINE2:COMPANY_ID       = L_COMPANY_ID,
       SFSLINE2:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS,
       sfsline2:lob_subline      = "00", exact

Access SFSAGENT,
   Set SFSAGENT:COMPANY_ID = SFPNAME:COMPANY_ID,
       SFSAGENT:AGENT_NO   = SFPNAME:AGENT_NO, Exact

Access SFSSTATE,
   Set SFSSTATE:COMPANY_ID = L_COMPANY_ID,
       SFSSTATE:STATE      = L_STATE2,
       SFSSTATE:COUNTY     = L_COUNTY, Exact

L_SFSFORM = SFPMASTER:FORM

L_LOB_CODE = SFSLINE:LOB_CODE

I_STATE = SFPMASTER:STATE

Access SCIPSCONTROL,
   Set SCIPSCONTROL:COMPANY_ID          = L_COMPANY_ID,
       SCIPSCONTROL:STATE               = I_STATE,
       SCIPSCONTROL:LOB_CODE            = L_LOB_CODE, generic

if scipscontrol:AGENT_PRINT_COPY_NAME <> "" and
   (l_copy_name = "AGENTS COPY" or
    l_copy_name = "AGENT COPY") then
  {
    l_copy_name = trun(scipscontrol:AGENT_PRINT_COPY_NAME) + " COPY"
  }

Access SFSMESSAGE,
   Set SFSMESSAGE:COMPANY_ID       = L_COMPANY_ID,
       SFSMESSAGE:STATE            = L_STATE2,
       SFSMESSAGE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS, generic

while SFSMESSAGE:COMPANY_ID       = SFPNAME:COMPANY_ID and
      SFSMESSAGE:STATE            = L_STATE2 and
      SFSMESSAGE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS
        begin
        if sfpname:eff_date <= sfsmessage:exp_date and
           sfpname:eff_date >= sfsmessage:eff_date then
            begin
            L_message_eff_date = sfsmessage:eff_date
            L_message_exp_date = sfsmessage:exp_date
            end
        else
            begin
            l_message_eff_date = 0
            l_message_exp_date = 0
            end

        Next SFSMESSAGE
        end

Access SFSMESSAGE,
   Set SFSMESSAGE:COMPANY_ID       = L_COMPANY_ID,
       SFSMESSAGE:STATE            = L_STATE2,
       SFSMESSAGE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS,
       SFSMESSAGE:EFF_DATE         = L_MESSAGE_EFF_DATE,
       SFSMESSAGE:EXP_DATE         = L_MESSAGE_EXP_DATE, generic


L_PREV_STRING = If (SFPNAME:PREVIOUS_POLICY_NO <> 0) Then
                   Str(SFPNAME:PREVIOUS_POLICY_NO)
               Else
                   Str(SFPNAME:POLICY_NO)

L_POLICY_DECLARATION = Trun(SFSLINE:DESCRIPTION) + " " + "POLICY DECLARATIONS"

L_AGENT_TEL = SFSAGENT:TELEPHONE[1];

L_SFSAGENT = If (Val(SFSAGENT:ZIPCODE_1_4) = 0) Then
                      SFSAGENT:ZIPCODE_5_9
                    Else
                      SFSAGENT:ZIPCODE_5_9 + "-" + SFSAGENT:ZIPCODE_1_4

L_SFPNAME_ZIP = If (Val(SFPNAME:STR_ZIPCODE[6,9]) = 0) Then
                        SFPNAME:STR_ZIPCODE[1,5]
                        Else
                        SFPNAME:STR_ZIPCODE[1,5] + "-" +
                        SFPNAME:STR_ZIPCODE[6,9]

L_INSURED_CITY_STATE = Trun(SFPNAME:CITY) + ", " + SFPNAME:STR_STATE + "  " + L_SFPNAME_ZIP

L_AGENT_ZIP =  If (Val(SFSAGENT:STR_ZIPCODE[6,9]) = 0) Then
                  SFSAGENT:STR_ZIPCODE[1,5]
                  Else
                  SFSAGENT:STR_ZIPCODE[1,5] + "-" +
                  SFSAGENT:STR_ZIPCODE[6,9]

L_COMPANY_ZIP =  If (Val(SFSCOMPANY:STR_ZIPCODE[6,9]) = 0) Then
                       SFSCOMPANY:STR_ZIPCODE[1,5]
                     Else
                       SFSCOMPANY:STR_ZIPCODE[1,5] + "-" +
                       SFSCOMPANY:STR_ZIPCODE[6,9]

L_COMPANY_ID = SFPNAME:COMPANY_ID

L_AGENT_ADDRESS = SFSAGENT:CITY + ", " + SFSAGENT:STR_STATE

L_MED_LIMIT = SFPMASTER:MEDICAL_LIMIT

Switch(SFPMASTER:FORM_OF_BUSINESS)
  Case 'C' : L_FOB = "Corporation"
  Case 'I' : L_FOB = "Individual"
  Case 'J' : L_FOB = "Joint Venture"
  Case 'O' : L_FOB = "Organization"
  Case 'P' : L_FOB = "Partnership"
  case 'L' : l_fob = "LLC"
  Case 'T' : L_FOB = SFPMASTER:FOB_DESCRIPTION
End

L_TRANS_CODE = SFPMASTER:TRANS_CODE
L_MM_1 = Month(SFPMASTER:TRANS_EFF)
L_DD_1 = Day(SFPMASTER:TRANS_EFF)
L_YY_1 = Year(SFPMASTER:TRANS_EFF)
L_AUDIT = SFPMASTER:AUDIT

L_TRANS_EFF = Str(L_MM_1) + "/" + Str(L_DD_1) + "/" + Str(L_YY_1)
Include "swudeccs_gandg.inc"

Switch(SFPMASTER:LIABILITY_CODE)
                 Case 1 : L_LIABILITY = 300000
                 Case 2 : L_LIABILITY = 500000
                 Case 3 : L_LIABILITY = 1000000
End

L_MAX_LINES = 60
L_SIZE_COUNTER = 0
L_LINE_COUNTER = 1
L_PAGENUMBER = 1
L_LOCATION_COUNTER = 1
L_INSURED_COUNTER = 0
L_AGENT_COUNTER = 0
L_STATE_STR = SFSCOMPANY:STR_STATE

Writefile(L_FILE_NAME,"%s",L_LEDUP)

If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
  {
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")
    Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --
    Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P")
  }

Access SCIPSCONTROL1,
   Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
       SCIPSCONTROL1:STATE      = L_STATE2,
       SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, generic

Writefile(L_FILE_NAME,"%s","<033>&a200h7130V")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
Writefile(L_FILE_NAME,"%s",trun(SCIPSCONTROL1:PRINT_POLICY_FORM_ON_CPP_DECS[4]))

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
Writefile(L_FILE_NAME,"%s","Page ")
Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

L_POLICY_DECLARATION = uppercase(SCIPSCONTROL:CPP_HEADING[5])
Include "header3.inc"

Writefile(L_FILE_NAME,"%s%s","<NL>","<033>&f0S") --pushed memory location on stack
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s%s%s%s","<033>&f1S",L_ARIAL_12,"<033>&a300h+30V",
                      "Policy Number","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1


Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD_14,
                      "<033>&a300h+20V",Trun(SFSLINE:ALPHA),
                      trun(str(SFPPRINT1:POLICY_NO)))

if sfsline2:USE_POL_YEAR_END_SEQ_SUFFIX one of 1 and
    sfpname:company_id not one of "FARMERS" then
  {
    Writefile(L_FILE_NAME,"%s%s"," ",str(sfpname:pol_year,"9999"))
    Writefile(L_FILE_NAME,"%s%n"," ",sfpname:end_sequence)
  }

If SCIPSCONTROL:DONT_PRINT_PAYOR_CODE_ALL_COPY = 1 then
  {
    If SCIPSCONTROL:PAYOR_CODES = 1 and
       trun(uppercase(SCIPSCONTROL:PAY_CODE_COPY_NAME)) = trun(uppercase(L_COPY_NAME)) Then
       {
        L_BILL_PLAN = SFPNAME:BILL_PLAN
        If SFPSUPP:MORTGAGE_TYPE_1 = "" Then
          {
            L_MORTGAGE_TYPE_1 = " "
          }
        Else
          {
            L_MORTGAGE_TYPE_1 = SFPSUPP:MORTGAGE_TYPE_1
          }
        Access SFSPAYCODE,
           Set SFSPAYCODE:COMPANY_ID      = L_COMPANY_ID,
               SFSPAYCODE:BILL_PLAN       = L_BILL_PLAN,
               SFSPAYCODE:MORTGAGE_TYPE_1 = L_MORTGAGE_TYPE_1, Generic

        Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a+0h+0V"," - ",
                              SFPNAME:BILL_PLAN," - ",SFSPAYCODE:PAY_CODE)
      }
  }
Else
If SCIPSCONTROL:PAYOR_CODES = 1 Then
  {
    L_BILL_PLAN = SFPNAME:BILL_PLAN
    If (SFPSUPP:MORTGAGE_TYPE_1 = "") Then
      {
        L_MORTGAGE_TYPE_1 = " "
      }
    Else
      {
        L_MORTGAGE_TYPE_1 = SFPSUPP:MORTGAGE_TYPE_1
      }
    Access SFSPAYCODE,
            Set SFSPAYCODE:COMPANY_ID      = L_COMPANY_ID,
                SFSPAYCODE:BILL_PLAN       = L_BILL_PLAN,
                SFSPAYCODE:MORTGAGE_TYPE_1 = L_MORTGAGE_TYPE_1, Exact

    Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a+0h+0V"," -",
                          SFPNAME:BILL_PLAN,"-",SFSPAYCODE:PAY_CODE)
  }

If (SFPNAME:POLICY_TYPE = "W") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%s%s","<NL>",L_ARIAL_BOLD_12,"<033>&a300h+80V",
                          "Rewrite of ",L_PREV_STRING)
    L_LINE_COUNTER = L_LINE_COUNTER + 1
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%s","<NL>",L_ARIAL_BOLD_12,
                           "<033>&a300h+80V",L_TYPE_STR)
    L_LINE_COUNTER = L_LINE_COUNTER + 1
  }

If (L_TRANS_CODE One Of 12,13) Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%n",L_ARIAL_BOLD_12,"<033>&a3900h+0V",
    "Endorsement #",SFPNAME:ENDORSEMENT_NUMBER)
  }

if scipscontrol:agent_print_copy_name = "" then
  begin
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%n%s","<NL>","<NL>",L_ARIAL_BOLD,
    "<033>&a200h+0V","", "<033>&a350h+0V","Named Insured and Mailing Address",
    "<033>&a3000h+0V","Agent -","<033>&a3400h+0V",SFSAGENT:AGENT_NO,"<NL>")
  end
else
  begin
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%n%s","<NL>","<NL>",L_ARIAL_BOLD,
    "<033>&a200h+0V","","<033>&a350h+0V","Named Insured and Mailing Address",
    "<033>&a3000h+0V",trun(scipscontrol:agent_print_copy_name)," - ",SFSAGENT:AGENT_NO,"<NL>")
  end

L_LINE_COUNTER = L_LINE_COUNTER + 3

Writefile(L_FILE_NAME,"%s%s","<033>&f0S",L_ARIAL)

I_NAME=SFPNAME:NAME[1,1,40]
Include "sfsrevname7.pro"
If SFPNAME:NAME[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

I_NAME=SFPNAME:NAME[2,1,40]
Include "sfsrevname7.pro"
If SFPNAME:NAME[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

I_NAME=SFPNAME:NAME[3,1,40]
Include "sfsrevname7.pro"
If SFPNAME:NAME[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

If (SFPNAME:ADDRESS[1,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",SFPNAME:ADDRESS[1],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
If (SFPNAME:ADDRESS[2,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",SFPNAME:ADDRESS[2],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
If (SFPNAME:ADDRESS[3,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",SFPNAME:ADDRESS[3],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",L_INSURED_CITY_STATE,"<NL>")
L_INSURED_COUNTER = L_INSURED_COUNTER +1

Writefile(L_FILE_NAME,"%s%s","<033>&f1S",L_ARIAL)
Writefile(L_FILE_NAME,"%s","<033>&f0S") --Push

Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",
                        SFSAGENT:NAME[1],"<NL>")
L_AGENT_COUNTER = L_AGENT_COUNTER +1

If SFSAGENT:NAME[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:NAME[2],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER + 1
  }
If SFSAGENT:NAME[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:NAME[3],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[1],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[2],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[3],
                          "<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a3000h+0V",Trun(SFSAGENT:CITY),", ",
                      SFSAGENT:STR_STATE," ",L_AGENT_ZIP,"<NL>")
L_AGENT_COUNTER = L_AGENT_COUNTER +1

If SFSAGENT:TELEPHONE[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%s %s-%s%s","<033>&a3000h+0V",
                      "(",L_AGENT_TEL[1,3],")",L_AGENT_TEL[4,6],
                      L_AGENT_TEL[7,10],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If L_INSURED_COUNTER < L_AGENT_COUNTER Then
  {
    L_TWO_PLACER = L_AGENT_COUNTER * 100 + 40
    L_LINE_COUNTER = L_LINE_COUNTER + L_AGENT_COUNTER
  }
Else
  {
    L_TWO_PLACER = L_INSURED_COUNTER * 100 + 40
    L_LINE_COUNTER = L_LINE_COUNTER + L_INSURED_COUNTER
  }

Writefile(L_FILE_NAME,"%s","<033>&f1S") --POP

Writefile(L_FILE_NAME,"%s%n%s","<033>&a140h+",L_TWO_PLACER,"V")
Writefile(L_FILE_NAME,"%s%s","<033>*c5455h20v0P","<NL>") --under name horizontal line to
L_LINE_COUNTER = L_LINE_COUNTER + 0.5

               --************BEGIN POLICY TERM section***********

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","Policy Term: ")
Writefile(L_FILE_NAME,"%s",L_ARIAL)
Writefile(L_FILE_NAME,"%s","<033>&a850h+0V")
Writefile(L_FILE_NAME,"%s","From ")
Writefile(L_FILE_NAME,"%s",Str(SFPNAME:EFF_DATE,"mm/dd/yyyy"))
Writefile(L_FILE_NAME,"%s"," to ")
Writefile(L_FILE_NAME,"%s",Str(SFPNAME:EXP_DATE,"mm/dd/yyyy"))
Writefile(L_FILE_NAME,"%s"," 12:01 A.M. Standard Time at your mailing address shown above.")
Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Switch(SFPMASTER:FORM_OF_BUSINESS)
  Case 'C' : L_FOB = "Corporation"
  Case 'I' : L_FOB = "Individual"
  Case 'J' : L_FOB = "Joint Venture"
  Case 'O' : L_FOB = "Organization"
  Case 'P' : L_FOB = "Partnership"
  case 'L' : l_fob = "LLC"
  Case 'T' : L_FOB = SFPMASTER:FOB_DESCRIPTION
End

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","You are a: ")
Writefile(L_FILE_NAME,"%s",L_ARIAL)
Writefile(L_FILE_NAME,"%s",Uppercase(L_FOB))

Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s",L_ARIAL_bold)
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","Your Business/Operation: ")
Writefile(L_FILE_NAME,"%s",L_ARIAL)
Writefile(L_FILE_NAME,"%s",TRUN(CPPINLAND:BUSINESS_DESCription[1]) + " " + trun(CPPINLAND:BUSINESS_DESCription[2]))

Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s","IN RETURN FOR PAYMENT OF THE PREMIUM, AND SUBJECT TO ALL THE TERMS OF THIS POLICY, ")
Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s","WE AGREE WITH YOU TO PROVIDE THE INSURANCE AS STATED IN THIS POLICY.  THERE ARE EXCLUSIONS,")
Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
Writefile(L_FILE_NAME,"%s","CONDITIONS AND LIMITATIONS CONTAINED IN THE POLICY FORMS AND ENDORSEMENTS.")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h10v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3


                 --*************END POLICY TERM Section************

        --********BEGIN LOCATION, CONSTRUCTION AND OCCU[PANCY Section********

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s",Uppercase("Location of Premises you own, rent or occupy"))
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h5v0P","<NL>")

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
Writefile(L_FILE_NAME,"%s","<033>&a400h-120V")

l_no_locations = 0
While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
      SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
      SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
  begin
    Access cppinland ,
       Set cppinland:POLICY_NO    = SFPLOCATION:POLICY_NO,
           cppinland:POL_YEAR     = SFPLOCATION:POL_YEAR,
           cppinland:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
           cppinland:PREM_NO      = SFPLOCATION:PREM_NO,
           cppinland:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

    L_LOOP = L_LOOP + 1
    l_no_locations = l_no_locations + 1

    Next SFPLOCATION
  end

Access SFPLOCATION,
   Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

L_SUPPLEMENTAL_SWITCH = 0

If L_LOOP > 2 Then
    begin
    L_SUPPLEMENTAL_SWITCH = 1
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
    Writefile(L_FILE_NAME,"%s","See Attached Location of Premises Supplemental for Details")
    Writefile(L_FILE_NAME,"%s","<NL>")
    end
Else
    begin
    While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
          SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
          SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
        begin
        Access cppinland,
           Set cppinland:POLICY_NO    = SFPLOCATION:POLICY_NO,
               cppinland:POL_YEAR     = SFPLOCATION:POL_YEAR,
               cppinland:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
               cppinland:PREM_NO      = SFPLOCATION:PREM_NO,
               cppinland:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

        L_sfplocation_ZIP = If (Val(sfplocation:STR_ZIPCODE[6,9]) = 0) Then
                                sfplocation:STR_ZIPCODE[1,5]
                            Else
                                sfplocation:STR_ZIPCODE[1,5] + "-" +
                                sfplocation:STR_ZIPCODE[6,9]

        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
        Writefile(L_FILE_NAME,"%s","<033>&a400h+120V")
        Writefile(L_FILE_NAME,"%s","Prem No. ")
        Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
        Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:PREM_NO,"ZZZZ"))
        Writefile(L_FILE_NAME,"%s","<033>&a1100h+0V")
        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
        Writefile(L_FILE_NAME,"%s","Bldg No. ")
        Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
        Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:BUILD_NO,"ZZZZ"))
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
        Writefile(L_FILE_NAME,"%s","<033>&a400h+100V")
        Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:ADDRESS))
        Writefile(L_FILE_NAME,"%s","  ")
        Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:ADDRESS1[1]))
        Writefile(L_FILE_NAME,"%s","  ")
        Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:CITY))
        Writefile(L_FILE_NAME,"%s",", ")
        Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:STR_STATE))
        Writefile(L_FILE_NAME,"%s","  ")
        Writefile(L_FILE_NAME,"%s",L_SFPLOCATION_ZIP)
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        Next SFPLOCATION
        end

    end

Writefile(L_FILE_NAME,"%s%s","<033>&a140h+40V<033>*c5455h10v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3

        --********END LOCATION, CONSTRUCTION AND OCCU[PANCY Section********

                --********BEGIN COVERAGES PROVIDED Section********

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","COVERAGES PROVIDED")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h5v0P","<NL>")

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","Premises")
Writefile(L_FILE_NAME,"%s","<033>&a1700h+0V")
Writefile(L_FILE_NAME,"%s","Limits of")

Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Building or Coverage Item #")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a1680h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Insurance")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a2300h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Coverage")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a4550h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Deductible")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a5150h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Premium")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)

Writefile(L_FILE_NAME,"%s","<033>&f0S")

L_LOOP = 0
L_SUBTOTAL_PREM = 0
L_SUBTOTAL_PRCO = 0

Access SFPLOCATION,
   Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

If L_SUPPLEMENTAL_SWITCH = 1 Then
    begin
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
    Writefile(L_FILE_NAME,"%s","See Attached Coverages Supplemental for Details")
    Writefile(L_FILE_NAME,"%s","<033>&a200h+80V")
    end
Else
    begin
    if l_no_locations > 1 then
        begin
        access cppimcov, set cppimcov:policy_no      = sfplocation:policy_no,
                             cppimcov:pol_year       = sfplocation:pol_year,
                             cppimcov:end_sequence   = sfplocation:end_sequence, generic

        l_sub_code = cppimcov:sub_code
        While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
              SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
              SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
            begin
            If l_line_counter >= L_MAX_LINES - 5 Then
                begin
                Do INSERT_NEWPAGE
                end

            Access cppinland, Set cppinland:POLICY_NO    = SFPLOCATION:POLICY_NO,
                                  cppinland:POL_YEAR     = SFPLOCATION:POL_YEAR,
                                  cppinland:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
                                  cppinland:PREM_NO      = SFPLOCATION:PREM_NO,
                                  cppinland:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

            access cppimcov, set cppimcov:policy_no      = sfplocation:policy_no,
                                 cppimcov:pol_year       = sfplocation:pol_year,
                                 cppimcov:end_sequence   = sfplocation:end_sequence,
                                 cppimcov:sub_code       = l_sub_code, generic

            if cppimcov:policy_no    = sfplocation:policy_no and
               cppimcov:pol_year     = sfplocation:pol_year and
               cppimcov:end_sequence = sfplocation:end_sequence and
               cppimcov:sub_code     = l_sub_code then
                begin
                L_SFPLOCATION_ZIP = If (Val(SFPLOCATION:STR_ZIPCODE[6,9]) = 0) Then
                                        SFPLOCATION:STR_ZIPCODE[1,5]
                                    Else
                                        SFPLOCATION:STR_ZIPCODE[1,5] + "-" +
                                        SFPLOCATION:STR_ZIPCODE[6,9]

                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
                Writefile(L_FILE_NAME,"%s","Prem No. ")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:PREM_NO,"ZZZZ"))
                Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s","Bldg No. ")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:BUILD_NO,"ZZZZ"))
                Writefile(L_FILE_NAME,"%s","<033>&a1600h+0V")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",str(cppimcov:limit,"ZZ,ZZZ,ZZZ"))

                Writefile(L_FILE_NAME,"%s","<033>&a2200h+0V")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",uppercase(cppimcov:description))

                if cppimcov:see_form = 0 then
                    begin
                    Writefile(L_FILE_NAME,"%s","<033>&a4550h+0V")
                    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                    Writefile(L_FILE_NAME,"%s",str(cppimcov:deductible,"ZZZZZ"))
                    end
                else
                    begin
                    Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
                    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                    writefile(l_file_name,"%s","See Form")
                    end
                Writefile(L_FILE_NAME,"%s","<033>&a4990h+0V")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",str(cppimcov:premium,"ZZZ,ZZZ,ZZZ"))
                L_LINE_COUNTER = L_LINE_COUNTER + 1

                end

            l_sub_code = l_sub_code + 10

            Next SFPLOCATION
            end

        end

    else
        begin
        l_sub_code = 0
        If l_line_counter >= L_MAX_LINES - 5 Then
            begin
            Do INSERT_NEWPAGE
            end

        Access cppinland, Set cppinland:POLICY_NO    = SFPLOCATION:POLICY_NO,
                              cppinland:POL_YEAR     = SFPLOCATION:POL_YEAR,
                              cppinland:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
                              cppinland:PREM_NO      = SFPLOCATION:PREM_NO,
                              cppinland:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

        access cppimcov, set cppimcov:policy_no      = sfplocation:policy_no,
                             cppimcov:pol_year       = sfplocation:pol_year,
                             cppimcov:end_sequence   = sfplocation:end_sequence, generic

        while cppimcov:policy_no = sfplocation:policy_no and
              cppimcov:pol_year = sfplocation:pol_Year and
              cppimcov:end_Sequence = sfplocation:end_sequence
                begin
                L_SFPLOCATION_ZIP = If (Val(SFPLOCATION:STR_ZIPCODE[6,9]) = 0) Then
                                        SFPLOCATION:STR_ZIPCODE[1,5]
                                    Else
                                        SFPLOCATION:STR_ZIPCODE[1,5] + "-" +
                                        SFPLOCATION:STR_ZIPCODE[6,9]

                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
                Writefile(L_FILE_NAME,"%s","Prem No. ")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:PREM_NO,"ZZZZ"))
                Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s","Bldg No. ")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:BUILD_NO,"ZZZZ"))
                Writefile(L_FILE_NAME,"%s","<033>&a1600h+0V")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",str(cppimcov:limit,"ZZ,ZZZ,ZZZ"))

                Writefile(L_FILE_NAME,"%s","<033>&a2200h+0V")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",uppercase(cppimcov:description))

                if cppimcov:see_form = 0 then
                    begin
                    Writefile(L_FILE_NAME,"%s","<033>&a4550h+0V")
                    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                    Writefile(L_FILE_NAME,"%s",str(cppimcov:deductible,"ZZZZZ"))
                    end
                else
                    begin
                    Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
                    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                    writefile(l_file_name,"%s","See Form")
                    end
                Writefile(L_FILE_NAME,"%s","<033>&a4990h+0V")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",str(cppimcov:premium,"ZZZ,ZZZ,ZZZ"))
                L_LINE_COUNTER = L_LINE_COUNTER + 1

                next cppimcov
                end

        end

    end

  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
  Writefile(L_FILE_NAME,"%s","<033>&a3490h+120V")
  Writefile(L_FILE_NAME,"%s","Total Premium")
  Writefile(L_FILE_NAME,"%s","<033>&a4945h+0V")
  Writefile(L_FILE_NAME,"%s","$")
  Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
  Writefile(L_FILE_NAME,"%s",Str(SFPMASTER:TOTAL[6] +
                                 sfpmaster:other_totals[19],"ZZZ,ZZZ,ZZZ"))
  L_LINE_COUNTER = L_LINE_COUNTER + 1

  If SFPMASTER:MINIMUM_PREMIUM[1] = "Y" Then
    {
      Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
      Writefile(L_FILE_NAME,"%s"," MP")
    }

Writefile(L_FILE_NAME,"%s%s","<033>&a140h+40V<033>*c5455h15v0P","<NL>")


                --********END COVERAGES PROVIDED Section********

              --********BEGIN MORTGAGEE & MAILING Section********


Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s",Uppercase("Mortgagee(s), Loss Payee(s) & Mailing Address"))
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h5v0P","<NL>")

Access SFPSUPP,
   Set SFPSUPP:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPSUPP:POL_YEAR     = SFPPRINT1:POL_YEAR ,
       SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

If SFPSUPP:POLICY_NO = SFPPRINT1:POLICY_NO And
   SFPSUPP:POL_YEAR  = SFPPRINT1:POL_YEAR And
   SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE Then
  {
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
    Writefile(L_FILE_NAME,"%s","See Attached Additional Interests supplemental for Details")
  }
Else
  {
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
    Writefile(L_FILE_NAME,"%s","N/A")
  }


Writefile(L_FILE_NAME,"%s%s%s","<NL>","<NL>","<NL>")

If (SCIPSCONTROL:COUNTERSIGNATURE_DATE = 1) Then
  {
      Writefile(L_FILE_NAME,"%s%d%s","<033>&a800h-20V",TODAYSDATE,
                "<033>&a+0h+20V")
  }

If (SCIPSCONTROL:SIGNATURE = 1) Then
   {
     --the next line of code will be used for a signature
     if scipscontrol:PRINT_SIGNATURE_ON_COMMON_ONLY not one of 1 then
       {
         If Trun(Uppercase(L_COPY_NAME)) <> "HOME OFFICE" Then
           {
             --the next line of code will be used to a signature

             L_SIGNATURE_STRING = "<033>" + Trun(SCIPSCONTROL:SIGNATURE_SYMBOL_SET) +
                                  "<033>" + Trun(SCIPSCONTROL:SIGNATURE_DEFINITION)

             Writefile(L_FILE_NAME,"%s","<033>&a")
             Writefile(L_FILE_NAME,"%n",SCIPSCONTROL:SIGNATURE_HOZ_POS)
             Writefile(L_FILE_NAME,"%s","h")
             Writefile(L_FILE_NAME,"%s",Trun(SCIPSCONTROL:SIGNATURE_VERT_POS))
             Writefile(L_FILE_NAME,"%s","V")
             Writefile(L_FILE_NAME,"%s",trun(L_SIGNATURE_STRING))
             Writefile(L_FILE_NAME,"%s",Trun(SCIPSCONTROL:SIGNATURE_STRING_TO_PRINT))
             Writefile(L_FILE_NAME,"%s","<033>&a0h+20V")
           }
      }
   }


If SCIPSCONTROL:DONT_PRINT_COUNTER_SIGNATURE = 0 Then --prints counter sign line
  {
    Writefile(L_FILE_NAME,"%s%s",L_ARIAL,"<033>&a220h+0V<033>*c2000h5v0P")
    Writefile(L_FILE_NAME,"%s",L_PUSH)
    Writefile(L_FILE_NAME,"%s%s","<033>&a800h+120V","Countersignature Date")
  }
If SCIPSCONTROL:DONT_PRINT_SIGNATURE_LINE = 0 Then
  {
    If SCIPSCONTROL:DONT_PRINT_COUNTER_SIGNATURE = 0 Then
      {
        Writefile(L_FILE_NAME,"%s",L_POP)
      }
    Writefile(L_FILE_NAME,"%s%s%s%s","<033>&a2575h+0V","By:",
                      "<033>&a2750h-0V<033>*c2800h5v0P","<NL>")
    Writefile(L_FILE_NAME,"%s%s","<033>&a3200h+0V","Representative")
  }




Writefile(L_FILE_NAME,"%s%s","<NL>","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 3

If ((SFSMESSAGE:NEW           = 1 and
   sfpmaster:trans_code one of 10) or
   (SFSMESSAGE:RENEWAL       = 1 and
   sfpmaster:trans_code one of 14) or
   (SFSMESSAGE:ENDORSEMENT   = 1 and
   sfpmaster:trans_code one of 12, 13) or
   (SFSMESSAGE:CANCELLATION  = 1 and
   sfpmaster:trans_code one of 11) or
   (SFSMESSAGE:REINSTATEMENT = 1 and
   sfpmaster:trans_code one of 16) or
   SFSMESSAGE:ALL           = 1) then
    begin
    If (L_LINE_COUNTER > (L_MAX_LINES - 10)) Then
        begin
        Do INSERT_NEWPAGE
        end
    Writefile(L_FILE_NAME,"%s","<033>&a220h+320V")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_12)
    Writefile(L_FILE_NAME,"%s","Important Messages")
    end

If L_TRANS_CODE one of 10 and
   SFSMESSAGE:NEW = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }

    L_FONT             = L_ARIAL
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:NEW_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 11 and
   SFSMESSAGE:CANCELLATION = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAl
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:CANCELLATION_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 14 and
   SFSMESSAGE:RENEWAL = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:RENEWAL_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 16 and
   SFSMESSAGE:NEW = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:REINSTATEMENT_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 12,13 and
   SFSMESSAGE:ENDORSEMENT = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:ENDORSEMENT_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If SFSMESSAGE:ALL = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:ALL_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }

Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a200h7250V","Issue Date ",
                      Str(SFPNAME:TRANS_DATE,"mm/dd/yyyy"))

Access SFPSUPP,
   Set SFPSUPP:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPSUPP:POL_YEAR     = SFPPRINT1:POL_YEAR ,
       SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

If SFPSUPP:POLICY_NO = SFPPRINT1:POLICY_NO And
   SFPSUPP:POL_YEAR  = SFPPRINT1:POL_YEAR And
   SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE Then
  {
    L_DO_MORT = 1
  }

If L_DO_MORT = 1 Then
  {
    if l_page_number = 1 then
      {
        l_page_number = l_page_number + 1
        Writefile(L_FILE_NAME,"%s","<FF>")
--        do insert_newpage
/*
        Access SCIPSCONTROL1,
           Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
               SCIPSCONTROL1:STATE      = L_STATE2,
               SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, generic

        Writefile(L_FILE_NAME,"%s","<033>&a200h7130V")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
        Writefile(L_FILE_NAME,"%s",trun(SCIPSCONTROL1:PRINT_POLICY_FORM_ON_cpp_DECS[4]))*/
      }
    Do MORT
  }

If L_SUPPLEMENTAL_SWITCH = 1 Then
  {
--    Writefile(L_FILE_NAME,"%s%n","l_page",l_page_number)
    Do LOCATION

    If L_BLANKET_SWITCH <> 1 Then
      {
        Do PREMIUM_BASIS
      }
  }

Screen Exit

Writefile(L_FILE_NAME,"%s%s",L_FORMFEED ,L_RESET )
Closefile(L_FILE_NAME)

Procedure Definition

Procedure MORT
{
  Writefile(L_FILE_NAME,"%s","<FF>")
  L_LINE_COUNTER = 0
--  l_page_number = 1

  If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
      Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
      Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
    }

  Access SCIPSCONTROL1,
     Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
         SCIPSCONTROL1:STATE      = L_STATE2,
         SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, generic

  Writefile(L_FILE_NAME,"%s","<033>&a200h7130V")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s",trun(SCIPSCONTROL1:PRINT_POLICY_FORM_ON_cpp_DECS[4]))

--  L_PAGE_NUMBER = l_page_number + 1
  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
  Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
  Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
  Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
  Writefile(L_FILE_NAME,"%s","Page ")
  Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

-- Writefile(L_FILE_NAME,"%s","<033>&a+0h200V") --sets starting point for newpage

Access SFPSUPP,
   Set SFPSUPP:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPSUPP:POL_YEAR     = SFPPRINT1:POL_YEAR ,
       SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

L_MORGAGE_ID = SFPSUPP:MORTGAGE_ID

Access SFSMORT,
   Set SFSMORT:COMPANY_ID  = SFPNAME:COMPANY_ID,
       SFSMORT:MORTGAGE_ID = L_MORGAGE_ID, Exact

  Writefile(L_FILE_NAME,"%s","<033>&a200h300V")
  Writefile(L_FILE_NAME,"%s","ADDITIONAL INTEREST SUPPLEMENTAL DECLARATIONS")
  L_LINE_COUNTER = L_LINE_COUNTER + 1

  Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
  L_LINE_COUNTER = L_LINE_COUNTER + 3

  Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
  Writefile(L_FILE_NAME,"%s","Policy # ")
  Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
  Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
  Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

  Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
  Writefile(L_FILE_NAME,"%s","SCHEDULE")
  L_LINE_COUNTER = L_LINE_COUNTER + 2

While SFPSUPP:POLICY_NO    = SFPPRINT1:POLICY_NO And
      SFPSUPP:POL_YEAR     = SFPPRINT1:POL_YEAR And
      SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
{

  L_MORGAGE_ID = SFPSUPP:MORTGAGE_ID

  Access SFSMORT,
     Set SFSMORT:COMPANY_ID  = SFPNAME:COMPANY_ID,
         SFSMORT:MORTGAGE_ID = L_MORGAGE_ID, Exact

  L_SFPSUPP_ZIP = If (Val(SFPSUPP:STR_ZIPCODE[6,9]) = 0) Then
                        SFPSUPP:STR_ZIPCODE[1,5]
                        Else
                        SFPSUPP:STR_ZIPCODE[1,5] + "-" +
                        SFPSUPP:STR_ZIPCODE[6,9]

  L_SFSMORT_ZIP = If (Val(SFSMORT:STR_ZIPCODE[6,9]) = 0) Then
                        SFSMORT:STR_ZIPCODE[1,5]
                        Else
                        SFSMORT:STR_ZIPCODE[1,5] + "-" +
                        SFSMORT:STR_ZIPCODE[6,9]

  If l_line_counter >= L_MAX_LINES - 20 Then
    {
      L_PAGE_NUMBER = L_PAGE_NUMBER + 1

      Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n","<FF>",L_ARIAL_BOLD_9,
                            "<033>&a2400h7250V",L_COPY_NAME,"<033>&a5000h7130V",
                            "Page ",L_PAGE_NUMBER)

      Access SCIPSCONTROL1,
         Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
             SCIPSCONTROL1:STATE      = L_STATE2,
             SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, generic

      Writefile(L_FILE_NAME,"%s","<033>&a200h7130V")
      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
      Writefile(L_FILE_NAME,"%s",trun(SCIPSCONTROL1:PRINT_POLICY_FORM_ON_cpp_DECS[4]))

      l_line_counter = 1
      --border
      If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
        {
          Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
          Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
          Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
          Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
        }
      Writefile(L_FILE_NAME,"%s%s","<033>&a+0h0V","<NL>") --sets starting point for newpage
      Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a2000h+0V",
                      "ADDITIONAL INTERESTS CONTINUED","<NL>")
      l_line_counter = l_line_counter + 1
    }
--  Writefile(L_FILE_NAME,"%s%s","<033>&a150h-80V<033>*c5455h20v0P","<NL>")
  Writefile(L_FILE_NAME,"%s","<033>&a0h+240V")

  If (SFPSUPP:MORTGAGE_ID <> "") Then
    {
      Writefile(L_FILE_NAME,"%s%s%s%s%n%s%s%s%n%s",L_ARIAL_BOLD,"<033>&a350h+0V",
                            "Location","<033>&a900h+0V",SFPSUPP:PREM_NO,
                            "<033>&a1350h+0V","Building","<033>&a1800h+0V",
                            SFPSUPP:BUILD_NO,"<NL>")
      l_line_counter = l_line_counter +1

      Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V","Interest ",L_ARIAL)
       --accesses the paytype file to print the description on the dec page
      L_COMPANY_ID      = SFPNAME:COMPANY_ID
      L_MORTGAGE_TYPE_2 = SFPSUPP:MORTGAGE_TYPE_2

     Access SFSMORTTYPE,
                Set SFSMORTTYPE:COMPANY_ID = L_COMPANY_ID,
                    SFSMORTTYPE:MORTGAGE_CODE = L_MORTGAGE_TYPE_2, Exact
      --access the sfsmorttype to print out firt mortgage or loss payee ...etc
      Writefile(L_FILE_NAME,"%s%s","<033>&a900h+0V",SFSMORTTYPE:DESCRIPTION)

      Writefile(L_FILE_NAME,"%s%s%s%s%s","<NL>",L_ARIAL_BOLD,"<033>&a350h-0V",
                            "Name",L_ARIAL)

      for l_loop = 1 to 3
        {
          If (SFSMORT:NAME[l_loop] <> "" ) Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFSMORT:NAME[l_loop],"<NL>")
              l_line_counter = l_line_counter +1
            }
        }

      If (SFPSUPP:SUCCESSOR = "Y") Then
        {
          Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",
                   Uppercase("It's Successors and/or Assigns"),"<NL>")
          l_line_counter = l_line_counter +1
        }
      If (SFPSUPP:ATIMA = "Y") Then
        {
          Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V","ATIMA","<NL>")
          l_line_counter = l_line_counter +1
        }
      If (SFPSUPP:ACCOUNT_NO <> "") Then
        {
          Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a350h+0V",
                                "Loan # ",L_ARIAL,"<033>&a900h+0V",
                                SFPSUPP:ACCOUNT_NO,"<NL>")
          l_line_counter = l_line_counter +1
        }
      Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a350h+0V","Address ",
                            L_ARIAL)

      for l_loop = 1 to 3
        {
          If (SFSMORT:ADDRESS[l_loop] <> "") Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h-0V",SFSMORT:ADDRESS[l_loop],"<NL>")
              l_line_counter = l_line_counter +1
            }
        }
      Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a900h+0V",Trun(SFSMORT:CITY),", ",
                           SFSMORT:STR_STATE,"  ",L_SFSMORT_ZIP,"<NL>")
      l_line_counter = l_line_counter +1
    }
  Else
    {
      If (SFPSUPP:POLICY_NO = SFPPRINT1:POLICY_NO) Then
        {
          Writefile(L_FILE_NAME,"%s%s%s%s%n%s%s%s%n%s",L_ARIAL_BOLD,
                            "<033>&a350h+0V","Location",
                            "<033>&a900h+0V",SFPSUPP:PREM_NO,"<033>&a1350h+0V",
                            "Building","<033>&a1800h+0V",SFPSUPP:BUILD_NO,"<NL>")
          l_line_counter = l_line_counter +1

          Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V","Interest ",L_ARIAL)
          L_COMPANY_ID      = SFPNAME:COMPANY_ID
--          L_MORTGAGE_TYPE_1 = SFPSUPP:MORTGAGE_TYPE_1
--          Access SFSPAYORTYPE ,
--               Set SFSPAYORTYPE:COMPANY_ID   = L_COMPANY_ID,
--                   SFSPAYORTYPE:PAYOR_CODE   = L_MORTGAGE_TYPE_1,Exact
          L_MORTGAGE_TYPE_2 = SFPSUPP:MORTGAGE_TYPE_2
          Access SFSMORTTYPE,
                Set SFSMORTTYPE:COMPANY_ID    = L_COMPANY_ID,
                     SFSMORTTYPE:MORTGAGE_CODE = L_MORTGAGE_TYPE_2, Exact

          --access the sfspayotype to print out description firt mortgage or loss payee ...etc
          Writefile(L_FILE_NAME,"%s%s","<033>&a900h+0V",SFSMORTTYPE:DESCRIPTION)
          Writefile(L_FILE_NAME,"%s%s%s%s%s","<NL>",L_ARIAL_BOLD,"<033>&a350h+0V",
                                "Name",L_ARIAL)
          If (SFPSUPP:NAME[1] <> "" ) Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFPSUPP:NAME[1],"<NL>")
              l_line_counter = l_line_counter +1
            }
          If (SFPSUPP:NAME[2] <> "" ) Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFPSUPP:NAME[2],"<NL>")
              l_line_counter = l_line_counter +1
            }
          If (SFPSUPP:NAME[3] <> "" ) Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFPSUPP:NAME[3],"<NL>")
              l_line_counter = l_line_counter +1
            }
          If (SFPSUPP:SUCCESSOR = "Y") Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",
                    Uppercase("It's Successors and/or Assigns"),"<NL>")
              l_line_counter = l_line_counter +1
            }
          If (SFPSUPP:ATIMA = "Y") Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V","ATIMA","<NL>")
              l_line_counter = l_line_counter +1
            }
          If (SFPSUPP:ACCOUNT_NO <> "") Then
            {
              Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s",L_ARIAL_BOLD,"<033>&a350h+0V",
                             "Loan # ",L_ARIAL,"<033>&a900h+0V",
                             SFPSUPP:ACCOUNT_NO,"<NL>")
              l_line_counter = l_line_counter +1
            }
          Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a350h+0V",
                                "Address ",L_ARIAL)

          If (SFPSUPP:ADDRESS[1] <> "") Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFPSUPP:ADDRESS[1],
                                "<NL>")
              l_line_counter = l_line_counter +1
            }
          If (SFPSUPP:ADDRESS[2] <> "") Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFPSUPP:ADDRESS[2],
                                "<NL>")
              l_line_counter = l_line_counter +1
            }
          If (SFPSUPP:ADDRESS[3] <> "") Then
            {
              Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFPSUPP:ADDRESS[3],
                                "<NL>")
              l_line_counter = l_line_counter +1
            }
          Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a900h+0V",Trun(SFPSUPP:CITY),", ",
                            SFPSUPP:STR_STATE," ",L_SFPSUPP_ZIP,"<NL>")
          l_line_counter = l_line_counter +1
        }
    }
  l_line_counter = l_line_counter +1
  Next SFPSUPP
}

Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a200h7250V","Issue Date ",
                      Str(SFPNAME:TRANS_DATE,"mm/dd/yyyy"))

/*  If L_PAGE_NUMBER Mod 2 = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<FF>")
  Access SCIPSCONTROL1,
     Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
         SCIPSCONTROL1:STATE      = L_STATE2,
         SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, generic

  Writefile(L_FILE_NAME,"%s","<033>&a200h7130V")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s",trun(SCIPSCONTROL1:PRINT_POLICY_FORM_ON_cpp_DECS[4]))

    }*/

}

Procedure INSERT_NEWPAGE

{
  Writefile(L_FILE_NAME,"%s","<FF>")
  L_LINE_COUNTER = 0
  If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
      Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
      Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
    }
  L_PAGE_NUMBER = L_PAGE_NUMBER + 1

  Access SCIPSCONTROL1,
     Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
         SCIPSCONTROL1:STATE      = L_STATE2,
         SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, generic

  Writefile(L_FILE_NAME,"%s","<033>&a200h7130V")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s",trun(SCIPSCONTROL1:PRINT_POLICY_FORM_ON_cpp_DECS[4]))

  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
  Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
  Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
  Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
  Writefile(L_FILE_NAME,"%s","Page ")
  Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
  Writefile(L_FILE_NAME,"%s","<033>&a200h120V")

  Writefile(L_FILE_NAME,"%s",uppercase(L_POLICY_DECLARATION))
  Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
  Writefile(L_FILE_NAME,"%s","Policy No. ")
  Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
  Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
  Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

  Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
  L_LINE_COUNTER = L_LINE_COUNTER + 2
--  Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5a120b0P")   --left vertical line
}

Procedure LOCATION

{
  Writefile(L_FILE_NAME,"%s","<FF>")
  L_LINE_COUNTER = 0
--  L_PAGE_NUMBER = 0
  If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
      Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
      Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
    }
  L_PAGE_NUMBER = L_PAGE_NUMBER + 1

  Access SCIPSCONTROL1,
     Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
         SCIPSCONTROL1:STATE      = L_STATE2,
         SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, generic

  Writefile(L_FILE_NAME,"%s","<033>&a200h7130V")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s",trun(SCIPSCONTROL1:PRINT_POLICY_FORM_ON_cpp_DECS[4]))

  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
  Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
  Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
  Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
  Writefile(L_FILE_NAME,"%s","Page ")
  Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

  Writefile(L_FILE_NAME,"%s","<033>&a200h300V")
  Writefile(L_FILE_NAME,"%s","LOCATION OF PREMISES SUPPLEMENTAL DECLARATIONS")
  L_LINE_COUNTER = L_LINE_COUNTER + 1

  Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
  L_LINE_COUNTER = L_LINE_COUNTER + 3

  Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
  Writefile(L_FILE_NAME,"%s","Policy # ")
  Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
  Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
  Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

  Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
  Writefile(L_FILE_NAME,"%s","SCHEDULE")
  Writefile(L_FILE_NAME,"%s",L_ARIAL_bold)

  L_LINE_COUNTER = L_LINE_COUNTER + 2

  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
  Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
  Writefile(L_FILE_NAME,"%s","Location of all Premises you own, rent or occupy")
  L_LINE_COUNTER = L_LINE_COUNTER + 2

  Access SFPLOCATION,
     Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
         SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
         SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

  While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
        SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
        SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
    {
      If L_LINE_COUNTER > L_MAX_LINES - 6 Then
        {
/*          If L_PAGE_NUMBER = 1 Then
            {
              Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
              Writefile(L_FILE_NAME,"%s","<033>&a5000h7250V")
              Writefile(L_FILE_NAME,"%s","Page ")
              Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)
            }*/
          Writefile(L_FILE_NAME,"%s","<FF>")
          L_LINE_COUNTER = 0
          If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
            {
              Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
              Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
              Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
              Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
            }
          L_PAGE_NUMBER = L_PAGE_NUMBER + 1

          Access SCIPSCONTROL1,
             Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
                 SCIPSCONTROL1:STATE      = L_STATE2,
                 SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, generic

          Writefile(L_FILE_NAME,"%s","<033>&a200h7130V")
          Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
          Writefile(L_FILE_NAME,"%s",trun(SCIPSCONTROL1:PRINT_POLICY_FORM_ON_cpp_DECS[4]))

          Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
          Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
          Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
          Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
          Writefile(L_FILE_NAME,"%s","Page ")
          Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

          Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
          Writefile(L_FILE_NAME,"%s","<033>&a200h120V")

          Writefile(L_FILE_NAME,"%s","LOCATION OF PREMISES SUPPLEMENTAL DECLARATIONS")
          Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
          Writefile(L_FILE_NAME,"%s","Policy No. ")
          Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
          Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
          Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

          Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
          L_LINE_COUNTER = L_LINE_COUNTER + 2
      --  Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5a120b0P")   --left vertical line
        }

      L_sfplocation_ZIP = If (Val(sfplocation:STR_ZIPCODE[6,9]) = 0) Then
                             sfplocation:STR_ZIPCODE[1,5]
                          Else
                             sfplocation:STR_ZIPCODE[1,5] + "-" +
                             sfplocation:STR_ZIPCODE[6,9]

        Access CPPGENERAL ,
           Set CPPGENERAL:POLICY_NO    = SFPLOCATION:POLICY_NO,
               CPPGENERAL:POL_YEAR     = SFPLOCATION:POL_YEAR,
               CPPGENERAL:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
               CPPGENERAL:PREM_NO      = SFPLOCATION:PREM_NO,
               CPPGENERAL:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

--      If CPPGENERAL:LIMIT[1] <> 0 Or
--         CPPGENERAL:LIMIT[2] <> 0 Or
--         L_BLANKET_SWITCH = 1 Then
--        {
          Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
          Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
          Writefile(L_FILE_NAME,"%s","Prem No. ")
          Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
          Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:PREM_NO,"ZZZZ"))
          Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
          Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
          Writefile(L_FILE_NAME,"%s","Bldg No. ")
          Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
          Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:BUILD_NO,"ZZZZ"))
          Writefile(L_FILE_NAME,"%s",L_ARIAL_bold)
          L_LINE_COUNTER = L_LINE_COUNTER + 2

          Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
          Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
          Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:ADDRESS))
          L_LINE_COUNTER = L_LINE_COUNTER + 1

          Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
          Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:CITY))
          Writefile(L_FILE_NAME,"%s",", ")
          Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:STR_STATE))
          Writefile(L_FILE_NAME,"%s","  ")
          Writefile(L_FILE_NAME,"%s",L_SFPLOCATION_ZIP)
          Writefile(L_FILE_NAME,"%s","<033>&a4050h+0V")
          Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
--          Writefile(L_FILE_NAME,"%s","<NL>")
          L_LINE_COUNTER = L_LINE_COUNTER + 1

--      }
      Next SFPLOCATION
    }

  Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a200h7250V","Issue Date ",
                      Str(SFPNAME:TRANS_DATE,"mm/dd/yyyy"))

/*  If L_PAGE_NUMBER Mod 2 = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<FF>")
  Access SCIPSCONTROL1,
     Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
         SCIPSCONTROL1:STATE      = L_STATE2,
         SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, generic

  Writefile(L_FILE_NAME,"%s","<033>&a200h7130V")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s",trun(SCIPSCONTROL1:PRINT_POLICY_FORM_ON_cpp_DECS[4]))

    }*/
}

Procedure COVERAGES_PROVIDED1

begin
if l_no_locations > 1 then
  begin
    access cppimcov,
       set cppimcov:policy_no      = sfplocation:policy_no,
           cppimcov:pol_year       = sfplocation:pol_year,
           cppimcov:end_sequence   = sfplocation:end_sequence, generic

    l_sub_code = cppimcov:sub_code
    While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
          SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
          SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
      begin
        If l_line_counter >= L_MAX_LINES - 5 Then
          begin
            Do INSERT_NEWPAGE
          end

        Access cppinland,
           Set cppinland:POLICY_NO    = SFPLOCATION:POLICY_NO,
               cppinland:POL_YEAR     = SFPLOCATION:POL_YEAR,
               cppinland:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
               cppinland:PREM_NO      = SFPLOCATION:PREM_NO,
               cppinland:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

        access cppimcov,
           set cppimcov:policy_no      = sfplocation:policy_no,
               cppimcov:pol_year       = sfplocation:pol_year,
               cppimcov:end_sequence   = sfplocation:end_sequence,
               cppimcov:sub_code       = l_sub_code, generic

        if cppimcov:policy_no    = sfplocation:policy_no and
           cppimcov:pol_year     = sfplocation:pol_year and
           cppimcov:end_sequence = sfplocation:end_sequence and
           cppimcov:sub_code     = l_sub_code then
            begin
            L_SFPLOCATION_ZIP = If (Val(SFPLOCATION:STR_ZIPCODE[6,9]) = 0) Then
                                    SFPLOCATION:STR_ZIPCODE[1,5]
                                Else
                                    SFPLOCATION:STR_ZIPCODE[1,5] + "-" +
                                    SFPLOCATION:STR_ZIPCODE[6,9]

            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
            Writefile(L_FILE_NAME,"%s","Prem No. ")
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s",Str(cppimcov:PREM_NO,"ZZZZ"))
            Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","Bldg No. ")
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s",Str(cppimcov:BUILD_NO,"ZZZZ"))
            Writefile(L_FILE_NAME,"%s","<033>&a1600h+0V")
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s",str(cppimcov:limit,"ZZ,ZZZ,ZZZ"))

            Writefile(L_FILE_NAME,"%s",L_push)
                l_font = l_arial_bold_9
                l_v_position = "+0"
                l_h_position = "2300"
                l_character_string = uppercase(cppimcov:description)
                l_max_char = 30
                include "line_spacing.inc"

            Writefile(L_FILE_NAME,"%s",L_pop)
            if cppimcov:see_form = 0 then
                begin
                Writefile(L_FILE_NAME,"%s","<033>&a4550h+0V")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",str(cppimcov:deductible,"ZZZZZ"))
                end
            else
                begin
                Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                writefile(l_file_name,"%s","See Form")
                end
            Writefile(L_FILE_NAME,"%s","<033>&a4990h+0V")
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s",str(cppimcov:premium,"ZZZ,ZZZ,ZZZ"))
            L_LINE_COUNTER = L_LINE_COUNTER + 1
                Writefile(L_FILE_NAME,"%s","<NL>")

            end

        l_sub_code = l_sub_code + 10
        Next SFPLOCATION
        end
    end
else
    begin
    l_sub_code = 0
    If l_line_counter >= L_MAX_LINES - 5 Then
        begin
        Do INSERT_NEWPAGE
        end

    Access cppinland, Set cppinland:POLICY_NO    = SFPLOCATION:POLICY_NO,
                          cppinland:POL_YEAR     = SFPLOCATION:POL_YEAR,
                          cppinland:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
                          cppinland:PREM_NO      = SFPLOCATION:PREM_NO,
                          cppinland:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

    access cppimcov, set cppimcov:policy_no      = sfplocation:policy_no,
                         cppimcov:pol_year       = sfplocation:pol_year,
                         cppimcov:end_sequence   = sfplocation:end_sequence, generic

    while cppimcov:policy_no = sfplocation:policy_no and
          cppimcov:pol_year = sfplocation:pol_Year and
          cppimcov:end_Sequence = sfplocation:end_sequence
            begin
            L_SFPLOCATION_ZIP = If (Val(SFPLOCATION:STR_ZIPCODE[6,9]) = 0) Then
                                    SFPLOCATION:STR_ZIPCODE[1,5]
                                Else
                                    SFPLOCATION:STR_ZIPCODE[1,5] + "-" +
                                    SFPLOCATION:STR_ZIPCODE[6,9]

            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
            Writefile(L_FILE_NAME,"%s","Prem No. ")
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:PREM_NO,"ZZZZ"))
            Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","Bldg No. ")
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:BUILD_NO,"ZZZZ"))
            Writefile(L_FILE_NAME,"%s","<033>&a1600h+0V")
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"----->%s",str(cppimcov:limit,"ZZ,ZZZ,ZZZ"))

            Writefile(L_FILE_NAME,"%s",L_push)
                l_font = l_arial_bold_9
                l_v_position = "+0"
                l_h_position = "2200"
                l_character_string = uppercase(cppimcov:description)
                l_max_char = 30
                include "line_spacing.inc"
            Writefile(L_FILE_NAME,"%s",L_pop)
            if cppimcov:see_form = 0 then
                begin
                Writefile(L_FILE_NAME,"%s","<033>&a4550h+0V")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",str(cppimcov:deductible,"ZZZZZ"))
                end
            else
                begin
                Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                writefile(l_file_name,"%s","See Form")
                end
            Writefile(L_FILE_NAME,"%s","<033>&a4990h+0V")
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s",str(cppimcov:premium,"ZZZ,ZZZ,ZZZ"))
            L_LINE_COUNTER = L_LINE_COUNTER + 1
                Writefile(L_FILE_NAME,"%s","<NL>")

            next cppimcov
            end

    end

end


Procedure Coverages_provided2

{
  If CPPGENERAL:LIMIT[2] <> 0 Then
          {
            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
            Writefile(L_FILE_NAME,"%s","Prem No. ")
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:PREM_NO,"ZZZZ"))
            Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","Bldg No. ")
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:BUILD_NO,"ZZZZ"))
            L_LINE_COUNTER = L_LINE_COUNTER + 1

            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s","<033>&a1620h+0V")
            Writefile(L_FILE_NAME,"%s",str(CPPGENERAL:LIMIT[2],"ZZZ,ZZZ,ZZZ"))

            Access SFSFORM,
               Set SFSFORM:COMPANY_ID       = L_COMPANY_ID,
                   SFSFORM:STATE            = L_STATE2,
                   SFSFORM:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                   SFSFORM:POLICY_FORM      = L_FORM, Generic

-- added l_arial_bold_9 becasue of print order
-- previous cppgeneral:limit[2] cause wording to be l_arial_gothic

            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","<033>&a3300h+0V")
            Writefile(L_FILE_NAME,"%s",SFSFORM:DESCRIPTION)

            Writefile(L_FILE_NAME,"%s","<033>&a4070h+0V")
            Writefile(L_FILE_NAME,"%s",str(CPPGENERAL:COINSURANCE,"ZZZ"))
            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","%")

            If CPPGENERAL:CONTENTS_DEDUCTIBLE <> 0 Then
              {
                Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s","$")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",str(CPPGENERAL:CONTENTS_DEDUCTIBLE,"ZZZ,ZZZ"))
              }
            Else
              {
                Writefile(L_FILE_NAME,"%s","<033>&a4855h+0V")
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
              }
            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","<033>&a5150h+0V")
            Writefile(L_FILE_NAME,"%s","$")
            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
            Writefile(L_FILE_NAME,"%s",Str(CPPGENERAL:TOTAL_PREMIUM[2] + l_optional_coverages,"ZZZ,ZZZ"))

            Access CPSRATETYPE,
               Set CPSRATETYPE:COMPANY_ID       = L_COMPANY_ID,
                   CPSRATETYPE:STATE            = L_STATE2,
                   CPSRATETYPE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                   CPSRATETYPE:RATE_TYPE        = CPPGENERAL:RATE_TYPE, generic

            If CPPGENERAL:RATE_TYPE <> 1 then
              {
                if cppgeneral:rate_type one of 4,5 then
                  {
                    l_font = l_arial_bold_9
                    l_v_position = "+0"
                    l_h_position = "2250"
                    l_character_string = CPSRATETYPE:DESCRIPTION
                    l_max_char = 15
                    include "line_spacing.inc"
                    Writefile(L_FILE_NAME,"%s","<033>&a2300h-240V")
                  }
                else
                  if cppgeneral:rate_type = 3 then
                  {
                    l_font = l_arial_bold_9
                    l_v_position = "+0"
                    l_h_position = "2250"
                    l_character_string = CPSRATETYPE:DESCRIPTION
                    l_max_char = 15
                    include "line_spacing.inc"
                    Writefile(L_FILE_NAME,"%s","<033>&a2300h-120V")

                  }
              }
            Else
              {
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s","<033>&a2250h+0V")
                Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:LIMIT_NAME[2])
              }
            Writefile(L_FILE_NAME,"%s","<033>&a5100h+120V")
            Writefile(L_FILE_NAME,"%s",l_arial_bold_9)
            L_LINE_COUNTER = L_LINE_COUNTER + 1
          }
}


Procedure PREMIUM_BASIS

{
  Writefile(L_FILE_NAME,"%s","<FF>")
  L_LINE_COUNTER = 0
--  L_PAGE_NUMBER = 0

  If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
      Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
      Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
    }
  L_PAGE_NUMBER = L_PAGE_NUMBER + 1

  Access SCIPSCONTROL1,
     Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
         SCIPSCONTROL1:STATE      = L_STATE2,
         SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, generic

  Writefile(L_FILE_NAME,"%s","<033>&a200h7130V")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s",trun(SCIPSCONTROL1:PRINT_POLICY_FORM_ON_cpp_DECS[4]))

  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
  Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
  Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
  Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
  Writefile(L_FILE_NAME,"%s","Page ")
  Writefile(L_FILE_NAME,"%n",L_page_number)

  Writefile(L_FILE_NAME,"%s","<033>&a200h300V")
  Writefile(L_FILE_NAME,"%s","COVERAGES SUPPLEMENTAL DECLARATIONS")
  L_LINE_COUNTER = L_LINE_COUNTER + 1

  Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
  L_LINE_COUNTER = L_LINE_COUNTER + 3

  Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
  Writefile(L_FILE_NAME,"%s","Policy # ")
  Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
  Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
  Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

  Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
  Writefile(L_FILE_NAME,"%s","SCHEDULE")
  L_LINE_COUNTER = L_LINE_COUNTER + 2

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
Writefile(L_FILE_NAME,"%s","Premises")
Writefile(L_FILE_NAME,"%s","<033>&a1800h+0V")
Writefile(L_FILE_NAME,"%s","Limits of")

Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Building or Coverage Item #")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a1780h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Insurance")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a2300h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Coverage")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a3200h+0V")
Writefile(L_FILE_NAME,"%s","<033>&a4550h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Deductible")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a5150h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Premium")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)

Writefile(L_FILE_NAME,"%s","<033>&f0S")

L_LOOP = 0
L_SUBTOTAL_PREM = 0
L_SUBTOTAL_PRCO = 0

Access SFPLOCATION,
   Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

    While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
          SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
          SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
      {
        If l_line_counter >= L_MAX_LINES - 8 Then
          {
            Do INSERT_NEWPAGE

            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","<033>&a200h300V")
            Writefile(L_FILE_NAME,"%s","Premises")
            Writefile(L_FILE_NAME,"%s","<033>&a1800h+0V")
            Writefile(L_FILE_NAME,"%s","Limits of")
            Writefile(L_FILE_NAME,"%s","<033>&a3200h+0V")
            Writefile(L_FILE_NAME,"%s","Cause of Loss")
            Writefile(L_FILE_NAME,"%s","<033>&a3900h+0V")
            Writefile(L_FILE_NAME,"%s","Coinsurance")

            Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","Building or Coverage Item #")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            Writefile(L_FILE_NAME,"%s","<033>&a1780h+0V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","Insurance")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            Writefile(L_FILE_NAME,"%s","<033>&a2300h+0V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","Coverage")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            Writefile(L_FILE_NAME,"%s","<033>&a3200h+0V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","     Options      ")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            Writefile(L_FILE_NAME,"%s","<033>&a3900h+0V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","      Factor     ")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            Writefile(L_FILE_NAME,"%s","<033>&a4550h+0V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","Deductible")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            Writefile(L_FILE_NAME,"%s","<033>&a5150h+0V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","Premium")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
          }

            do coverages_provided1


            Writefile(L_FILE_NAME,"%s","<033>&a5100h+120V")
            L_LINE_COUNTER = L_LINE_COUNTER + 1
        Next SFPLOCATION
      }


  Access CPPBUSINESS,
     Set CPPBUSINESS:POLICY_NO    = SFPPRINT1:POLICY_NO,
         CPPBUSINESS:POL_YEAR     = SFPPRINT1:POL_YEAR,
         CPPBUSINESS:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
  Writefile(L_FILE_NAME,"%s","<033>&a3490h+120V")
  Writefile(L_FILE_NAME,"%s","Total Premium")
  Writefile(L_FILE_NAME,"%s","<033>&a4945h+0V")
  Writefile(L_FILE_NAME,"%s","$")
  Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
  Writefile(L_FILE_NAME,"%s",Str(SFPMASTER:TOTAL[6] +
                                 sfpmaster:other_totals[19],"ZZZ,ZZZ,ZZZ"))
  L_LINE_COUNTER = L_LINE_COUNTER + 1

  If SFPMASTER:MINIMUM_PREMIUM[1] = "Y" Then
    {
      Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
      Writefile(L_FILE_NAME,"%s"," MP")
    }

  Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a200h7250V","Issue Date ",
                      Str(SFPNAME:TRANS_DATE,"mm/dd/yyyy"))

/*  If L_PAGE_NUMBER Mod 2 = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<FF>")
      Writefile(L_FILE_NAME,"%s","<FF>")
    }*/
}

End
