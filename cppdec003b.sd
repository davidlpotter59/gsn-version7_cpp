%%        
/*
Date Written: April 10, 2007

Name: cppdec003b.sd     LEBANON ONLY - CPP Liability Dec page

Copyright (c) 2000, SCIPS.com Inc.

Modify
Date                   By                  Comment
--------------------------------------------------------------
04/10/2007             DWR       Changed existing cppdec003 to cppdec003b
                                 versionto be a Lebanon only dec
                                 for Liability Coverages
                                 added to a CPP policy.  All other
                                 companies will use cppdec003 as before.
===========================
*/

Program
  Name = "cppdec003b";
  Type = "File";
  Domain = "SFPPRINT1";
  Padcharacter = Space;

 String L_FILE_NAME[13] = "cppdec003b.cq";
 String L_COPY_NAME[20] ;
 String I_REV_NAME2[50] ;
 String L_POLICY_FORM;
 string l_enter;
 String L_TYPE_STR[35];
 String L_POLICY_DECLARATION[60];
 String L_TRANS_EFF;
 String L_AUDIT;
 String L_PREV_STRING[50];
 String L_INSURED_CITY_STATE[50];
 String L_SFPNAME_ZIP="";
 String L_SFSAGENT;
 String L_SFSMORT_ZIP[10];
 String L_SFPSUPP_ZIP[10];
 String L_AGENT_ADDRESS;
 String L_FOB[75];
 String L_AGENT_TEL[13];
 String L_AGENT_ZIP[10];
 String L_MORGAGE_ID[10];
 String L_COMPANY_ID[10];
 String L_LOB_CODE[10];
 String L_MORTGAGE_TYPE_1[1];
 String L_BILL_PLAN[2];
 String L_STATE;
 string l_first[1] ;
 String L_COMPANY_ZIP[10];
 String L_CPPLIABLIMTS_ZIP[10];
 String L_SFPLOCATION_ZIP[10];
 String L_TERROR_FORM[7];
 string L_EXPOSURE_base[2];
 String L_NEWLINE;
 String L_NEWPAGE_WORDING[100];
 String l_name_code[7] = "Name   ";
 String L_STATE_STR[2];
 String L_CHARACTER_STRING[1000]           = "";
 String L_V_POSITION                       = "";
 String L_H_POSITION                       = "";
 String L_LOB_END_CODE[1];
 String I_CODE[7];
 string l_minimum_premium_1;
 string l_minimum_premium_5 ;
 String l_font[35];
 String l_str_prev_policy_no[9];
 string l_First_1[1]="Y";
 String l_alpha_previous_policy[5];
 String L_PRINTER[4];
 String L_USER_ID[15];
 String L_SIGNATURE_STRING[55];
 string function date_suffix(number);

 Number L_TRANS_CODE;
 Number L_MM_1;
 Number L_DD_1;
 Number L_YY_1;
 Number L_RENEWAL[9];

 Signed ascii number l_endorsement_total[8],
                     l_total_5[9]=0/dec=2,
                     l_total_15[9]=0/dec=2,
                     l_total_11[9]=0/dec=2,
                     l_terrorism_premium[6] ;

 unsigned ascii number l_lob[4];
 unsigned ascii number l_state_1[2];
 unsigned ascii number l_rating_line_of_business[4];
 Unsigned Ascii Number L_SUPPLEMENTAL_SWITCH;
 Unsigned Ascii Number L_DECIPOINT;
 Unsigned Ascii Number L_CHARACTER_PER_INCH;
 Unsigned Ascii Number L_LEN_STRING;
 Unsigned Ascii Number L_PAGE_MIDDLE;
 Unsigned Ascii Number L_HALF_MULTIPLIER;
 Unsigned Ascii Number L_CHAR_MULTIPLIER[10]/decimals=4;
 Unsigned Ascii Number L_PAGE_NUMBER = 1;
 Unsigned Ascii Number L_ITEM_COUNTER;
 Unsigned Ascii Number L_LINE_COUNTER/decimals=2;
 Unsigned Ascii Number L_MED_LIMIT;
 Unsigned Ascii Number L_S_LINE_FOR_AGENT = 0; --start line for agent
 Unsigned Ascii Number L_S_LINE_FOR_LOCATION = 0; --start line for location
 Unsigned Ascii Number L_BIGGER_LINE =0;
 Unsigned Ascii Number L_SCREEN_COR= 0;
 Unsigned Ascii Number L_E_LINE_FOR_INSURED = 0;
 Unsigned Ascii Number L_PAGENUMBER;
 Unsigned Ascii Number L_MAX_LINES;
 Unsigned Ascii Number L_LOCATION_COUNTER;
 Unsigned Ascii Number L_SIZE_COUNTER;
 Unsigned Ascii Number L_first_time;
 Unsigned Ascii Number L_LIABILITY;
 Unsigned Ascii Number L_LINE_OF_BUSINESS[4];
 Unsigned Ascii Number L_INSURED_COUNTER;
 Unsigned Ascii Number L_AGENT_COUNTER;
 Unsigned Ascii Number L_TWO_PLACER;
 Unsigned Ascii Number L_SFSFORM[2];
 Unsigned Ascii Number L_SFSEND_FORM[2];
 Unsigned Ascii Number L_SFPMASTER_FORM[1];
 Unsigned Ascii Number L_LOOP;
 Unsigned Ascii Number L_LOOP1;
 Unsigned Ascii Number L_TOTAL[9];
 Unsigned Ascii Number L_STATE2[2];
 Unsigned Ascii Number L_COUNTY[3];
 Unsigned Ascii Number I_STATE[2];
 Unsigned Ascii Number l_prem_no[4] = 0001;
 Unsigned Ascii Number l_build_no[4] = 0001;
 Unsigned Ascii Number L_SUBTOTAL_PREM[9];
 Unsigned Ascii Number L_SUBTOTAL_PRCO[9];
 Unsigned Ascii Number L_START_PRINT[4]    = 0;   --point to start printing.
 Unsigned Ascii Number L_END_PRINT[4]      = 0;
 Unsigned Ascii Number L_CHARACTER_BREAK   = 0;
 Unsigned Ascii Number L_CHARACTER_COUNTER = 0;
 Unsigned Ascii Number L_MAX_CHAR          = 0;
 Unsigned Ascii Number L_ADD_SPACE[4];
 Unsigned Ascii Number L_DO_ONCE[1];
 Unsigned Ascii Number L_PRINTER_NO[4],
                       l_end_sequence[4],
                       l_year[4] ;

 wdate L_EFF_DATE;
 Wdate L_MESSAGE_EFF_DATE;
 Wdate L_MESSAGE_EXP_DATE;

 Include "csfonts.inc"
 Include "sfsrevname7.var"
 Include "header.var"

Initialization
Deletefile (L_FILE_NAME);
L_COPY_NAME = Uppercase(COMMANDLINE[1,20])
L_PRINTER   = COMMANDLINE[21,24]

Update

Access SFPNAME,
   Set SFPNAME:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPNAME:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPNAME:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access CPPGENERAL ,
   Set CPPGENERAL:POLICY_NO    = SFPPRINT1:POLICY_NO,
       CPPGENERAL:POL_YEAR     = SFPPRINT1:POL_YEAR,
       CPPGENERAL:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPMASTER,
   Set SFPMASTER:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPMASTER:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPMASTER:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPAMT,
   Set SFPAMT:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPAMT:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPAMT:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

l_lob = sfpamt:line_of_business[2]

Access SFPMASTSUPP,
   Set SFPMASTSUPP:POLICY_NO        = SFPPRINT1:POLICY_NO,
       SFPMASTSUPP:POL_YEAR         = SFPPRINT1:POL_YEAR,
       SFPMASTSUPP:END_SEQUENCE     = SFPPRINT1:END_SEQUENCE,
       sfpmastsupp:line_of_business = l_lob, Generic

Access CPPUMBRELLA,
   Set CPPUMBRELLA:POLICY_NO    = SFPPRINT1:POLICY_NO,
       CPPUMBRELLA:POL_YEAR     = SFPPRINT1:POL_YEAR,
       CPPUMBRELLA:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access CPPLIABILITY,
   Set CPPLIABILITY:POLICY_NO    = SFPPRINT1:POLICY_NO,
       CPPLIABILITY:POL_YEAR     = SFPPRINT1:POL_YEAR,
       CPPLIABILITY:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access cppartlimits,
   Set cppartlimits:POLICY_NO    = SFPPRINT1:POLICY_NO,
       cppartlimits:POL_YEAR     = SFPPRINT1:POL_YEAR,
       cppartlimits:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPLOCATION,
   Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPEND,
   Set SFPEND:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPEND:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPEND:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPPRINT3,
   Set SFPPRINT3:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPPRINT3:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPPRINT3:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access sfpprint2,
   Set sfpprint2:POLICY_NO    = SFPPRINT1:POLICY_NO,
       sfpprint2:POL_YEAR     = SFPPRINT1:POL_YEAR,
       sfpprint2:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

L_COMPANY_ID = SFPNAME:COMPANY_ID
L_STATE2     = sfpmaster:STATE
L_COUNTY     = CPPLIABILITY:COUNTY

Access SFSCOMPANY,
   Set SFSCOMPANY:COMPANY_ID = SFPNAME:COMPANY_ID, Exact

Access SFPCURRENT,
   Set SFPCURRENT:POLICY_NO = SFPPRINT1:POLICY_NO, Exact

l_line_of_business = sfpmastsupp:line_of_business
if l_line_of_business one of 11 then
    l_line_of_business = 8

if l_line_of_business = 0 then
   l_line_of_business = sfpname:line_of_business

Access SFSLINE,
   Set SFSLINE:COMPANY_ID       = L_COMPANY_ID,
       SFSLINE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
       sfsline:lob_subline      = "00", Generic

l_rating_line_of_business = sfsline:rating_line_of_business

Access SFSAGENT,
   Set SFSAGENT:COMPANY_ID = SFPNAME:COMPANY_ID,
       SFSAGENT:AGENT_NO   = SFPNAME:AGENT_NO, Exact

Access SFSSTATE,
   Set SFSSTATE:COMPANY_ID = L_COMPANY_ID,
       SFSSTATE:STATE      = L_STATE2,
       SFSSTATE:COUNTY     = L_COUNTY, Exact

Access CPPLIABILITY,
   Set CPPLIABILITY:POLICY_NO    = SFPPRINT1:POLICY_NO,
       CPPLIABILITY:POL_YEAR     = SFPPRINT1:POL_YEAR,
       CPPLIABILITY:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access CPSCLASS,
   Set CPSCLASS:COMPANY_ID       = L_COMPANY_ID,
       CPSCLASS:STATE            = L_STATE2,
       CPSCLASS:LINE_OF_BUSINESS = L_RATING_LINE_OF_BUSINESS,
       CPSCLASS:GROUP_NO         = CPPLIABILITY:GROUP_NO,
       CPSCLASS:SUB_GROUP        = CPPLIABILITY:SUB_GROUP ,
       CPSCLASS:CLASS_CODE       = CPPLIABILITY:CLASS_CODE, Generic

Access CPPLIABLIMITS,
   Set CPPLIABLIMITS:POLICY_NO    = SFPPRINT1:POLICY_NO,
       CPPLIABLIMITS:POL_YEAR     = SFPPRINT1:POL_YEAR,
       CPPLIABLIMITS:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPSUPP,
   Set SFPSUPP:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPSUPP:POL_YEAR     = SFPPRINT1:POL_YEAR ,
       SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic;

access wcsdefault,
   set wcsdefault:company_id = sfpname:company_id, generic

Access wcpgeneral,
   Set wcpgeneral:POLICY_NO    = SFPPRINT1:POLICY_NO,
       wcpgeneral:POL_YEAR     = SFPPRINT1:POL_YEAR,
       wcpgeneral:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic ;


if sfpmastsupp:policy_no <> 0 then
    begin
    l_sfsform           = sfpmastsupp:form
    l_total_5           = sfpmastsupp:total[5]
    l_total_15          = sfpmastsupp:total[15]
    l_total_11          = sfpmastsupp:total[11]
    l_minimum_premium_1 = sfpmastsupp:minimum_premium[1]
    l_minimum_premium_5 = sfpmastsupp:minimum_premium[5]
    l_terrorism_premium = sfpmastsupp:terrorism_premium
    end
else
    begin
    L_SFSFORM           = SFPMASTER:FORM
    l_total_5           = sfpmaster:total[5]
    l_total_15          = sfpmaster:total[15]
    l_total_11          = sfpmaster:total[11]
    l_minimum_premium_1 = sfpmaster:minimum_premium[1]
    l_minimum_premium_5 = sfpmaster:minimum_premium[5]
    l_terrorism_premium = sfpmaster:terrorism_premium
    end

L_LOB_CODE = SFSLINE:LOB_CODE

I_STATE = SFPMASTER:STATE

Access SCIPSCONTROL,
   Set SCIPSCONTROL:COMPANY_ID = L_COMPANY_ID,
       SCIPSCONTROL:STATE      = I_STATE,
       SCIPSCONTROL:LOB_CODE   = L_LOB_CODE, generic

Access SFSMESSAGE,
   Set SFSMESSAGE:COMPANY_ID       = L_COMPANY_ID,
       SFSMESSAGE:STATE            = L_STATE2,
       SFSMESSAGE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS, generic

while SFSMESSAGE:COMPANY_ID       = SFPNAME:COMPANY_ID and
      SFSMESSAGE:STATE            = L_STATE2 and
      SFSMESSAGE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS
   begin
     if sfpname:eff_date <= sfsmessage:exp_date and
        sfpname:eff_date >= sfsmessage:eff_date then
       begin
         L_message_eff_date = sfsmessage:eff_date
         L_message_exp_date = sfsmessage:exp_date
       end
     else
       begin
         l_message_eff_date = 0
         l_message_exp_date = 0
       end

     Next SFSMESSAGE
   end

Access SFSMESSAGE,
   Set SFSMESSAGE:COMPANY_ID       = L_COMPANY_ID,
       SFSMESSAGE:STATE            = L_STATE2,
       SFSMESSAGE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS,
       SFSMESSAGE:EFF_DATE         = L_MESSAGE_EFF_DATE,
       SFSMESSAGE:EXP_DATE         = L_MESSAGE_EXP_DATE, generic

access wcsdefault,
   set wcsdefault:company_id = sfpname:company_id, generic

Access SCIPSCONTROL,
   Set SCIPSCONTROL:COMPANY_ID = L_COMPANY_ID,
       SCIPSCONTROL:STATE      = L_STATE2,
       SCIPSCONTROL:LOB_CODE   = L_LOB_CODE, Generic

if sfpname:str_prev_policy_no <> "" and
   scipscontrol:wc_print_zeros_policy_no = 1 then
  {
    l_str_prev_policy_no = sfpname:str_prev_policy_no
  }

if sfpname:line_of_business one of 99 then
  begin
    L_PREV_STRING = If SFPNAME:STR_PREV_POLICY_NO not one of "", "000000000" and
                       scipscontrol:wc_print_zeros_policy_no = 1 Then
                       sfpname:str_prev_policy_no
                    else
                      if sfpname:previous_policy_no not one of 0 and
                         scipscontrol:wc_print_zeros_policy_no = 0 then
                         str(sfpname:previous_policy_no)
                      Else
                         Str(SFPNAME:policy_no)

switch(sfpname:line_of_business)
  case 99 : l_alpha_previous_policy = wcsdefault:alpha_previous_policy[2]
  default : l_alpha_previous_policy = ""
  end

--if sfsline:lob_code one of "CPORTFOLIO" then
--    l_state_1 = sfpmastsupp:state
--else
    l_state_1 = sfpmaster:state

if l_state_1 = 37 and
   sfpname:previous_policy_no <> 0 and
   sfpname:line_of_business one of 99 and
   sfpname:eff_date < 08.31.2009 then
    begin
    if l_alpha_previous_policy <> "" then
        begin
        switch(l_alpha_previous_policy)
          case "LMP" : switch(wcsdefault:no_zeros_in_policy_no)
                         case 1  : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + "00" + sfpname:str_prev_policy_no
                                   end
                         case 2  : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + "000" + sfpname:str_prev_policy_no
                                   end
                         default : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + sfpname:str_prev_policy_no
                                   end
                         end
          default    : switch(wcsdefault:no_zeros_in_policy_no)
                         case 1  : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + "0" + sfpname:str_prev_policy_no
                                   end
                         case 2  : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + "00" + sfpname:str_prev_policy_no
                                   end
                         default : begin
                                   l_prev_string = trun(l_alpha_previous_policy) + sfpname:str_prev_policy_no
                                   end
                         end
          end
        end
    else
        begin
        l_prev_string = str(sfpname:previous_policy_no)
        end
    end
    end
else
    begin
    l_end_sequence = 0
    l_year = sfpprint1:pol_year - 1
    access sfpname_alt, set sfpname_alt:policy_no = sfpprint1:policy_no,
                            sfpname_alt:pol_year = l_year,
                            sfpname_alt:end_sequence = l_end_sequence, generic

    if sfpname_alt:policy_no = sfpprint1:policy_no and
       sfpname_alt:pol_year = l_year and
       sfpname_alt:end_sequence = l_end_sequence then
        begin
        L_PREV_STRING = Str(SFPNAME:POLICY_NO)
        end
    else
        begin
        L_PREV_STRING = If (SFPNAME:PREVIOUS_POLICY_NO <> 0) Then
                            Str(SFPNAME:PREVIOUS_POLICY_NO)
                        Else
                            Str(SFPNAME:POLICY_NO)
        end
    end

L_POLICY_DECLARATION = Trun(SFSLINE:DESCRIPTION) + " " + "POLICY DECLARATIONS"

L_AGENT_TEL = SFSAGENT:TELEPHONE[1];

L_SFSAGENT = If (Val(SFSAGENT:ZIPCODE_1_4) = 0) Then
               SFSAGENT:ZIPCODE_5_9
             Else
               SFSAGENT:ZIPCODE_5_9 + "-" + SFSAGENT:ZIPCODE_1_4

L_SFPNAME_ZIP = If (Val(SFPNAME:STR_ZIPCODE[6,9]) = 0) Then
                  SFPNAME:STR_ZIPCODE[1,5]
                Else
                  SFPNAME:STR_ZIPCODE[1,5] + "-" +
                  SFPNAME:STR_ZIPCODE[6,9]

L_CPPLIABLIMTS_ZIP = If (Val(CPPLIABLIMITS:STR_ZIPCODE[6,9]) = 0) Then
                       CPPLIABLIMITS:STR_ZIPCODE[1,5]
                     Else
                       CPPLIABLIMITS:STR_ZIPCODE[1,5] + "-" +
                        CPPLIABLIMITS:STR_ZIPCODE[6,9]

L_INSURED_CITY_STATE = Trun(SFPNAME:CITY) + ", " + SFPNAME:STR_STATE + "  " + L_SFPNAME_ZIP

L_AGENT_ZIP =  If (Val(SFSAGENT:STR_ZIPCODE[6,9]) = 0) Then
                 SFSAGENT:STR_ZIPCODE[1,5]
               Else
                 SFSAGENT:STR_ZIPCODE[1,5] + "-" +
                 SFSAGENT:STR_ZIPCODE[6,9]

L_COMPANY_ZIP =  If (Val(SFSCOMPANY:STR_ZIPCODE[6,9]) = 0) Then
                   SFSCOMPANY:STR_ZIPCODE[1,5]
                 Else
                   SFSCOMPANY:STR_ZIPCODE[1,5] + "-" +
                   SFSCOMPANY:STR_ZIPCODE[6,9]

L_COMPANY_ID = SFPNAME:COMPANY_ID

L_AGENT_ADDRESS = SFSAGENT:CITY + ", " + SFSAGENT:STR_STATE

L_MED_LIMIT = SFPMASTER:MEDICAL_LIMIT

Switch(SFPMASTER:FORM_OF_BUSINESS)
  Case 'C' : L_FOB = "Corporation"
  Case 'I' : L_FOB = "Individual"
  Case 'J' : L_FOB = "Joint Venture"
  Case 'O' : L_FOB = "Organization"
  Case 'P' : L_FOB = "Partnership"
  Case 'T' : L_FOB = SFPMASTER:FOB_DESCRIPTION
End

L_TRANS_CODE = SFPMASTER:TRANS_CODE
L_MM_1       = Month(SFPMASTER:TRANS_EFF)
L_DD_1       = Day(SFPMASTER:TRANS_EFF)
L_YY_1       = Year(SFPMASTER:TRANS_EFF)
L_AUDIT      = SFPMASTER:AUDIT

L_TRANS_EFF = Str(L_MM_1) + "/" + Str(L_DD_1) + "/" + Str(L_YY_1)
Include "swudeccs.inc"

Switch(SFPMASTER:LIABILITY_CODE)
  Case 1 : L_LIABILITY = 300000
  Case 2 : L_LIABILITY = 500000
  Case 3 : L_LIABILITY = 1000000
End

L_MAX_LINES        = 60
L_SIZE_COUNTER     = 0
L_LINE_COUNTER     = 1
L_PAGENUMBER       = 1
L_LOCATION_COUNTER = 1
L_INSURED_COUNTER  = 0
L_AGENT_COUNTER    = 0
L_STATE_STR        = SFSCOMPANY:STR_STATE
L_USER_ID          = USERNAME
L_PRINTER_NO       = Val(L_PRINTER)

Access SFSPRINTER,
   Set SFSPRINTER:COMPANY_ID = L_COMPANY_ID,
       SFSPRINTER:USER_ID    = L_USER_ID,
       SFSPRINTER:PRINTER_NO = L_PRINTER_NO, Exact

Writefile(L_FILE_NAME,"%s",l_reset)
If uppercase(L_COPY_NAME) one of "ORIGINAL" and
   sfpname:line_of_business not one of 99, 8, 2 then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&l",Trun(SCIPSCONTROL:PAPER_TRAY[1]),"H")
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&l",Trun(SCIPSCONTROL:PAPER_TRAY[3]),"H")
  }

Writefile(L_FILE_NAME,"%s",L_LEDUP)

If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
  {
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")
    Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P")
    Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P")
  }

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
Writefile(L_FILE_NAME,"%s",L_COPY_NAME)

do check_payor_flags

Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
Writefile(L_FILE_NAME,"%s","Page ")
Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

L_POLICY_DECLARATION = uppercase(SCIPSCONTROL:CPP_HEADING[4])
Include "header3.inc"

Writefile(L_FILE_NAME,"%s%s","<NL>","<033>&f0S") --pushed memory location on stack
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s%s%s%s","<033>&f1S",L_ARIAL_12,"<033>&a300h+30V",
                      "Policy Number","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD_14,"<033>&a300h+20V",Trun(SFSLINE:ALPHA),
                      trun(str(SFPPRINT1:POLICY_NO)))

If scipscontrol:payor_code_bottom_of_page not one of 1 then   --put it on the top of dec by policy number
  {
    If SCIPSCONTROL:DONT_PRINT_PAYOR_CODE_ALL_COPY = 1 then
      {
        If SCIPSCONTROL:PAYOR_CODES = 1 and
          trun(uppercase(SCIPSCONTROL:PAY_CODE_COPY_NAME)) = trun(uppercase(L_COPY_NAME)) Then
          {
            do print_payor_codes
          }
      }
    Else
      If SCIPSCONTROL:PAYOR_CODES = 1 Then
        {
          do print_payor_codes
        }
  }

If SFPNAME:POLICY_TYPE = "W" and
   sfpmaster:trans_code one of 10, 14 Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%s%s","<NL>",L_ARIAL_BOLD_12,"<033>&a300h+80V",
                          "Rewrite of ",L_PREV_STRING)
    L_LINE_COUNTER = L_LINE_COUNTER + 1
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%s","<NL>",L_ARIAL_BOLD_12,
                           "<033>&a300h+80V",L_TYPE_STR)
    L_LINE_COUNTER = L_LINE_COUNTER + 1
  }

If (L_TRANS_CODE One Of 12,13) Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%n",L_ARIAL_BOLD_12,"<033>&a3900h+0V",
                          "Endorsement #",SFPNAME:ENDORSEMENT_NUMBER)
  }
Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%n%s","<NL>","<NL>",L_ARIAL_BOLD,
                      "<033>&a200h+0V","","<033>&a350h+0V",
                      "Named Insured and Mailing Address","<033>&a3000h+0V",
                      "Agent -","<033>&a3400h+0V",SFSAGENT:AGENT_NO,"<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 3

Writefile(L_FILE_NAME,"%s%s","<033>&f0S",L_ARIAL_8)

I_NAME=SFPNAME:NAME[1,1,40]
Include "sfsrevname7.pro"
If SFPNAME:NAME[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

I_NAME=SFPNAME:NAME[2,1,40]
Include "sfsrevname7.pro"
If SFPNAME:NAME[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

I_NAME=SFPNAME:NAME[3,1,40]
Include "sfsrevname7.pro"
If SFPNAME:NAME[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

If (SFPNAME:ADDRESS[1,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",SFPNAME:ADDRESS[1],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
If (SFPNAME:ADDRESS[2,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",SFPNAME:ADDRESS[2],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
If (SFPNAME:ADDRESS[3,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",SFPNAME:ADDRESS[3],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",L_INSURED_CITY_STATE,"<NL>")
L_INSURED_COUNTER = L_INSURED_COUNTER +1

Writefile(L_FILE_NAME,"%s%s","<033>&f1S",L_ARIAL_8)
Writefile(L_FILE_NAME,"%s","<033>&f0S") --Push

Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",
                        SFSAGENT:NAME[1],"<NL>")
L_AGENT_COUNTER = L_AGENT_COUNTER +1

If SFSAGENT:NAME[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:NAME[2],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER + 1
  }
If SFSAGENT:NAME[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:NAME[3],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[1],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[2],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[3],
                          "<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a3000h+0V",Trun(SFSAGENT:CITY),", ",
                      SFSAGENT:STR_STATE," ",L_AGENT_ZIP,"<NL>")
L_AGENT_COUNTER = L_AGENT_COUNTER +1

If SFSAGENT:TELEPHONE[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%s %s-%s%s","<033>&a3000h+0V",
                          "(",L_AGENT_TEL[1,3],")",L_AGENT_TEL[4,6],
                          L_AGENT_TEL[7,10],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If L_INSURED_COUNTER < L_AGENT_COUNTER Then
  {
    L_TWO_PLACER = L_AGENT_COUNTER * 100 + 40
    L_LINE_COUNTER = L_LINE_COUNTER + L_AGENT_COUNTER
  }
Else
  {
    L_TWO_PLACER = L_INSURED_COUNTER * 100 + 40
    L_LINE_COUNTER = L_LINE_COUNTER + L_INSURED_COUNTER
  }

Writefile(L_FILE_NAME,"%s","<033>&f1S") --POP

Writefile(L_FILE_NAME,"%s%n%s","<033>&a140h+",L_TWO_PLACER,"V")
Writefile(L_FILE_NAME,"%s%s","<033>*c5455h20v0P","<NL>") --under name horizontal line to
L_LINE_COUNTER = L_LINE_COUNTER + 0.5

Writefile(L_FILE_NAME,"%s","<033>&f0S")

if l_total_5 <> 0 and
   l_total_15 <> 0 then
  {
    Access sfpprint1_alias,
       Set sfpprint1_alias:policy_no    = SFPPRINT1:POLICY_NO,
           sfpprint1_alias:pol_year     = SFPPRINT1:POL_YEAR,
           sfpprint1_alias:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

    If l_total_5 <> 0 and
       sfpprint1:which_dec_to_use <> 2 then
      {
        change sfpprint1_alias
          begin
            sfpprint1_alias:which_dec_to_use = 2
          end
        Do LIABILITY
      }

  }
Else --used when one OR the other liability premium exists, NOT BOTH
  {
    If l_total_5 <> 0  then
      {
        Do LIABILITY
      }

  }
Writefile(L_FILE_NAME,"%s%s","<033>&a140h+40V<033>*c5455h15v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.33
Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_16)
Writefile(L_FILE_NAME,"%s","<033>&a420h+120V")
L_LINE_COUNTER = L_LINE_COUNTER + 1
Writefile(L_FILE_NAME,"%s","This Policy Contains Aggregate Limits: See Part II D 2 for Details")
Writefile(L_FILE_NAME,"%s%s%s","<NL>","<NL>","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 3

If ((SFSMESSAGE:NEW          = 1 and
     sfpmaster:trans_code one of 10) or
   (SFSMESSAGE:RENEWAL       = 1 and
     sfpmaster:trans_code one of 14) or
   (SFSMESSAGE:ENDORSEMENT   = 1 and
     sfpmaster:trans_code one of 12, 13) or
   (SFSMESSAGE:CANCELLATION  = 1 and
     sfpmaster:trans_code one of 11) or
   (SFSMESSAGE:REINSTATEMENT = 1 and
     sfpmaster:trans_code one of 16) or
   SFSMESSAGE:ALL            = 1) then
  begin
    If (L_LINE_COUNTER > (L_MAX_LINES - 10)) Then
      begin
        Do INSERT_NEWPAGE
      end
    Writefile(L_FILE_NAME,"%s","<033>&a220h+320V")
    L_LINE_COUNTER = L_LINE_COUNTER + 2.67
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_12)
    Writefile(L_FILE_NAME,"%s","Important Messages")
  end

If L_TRANS_CODE one of 10 and
   SFSMESSAGE:NEW = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }

    L_FONT             = L_ARIAL
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:NEW_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 11 and
   SFSMESSAGE:CANCELLATION = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAl
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:CANCELLATION_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 14 and
   SFSMESSAGE:RENEWAL = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:RENEWAL_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 16 and
   SFSMESSAGE:NEW = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:REINSTATEMENT_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 12,13 and
   SFSMESSAGE:ENDORSEMENT = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:ENDORSEMENT_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If SFSMESSAGE:ALL = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:ALL_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }

Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a200h7250V","Issue Date ",
                      Str(SFPNAME:TRANS_DATE,"mm/dd/yyyy"))


If L_PAGE_NUMBER = 1 or
   l_line_counter >= L_MAX_LINES - 6 Then
   {
     Do INSERT_NEWPAGE
   }

Do FORMS --Runs procedure for Options & mandatory endorsement forms

do signature
    If l_total_5 <> 0  then
      {
        Do liability_rate_supplemental
      }
If L_SUPPLEMENTAL_SWITCH > 13 or
   cppliablimits:form = 2  Then
  {
    Do LOCATION
  }
if l_supplemental_switch > 13 or
   cppliablimits:form = 2 then
  {
    Do PREMIUM_BASIS
  }

If l_page_number = 1 or
   l_line_counter >= L_MAX_LINES - 6 Then
  {
    Do INSERT_NEWPAGE
  }

Screen Exit
Writefile(L_FILE_NAME,"%s%s",L_FORMFEED ,L_RESET )
Closefile(L_FILE_NAME)

Procedure Definition

procedure signature

BEGIN
  Writefile(L_FILE_NAME,"%s%s%s","<nl>","<NL>","<NL>")

If (SCIPSCONTROL:COUNTERSIGNATURE_DATE = 1) Then
  {
    Writefile(L_FILE_NAME,"%s","<033>&a800h+360V")
    l_line_counter = l_line_counter + 3
    Writefile(L_FILE_NAME,"%s",l_arial)
    Writefile(L_FILE_NAME,"%s","Countersigned this ")
    Writefile(L_FILE_NAME,"%s",date_suffix(val(str(todaysdate,"DD"))))         --this will print out day with th, nd,rd, or th
    Writefile(L_FILE_NAME,"%s"," day of ")
    Writefile(L_FILE_NAME,"%s",str(todaysdate,"MMMMMMMMMMMM"))
    Writefile(L_FILE_NAME,"%s",", ")
    Writefile(L_FILE_NAME,"%s,",str(todaysdate,"YYYY"))

    If (SCIPSCONTROL:SIGNATURE_2 = 1) Then
      {
        --the next line of code will be used to a signature
        L_SIGNATURE_STRING = "<033>" + Trun(SCIPSCONTROL:SIGNATURE_SYMBOL_SET_2) +
                             "<033>" + Trun(SCIPSCONTROL:SIGNATURE_DEFINITION_2)
        Writefile(L_FILE_NAME,"%s","<033>&a")
        Writefile(L_FILE_NAME,"%n",SCIPSCONTROL:SIGNATURE_HOZ_POS+2800)
        Writefile(L_FILE_NAME,"%s","h-20V")
        Writefile(L_FILE_NAME,"%s",trun(L_SIGNATURE_STRING))
        Writefile(L_FILE_NAME,"%s",Trun(SCIPSCONTROL:SIGNATURE_STRING_TO_PRINT_2))
        Writefile(L_FILE_NAME,"%s","<033>&a+0h+20V")
      }
    Writefile(L_FILE_NAME,"%s",l_arial)
    Writefile(L_FILE_NAME,"%s","<033>&a800h+120V")
    Writefile(L_FILE_NAME,"%s","Agent.")
  }
END

string function date_suffix(number p_day)

BEGIN
  STRING l_updated_date[5];
  switch (p_day)
    case 1,21,31 : l_updated_date = STR(p_day) + "st"
    case 2,22 : l_updated_date = str(p_day) + "nd"
    case 3,23 : l_updated_date = str(p_day) + "rd"
    default : l_updated_date = str(p_day) + "th"
  end
  return l_updated_date
END

procedure check_payor_flags
  {
    if scipscontrol:payor_code_bottom_of_page one of 1 and
       sfpname:eff_date >= scipscontrol:payor_code_bottom_page_date then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a4000h+0V")
        If SCIPSCONTROL:DONT_PRINT_PAYOR_CODE_ALL_COPY = 1 then
          {
            If SCIPSCONTROL:payor_code_bottom_of_page one of 1 and
               trun(uppercase(SCIPSCONTROL:PAY_CODE_COPY_NAME)) = trun(uppercase(L_COPY_NAME)) Then
              {
                do print_payor_codes
              }
          }
        else
          {
            If SCIPSCONTROL:payor_code_bottom_of_page one of 1 then
              {
                do print_payor_codes
              }
          }
      }
  } --end of procedure check_payor_flags

Procedure print_payor_codes
  {
    L_BILL_PLAN = SFPNAME:BILL_PLAN
    if sfpsupp:agent_payor = 1 then
        l_mortgage_type_1 = "G"
    else
    If SFPSUPP:MORTGAGE_TYPE_1 = "" Then
      {
        L_MORTGAGE_TYPE_1 = " "
      }
    Else
      {
        L_MORTGAGE_TYPE_1 = SFPSUPP:MORTGAGE_TYPE_1
      }
    Access SFSPAYCODE,
       Set SFSPAYCODE:COMPANY_ID      = L_COMPANY_ID,
           SFSPAYCODE:BILL_PLAN       = L_BILL_PLAN,
           SFSPAYCODE:MORTGAGE_TYPE_1 = L_MORTGAGE_TYPE_1, Generic

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a+0h+0V")
    Writefile(L_FILE_NAME,"%s"," - ")
    Writefile(L_FILE_NAME,"%s",SFPNAME:BILL_PLAN)
    Writefile(L_FILE_NAME,"%s"," - ")
    Writefile(L_FILE_NAME,"%s",SFSPAYCODE:PAY_CODE)
  } --End Procedure print_payor_codes

Procedure INSERT_NEWPAGE
  {
    Writefile(L_FILE_NAME,"%s","<FF>")
    if l_page_number mod 2 = 0 then
      {
        Writefile(L_FILE_NAME,"%s","<FF>")
        l_page_number = l_page_number + 1
      }
    else
      {
        L_PAGE_NUMBER = L_PAGE_NUMBER + 1
      }
    L_LINE_COUNTER = 0
    If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
        Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
        Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
      }
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
    Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
    Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
    Writefile(L_FILE_NAME,"%s","Page ")
    Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a200h120V")
    L_LINE_COUNTER = L_LINE_COUNTER + 1
    Writefile(L_FILE_NAME,"%s",uppercase(L_POLICY_DECLARATION))
    Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
    Writefile(L_FILE_NAME,"%s","Policy No. ")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
    Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

    Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
    L_LINE_COUNTER = L_LINE_COUNTER + 2.33

  }--End procedure INSERT_NEWPAGE

Procedure LOCATION
  {
    Writefile(L_FILE_NAME,"%s","<FF>")
    L_PAGE_NUMBER = L_PAGE_NUMBER + 1
    if l_page_number mod 2 = 0 then
      {
        Writefile(L_FILE_NAME,"%s","<FF>")
        l_page_number = l_page_number + 1
      }
    L_LINE_COUNTER = 0
    If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
        Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
        Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
      }
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
    Writefile(L_FILE_NAME,"%s",L_COPY_NAME)

    Writefile(L_FILE_NAME,"%s","<033>&a200h300V")
    Writefile(L_FILE_NAME,"%s","LOCATION OF PREMISES SUPPLEMENTAL")
    L_LINE_COUNTER = L_LINE_COUNTER + 2.5

    Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
    L_LINE_COUNTER = L_LINE_COUNTER + 0.33

    Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
    Writefile(L_FILE_NAME,"%s","Policy # ")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
    Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

    Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
    Writefile(L_FILE_NAME,"%s","SCHEDULE")
    L_LINE_COUNTER = L_LINE_COUNTER + 2

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
    Writefile(L_FILE_NAME,"%s","Location of Premises you own, rent or occupy")
    L_LINE_COUNTER = L_LINE_COUNTER + 2

    Access SFPLOCATION,
       Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
           SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
           SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, generic

     While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
           SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
           SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
       {
         L_NEWPAGE_WORDING = "LOCATION OF PREMISES SUPPLEMENTAL DECLARATIONS"
         do new_supplemental_page
         L_sfplocation_ZIP = If (Val(sfplocation:STR_ZIPCODE[6,9]) = 0) Then
                                sfplocation:STR_ZIPCODE[1,5]
                             Else
                                sfplocation:STR_ZIPCODE[1,5] + "-" +
                                sfplocation:STR_ZIPCODE[6,9]

         Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
         Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
         Writefile(L_FILE_NAME,"%s","Prem No. ")
         Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
         Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:PREM_NO,"ZZZZ"))
         Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
         Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
         Writefile(L_FILE_NAME,"%s","Bldg No. ")
         Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
         Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:BUILD_NO,"ZZZZ"))
         Writefile(L_FILE_NAME,"%s",L_ARIAL_bold)
         L_LINE_COUNTER = L_LINE_COUNTER + 2
         Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
         Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
         L_LINE_COUNTER = L_LINE_COUNTER + 1
         Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:ADDRESS))
         for l_loop1 = 1 to 3
           {
             if trun(sfplocation:address1[l_loop1]) <> "" then
               {
                 Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
                 Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:address1[l_loop1]))
                 l_line_counter = l_line_counter + 1
               }
           }
         Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
         Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:CITY))
         Writefile(L_FILE_NAME,"%s",", ")
         Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:STR_STATE))
         Writefile(L_FILE_NAME,"%s","  ")
         Writefile(L_FILE_NAME,"%s",L_SFPLOCATION_ZIP)
         L_LINE_COUNTER = L_LINE_COUNTER + 1

         Next SFPLOCATION
      }
    If l_page_number mod 2 = 0 then
      {
        Writefile(L_FILE_NAME,"%s","<FF>")
      }

    If L_LINE_COUNTER < L_MAX_LINES - 9  and
       cppliablimits:form = 2 Then
      {
        Writefile(L_FILE_NAME,"%s",L_ARIAL_bold_9)
        Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
        L_LINE_COUNTER = L_LINE_COUNTER + 2
        Writefile(L_FILE_NAME,"%s","CONTRACTORS MAILING ADDRESS")
        Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
      }

    If cppliablimits:form = 2 then  --CONTRACTORS ADDRESS if form 2
      {
        access cppendorse,
               cppendorse:policy_no    = sfpprint1:policy_no,
               cppendorse:pol_year     = sfpprint1:pol_year,
               cppendorse:end_sequence = sfpprint1:end_sequence,
               cppendorse:prem_no      = l_prem_no,
               cppendorse:build_no     = l_build_no,
               cppendorse:code         = L_name_code, generic

        while  cppendorse:policy_no    = sfpprint1:policy_no and
               cppendorse:pol_year     = sfpprint1:pol_year and
               cppendorse:end_sequence = sfpprint1:end_sequence and
               cppendorse:prem_no      = l_prem_no and
               cppendorse:build_no     = l_build_no and
               cppendorse:code         = L_name_code
          {
            Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
            L_NEWPAGE_WORDING = "CONTRACTORS MAILING SUPPLEMENTAL DECLARATIONS"
            do new_supplemental_page
            L_LINE_COUNTER = L_LINE_COUNTER + 1
            for l_loop = 1 to 3
              {
                if trun(cppendorse:name[l_loop]) <> "" then
                  {
                    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
                    Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
                    Writefile(L_FILE_NAME,"%s",Trun(cppendorse:name[l_loop]))
                    L_LINE_COUNTER = L_LINE_COUNTER + 1
                  }
              }
            Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
            Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
            Writefile(L_FILE_NAME,"%s",Trun(cppendorse:address))
            L_LINE_COUNTER = L_LINE_COUNTER + 1
            for l_loop = 1 to 2
              {
                if trun(cppendorse:address1[l_loop]) <> "" then
                  {
                    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
                    Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
                    Writefile(L_FILE_NAME,"%s",Trun(cppendorse:address1[l_loop]))
                    L_LINE_COUNTER = L_LINE_COUNTER + 1
                  }
              }
            Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
            Writefile(L_FILE_NAME,"%s",Trun(cppendorse:CITY))
            Writefile(L_FILE_NAME,"%s",", ")
            Writefile(L_FILE_NAME,"%s",Trun(cppendorse:STR_STATE))
            Writefile(L_FILE_NAME,"%s","  ")
            L_sfplocation_ZIP = If (Val(cppendorse:STR_ZIPCODE[6,9]) = 0) Then
                                  cppendorse:STR_ZIPCODE[1,5]
                                Else
                                  cppendorse:STR_ZIPCODE[1,5] + "-" +
                                  cppendorse:STR_ZIPCODE[6,9]

            Writefile(L_FILE_NAME,"%s",L_SFPLOCATION_ZIP)
            L_LINE_COUNTER = L_LINE_COUNTER + 1
            next cppendorse
          } -- while cppendorse
      }-- if cppliablimits:form = 2
    If L_PAGE_NUMBER Mod 2 = 1 Then
      {
        Writefile(L_FILE_NAME,"%s","<FF>")
      }
  }--End Procedure LOCATION

procedure new_supplemental_page

  {
    If L_LINE_COUNTER > L_MAX_LINES - 7 Then
      {
        If L_PAGE_NUMBER = 1 Then
          {
            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","<033>&a5000h7250V")
            Writefile(L_FILE_NAME,"%s","Page ")
            Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)
          }
        Writefile(L_FILE_NAME,"%s","<FF>")
        L_LINE_COUNTER = 0
        If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
          {
            Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
            Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
            Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
            Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
          }
        L_PAGE_NUMBER = L_PAGE_NUMBER + 1

        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
        Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
        Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
        Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
        Writefile(L_FILE_NAME,"%s","Page ")
        Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
        Writefile(L_FILE_NAME,"%s","<033>&a200h120V")
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        Writefile(L_FILE_NAME,"%s",TRUN(L_NEWPAGE_WORDING))
        Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
        Writefile(L_FILE_NAME,"%s","Policy No. ")
        Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
        Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
        Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

        Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
        L_LINE_COUNTER = L_LINE_COUNTER + 2.33
      }
  }--End procedure new_supplemental_page

Procedure PREMIUM_BASIS
  {
    if l_page_number mod 2 = 1 then
      {
        Writefile(L_FILE_NAME,"%s","<FF>")
        l_page_number = l_page_number + 1
      }
    L_LINE_COUNTER = 0
    If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
        Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
        Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
      }
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
    Writefile(L_FILE_NAME,"%s",L_COPY_NAME)

    Writefile(L_FILE_NAME,"%s","<033>&a200h300V")
    L_LINE_COUNTER = L_LINE_COUNTER + 2.5
    Writefile(L_FILE_NAME,"%s","PREMIUM BASIS SUPPLEMENTAL")

    Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
    L_LINE_COUNTER = L_LINE_COUNTER + 2.33

    Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
    Writefile(L_FILE_NAME,"%s","Policy # ")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
    Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

    Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
    Writefile(L_FILE_NAME,"%s","SCHEDULE")
    L_LINE_COUNTER = L_LINE_COUNTER + 2

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a2800h+240V")
    Writefile(L_FILE_NAME,"%s","Premium Basis")
    Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
    Writefile(L_FILE_NAME,"%s","Advance Premium")
    L_LINE_COUNTER = L_LINE_COUNTER + 2

    Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
    L_LINE_COUNTER = L_LINE_COUNTER + 0.83
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","Classification")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a1700h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","Code")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","Prem Ops")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a3400h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","PR/CO")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a4585h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","Prem Ops")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a5240h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","PR/CO")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)

    L_SUBTOTAL_PREM = 0
    L_SUBTOTAL_PRCO = 0
    l_endorsement_total = 0

    Access CPPLIABILITY,
       Set CPPLIABILITY:POLICY_NO    = SFPPRINT1:POLICY_NO,
           CPPLIABILITY:POL_YEAR     = SFPPRINT1:POL_YEAR,
           CPPLIABILITY:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, generic

    l_first = "Y"

    While cppliability:POLICY_NO    = SFPPRINT1:POLICY_NO and
          cppliability:POL_YEAR     = SFPPRINT1:POL_YEAR and
          cppliability:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
        {
          If l_line_counter >= L_MAX_LINES - 5 Then
            {
              If L_PAGE_NUMBER = 1 Then
                {
                  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                  Writefile(L_FILE_NAME,"%s","<033>&a5000h7250V")
                  Writefile(L_FILE_NAME,"%s","Page ")
                  Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)
                }
              Writefile(L_FILE_NAME,"%s","<FF>")
              L_LINE_COUNTER = 0
              If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
                {
                  Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
                  Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
                  Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
                  Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
                }
              L_PAGE_NUMBER = L_PAGE_NUMBER + 1

              Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
              Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
              Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
              Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
              Writefile(L_FILE_NAME,"%s","Page ")
              Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

              Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
              Writefile(L_FILE_NAME,"%s","<033>&a200h120V")
              L_LINE_COUNTER = L_LINE_COUNTER + 1

              Writefile(L_FILE_NAME,"%s","PREMIUM BASIS SUPPLEMENTAL")
              Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
              Writefile(L_FILE_NAME,"%s","Policy No. ")
              Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
              Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
              Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

              Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
              L_LINE_COUNTER = L_LINE_COUNTER + 2.33

              Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
              Writefile(L_FILE_NAME,"%s","<033>&a2800h+0V")
              Writefile(L_FILE_NAME,"%s","Premium Basis")
              Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
              Writefile(L_FILE_NAME,"%s","Advance Premium")

              Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
              L_LINE_COUNTER = L_LINE_COUNTER + 0.83
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
              Writefile(L_FILE_NAME,"%s","Classification")
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
              Writefile(L_FILE_NAME,"%s","<033>&a1700h+0V")
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
              Writefile(L_FILE_NAME,"%s","Code")
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
              Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
              Writefile(L_FILE_NAME,"%s","Prem Ops")
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
              Writefile(L_FILE_NAME,"%s","<033>&a3400h+0V")
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
              Writefile(L_FILE_NAME,"%s","PR/CO")
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
              Writefile(L_FILE_NAME,"%s","<033>&a4585h+0V")
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
              Writefile(L_FILE_NAME,"%s","Prem Ops")
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
              Writefile(L_FILE_NAME,"%s","<033>&a5240h+0V")
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
              Writefile(L_FILE_NAME,"%s","PR/CO")
              Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            }--End If l_line_counter >= L_MAX_LINES - 5

          Access CPPGENERAL ,
             Set CPPGENERAL:POLICY_NO    = SFPLOCATION:POLICY_NO,
                 CPPGENERAL:POL_YEAR     = SFPLOCATION:POL_YEAR,
                 CPPGENERAL:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
                 CPPGENERAL:PREM_NO      = SFPLOCATION:PREM_NO,
                 CPPGENERAL:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

          l_line_of_business = sfsline:rating_line_of_business
          Access CPSCLASS,
             Set CPSCLASS:COMPANY_ID       = L_COMPANY_ID,
                 CPSCLASS:STATE            = L_STATE2,
                 CPSCLASS:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                 CPSCLASS:GROUP_NO         = CPPLIABILITY:GROUP_NO,
                 CPSCLASS:SUB_GROUP        = CPPLIABILITY:SUB_GROUP ,
                 CPSCLASS:CLASS_CODE       = CPPLIABILITY:CLASS_CODE,
                 cpsclass:sub_code         = cppliability:sub_code, Generic

          If (Val(SFPLOCATION:STR_ZIPCODE[6,9]) = 0) Then
            {
              l_sfplocation_zip = SFPLOCATION:STR_ZIPCODE[1,5]
            }
          Else
            {
              l_sfplocation_zip = SFPLOCATION:STR_ZIPCODE[1,5] + "-" +
                                  SFPLOCATION:STR_ZIPCODE[6,9]
            }

          Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
          Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
          Writefile(L_FILE_NAME,"%s","Prem No. ")
          Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
          Writefile(L_FILE_NAME,"%s",Str(cppliability:PREM_NO,"ZZZZ"))
          Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
          Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
          Writefile(L_FILE_NAME,"%s","Bldg No. ")
          Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
          Writefile(L_FILE_NAME,"%s",Str(cppliability:BUILD_NO,"ZZZZ"))
          L_LINE_COUNTER = L_LINE_COUNTER + 1

          Writefile(L_FILE_NAME,"%s","<033>&a2000h+0V")
          Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
          Writefile(L_FILE_NAME,"%s",str(CPPLIABILITY:CLASS_CODE,"99999"))
          Writefile(L_FILE_NAME,"%s",L_ARIAL_9)

          l_exposure_base = CPPLIABILITY:EXPOSURE_base[1]

          Access CPSLIABEXPBASE,
             Set CPSLIABEXPBASE:COMPANY_ID       = L_COMPANY_ID,
                 CPSLIABEXPBASE:STATE            = L_STATE2,
                 CPSLIABEXPBASE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                 CPSLIABEXPBASE:EXPOSURE_BASE    = l_exposure_base, Generic

          Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
          Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
          Writefile(L_FILE_NAME,"%s",trun(l_exposure_base))
          Writefile(L_FILE_NAME,"%s",") ")
          Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
          Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
          Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:exposure[1],"ZZ,ZZZ,ZZZ"))

          l_exposure_base = CPPLIABILITY:EXPOSURE_base[2]

          Access CPSLIABEXPBASE,
             Set CPSLIABEXPBASE:COMPANY_ID       = L_COMPANY_ID,
                 CPSLIABEXPBASE:STATE            = L_STATE2,
                 CPSLIABEXPBASE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                 CPSLIABEXPBASE:EXPOSURE_BASE    = l_exposure_base, Generic

          Writefile(L_FILE_NAME,"%s","<033>&a3400h+0V")
          Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
          Writefile(L_FILE_NAME,"%s",trun(l_exposure_base))
          if cppliability:exposure[2] <> 0 then
            begin
              Writefile(L_FILE_NAME,"%s",") ")
            end
          else
          if cppliablimits:products = 0 then
            begin
              writefile(l_file_name,"%s","EXCL")
            end
          else
          if cppliability:products_limit_table = "-" then
            begin
              writefile(l_file_name,"%s","INCL")
            end
          Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
          Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
          If CPPLIABILITY:exposure[2] <> 0 Then
            {
              Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:exposure[2],"ZZ,ZZZ,ZZZ"))
            }
          Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
          Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
          Writefile(L_FILE_NAME,"%s","$")
          Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
          if l_first_1 = "Y" then
              begin
              if sfpname:eff_date >= scipscontrol:show_account_mod_date then
                  begin
                  Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[1] +
                                  cppliability:minimum_premium_adjustment[1] +
                                  (sfpmaster:other_totals[17] * -1) +
                                  cppliability:fire_legal_premium +
                                  cppliability:total_irpm[1],"ZZZ,ZZZ"))
                  end
              else
                  begin
                  Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[1] +
                             cppliability:minimum_premium_adjustment[1] +
                             (sfpmaster:other_totals[17] * -1) +
                             cppliability:fire_legal_premium,"ZZZ,ZZZ"))
                  end
              end
          else
              begin
              if sfpname:eff_date >= scipscontrol:show_account_mod_date then
                  begin
                  Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[1] +
                                  cppliability:minimum_premium_adjustment[1] +
                                  cppliability:fire_legal_premium +
                                  cppliability:total_irpm[1],"ZZZ,ZZZ"))
                  end
              else
                  begin
                  Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[1] +
                             cppliability:minimum_premium_adjustment[1] +
                             cppliability:fire_legal_premium,"ZZZ,ZZZ"))
                  end
              end

          Writefile(L_FILE_NAME,"%s","<033>&a5115h+0V")
          Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
          if cppliability:prem[2] <> 0 then
            begin
              Writefile(L_FILE_NAME,"%s","$")
            end
          Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
          if sfpname:eff_date >= scipscontrol:show_account_mod_date and
             cppliability:prem[2] <> 0 then
            begin
              Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[2] +
                               cppliability:minimum_premium_adjustment[2] +
                               cppliability:total_irpm[2],"ZZZ,ZZZ"))
            end
          else
          if cppliability:prem[2] <> 0 then
            begin
              Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[2] +
                          cppliability:minimum_premium_adjustment[2],"ZZZ,ZZZ"))
            end
          else
          if cppliablimits:products = 0 then
            begin
            Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
              writefile(l_file_name,"%s","EXCL")
            end
          else
          if cppliability:products_limit_table = "-" then
            begin
            Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
              writefile(l_file_name,"%s","INCL")
            end
          Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
          L_LINE_COUNTER = L_LINE_COUNTER + 1

          If CPPLIABILITY:CLASS_DESCRIPTION <> "" Then
            {
              Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
              L_LINE_COUNTER = L_LINE_COUNTER + 1
              Writefile(L_FILE_NAME,"%s",CPPLIABILITY:CLASS_DESCRIPTION)
            }
          Else
            {
              L_FONT             = L_ARIAL_9
              L_V_POSITION       = "+120"
              L_H_POSITION       = "200"
              L_CHARACTER_STRING = "CPSCLASS"--CPSCLASS:DESCRIPTION
              L_MAX_CHAR         = 80
              Include "line_spacing.inc"
            }
          if l_first_1 = "Y" then
              begin
              l_first_1 = "N"
              if sfpname:eff_date >= scipscontrol:show_account_mod_date then
                  begin
                  L_SUBTOTAL_PREM = L_SUBTOTAL_PREM +
                                CPPLIABILITY:PREM[1] +
                                cppliability:minimum_premium_adjustment[1] +
                                (sfpmaster:other_totals[17] * -1) +
                                cppliability:fire_legal_premium +
                                cppliability:total_irpm[1]
                  L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO +
                                CPPLIABILITY:PREM[2] +
                                cppliability:minimum_premium_adjustment[2] +
                                cppliability:total_irpm[2]
                  end
              else
                  begin
                  L_SUBTOTAL_PREM = L_SUBTOTAL_PREM + CPPLIABILITY:PREM[1] +
                                cppliability:minimum_premium_adjustment[1] +
                                (sfpmaster:other_totals[17] * -1) +
                                cppliability:fire_legal_premium
                  L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO + CPPLIABILITY:PREM[2] +
                                cppliability:minimum_premium_adjustment[2]
                  end
              end
          else
              begin
              if sfpname:eff_date >= scipscontrol:show_account_mod_date then
                  begin
                  L_SUBTOTAL_PREM = L_SUBTOTAL_PREM +
                                CPPLIABILITY:PREM[1] +
                                cppliability:minimum_premium_adjustment[1] +
                                cppliability:fire_legal_premium +
                                cppliability:total_irpm[1]
                  L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO +
                                CPPLIABILITY:PREM[2] +
                                cppliability:minimum_premium_adjustment[2] +
                                cppliability:total_irpm[2]
                  end
              else
                  begin
                  L_SUBTOTAL_PREM = L_SUBTOTAL_PREM + CPPLIABILITY:PREM[1] +
                                cppliability:minimum_premium_adjustment[1] +
                                cppliability:fire_legal_premium
                  L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO + CPPLIABILITY:PREM[2] +
                                cppliability:minimum_premium_adjustment[2]
                  end
              end

          Writefile(L_FILE_NAME,"%s","<033>&a5100h-20V")
          L_LINE_COUNTER = L_LINE_COUNTER - 0.17
          if sfpname:eff_date >= scipscontrol:show_account_mod_date then
            begin
              l_endorsement_total = l_endorsement_total +
                                    cppliability:total_endorsEments +
                                    cppliability:total_irpm[3] +
                                    cppliability:TOTAL_MISC +
                                    cppliability:total_irpm[4]
            end
          else
            begin
              l_endorsement_total = l_endorsement_total +
                                    cppliability:total_endorsEments +
                                    cppliability:TOTAL_MISC
            end
          if (len(trun(cpsclass:description))) > 80 then
            {
              Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
              L_LINE_COUNTER = L_LINE_COUNTER + 1
            }
          Next cppliability
        }--End of outside While

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3000h+380V")
    L_LINE_COUNTER = L_LINE_COUNTER + 1.67
    Writefile(L_FILE_NAME,"%s","Prem Ops and Pr/Co Premium")
    Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
    Writefile(L_FILE_NAME,"%s",Str(L_SUBTOTAL_PREM,"ZZZ,ZZZ"))

    Writefile(L_FILE_NAME,"%s","<033>&a5115h+0V")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    if l_subtotal_prco <> 0 then
      begin
        Writefile(L_FILE_NAME,"%s","$")
      end
    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
    if l_subtotal_prco <> 0 then
      begin
        Writefile(L_FILE_NAME,"%s",Str(L_SUBTOTAL_PRCO,"ZZZ,ZZZ"))
      end
    else
    if cppliablimits:products = 0 then
      begin
        Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
        writefile(l_file_name,"%s","EXCL")
      end
    else
    if cppliability:products_limit_table = "-" then
      begin
        Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
        writefile(l_file_name,"%s","INCL")
      end

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
    Writefile(L_FILE_NAME,"%s","Endorsement Premium")
    Writefile(L_FILE_NAME,"%s","<033>&a4900h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
    Writefile(L_FILE_NAME,"%s",Str(l_endorsement_total,"ZZZ,ZZ9"))

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
    L_LINE_COUNTER = L_LINE_COUNTER + 1
    Writefile(L_FILE_NAME,"%s","Total Advance Premium")
    Writefile(L_FILE_NAME,"%s","<033>&a4900h+0V")
    Writefile(L_FILE_NAME,"%s","$")

    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
    if sfpname:eff_date >= scipscontrol:show_account_mod_date then
      begin
        Writefile(L_FILE_NAME,"%s",Str(l_total_5 +
                                   l_total_11,"ZZZ,ZZZ"))
      end
    else
      begin
        Writefile(L_FILE_NAME,"%s",Str(l_total_5,"ZZZ,ZZZ"))
      end

    If l_minimum_premium_1 = "Y" Then
      {
        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
        Writefile(L_FILE_NAME,"%s"," MP")
      }
    if l_page_number mod 2 = 1 then   --make sure that the supplemental ends on a even page.
      {
        Writefile(L_FILE_NAME,"%s","<FF>")
        l_page_number = l_page_number + 1
      }
  }--End Procedure PREMIUM_BASIS

Procedure HEADINGS
  {
    if sfscompany:company_id NOT one of "LEBINS" then
      {
        If SFPPRINT3:PRINT_FORM    = "Y" And
           SFPPRINT3:LOB_END_CODE  = L_LOB_END_CODE And
           L_LOB_END_CODE one of "L" And
           L_DO_ONCE = 0 Then
          {
            L_DO_ONCE = 1
            Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")
            Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
            Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
            Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial General Liability Coverage Part:")
            Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")
            l_line_counter = l_line_counter + 3
          }
      }
    if sfscompany:company_id NOT one of "LEBINS" then
      {
        If SFPPRINT3:PRINT_FORM    = "Y" And
           SFPPRINT3:LOB_END_CODE  = L_LOB_END_CODE And
           L_LOB_END_CODE          = "P" And
           L_DO_ONCE               = 0 Then
          {
            L_DO_ONCE = 1
            Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")
            Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
            Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
            Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Property Coverage Part:")
            Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")
            l_line_counter = l_line_counter + 3
          }
      }
    if sfscompany:company_id NOT one of "LEBINS" then
      {
        If SFPPRINT3:PRINT_FORM    = "Y" And
           SFPPRINT3:LOB_END_CODE  = L_LOB_END_CODE And
           L_LOB_END_CODE          = "C" And
           L_DO_ONCE               = 0 Then
          {
            L_DO_ONCE = 1
            Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")
            Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
            Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
            Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Crime Coverage Part:")
            Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")
            l_line_counter = l_line_counter + 3
          }
      }
    if sfscompany:company_id NOT one of "LEBINS" then
      {
        If SFPPRINT3:PRINT_FORM    = "Y" And
           SFPPRINT3:LOB_END_CODE  = L_LOB_END_CODE And
           L_LOB_END_CODE          = "I" And
            L_DO_ONCE              = 0 Then
          {
            L_DO_ONCE = 1
            Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")
            Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
            Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
            Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Inland Marine Coverage Part:")
            Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")
            l_line_counter = l_line_counter + 3
          }
      }
    if sfscompany:company_id NOT one of "LEBINS" then
      {
        If SFPPRINT3:PRINT_FORM    = "Y" And
           SFPPRINT3:LOB_END_CODE  = L_LOB_END_CODE And
           L_LOB_END_CODE          = "G" And
           L_DO_ONCE               = 0 Then
          {
            L_DO_ONCE = 1
            Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")
            Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
            Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
            Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Glass Coverage Part:")
            Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")
            l_line_counter = l_line_counter + 3
          }
      }
    if sfscompany:company_id NOT one of "LEBINS" then
      {
        If SFPPRINT3:PRINT_FORM    = "Y" And
           SFPPRINT3:LOB_END_CODE  = L_LOB_END_CODE And
           L_LOB_END_CODE          = "B" And
           L_DO_ONCE               = 0 Then
          {
            L_DO_ONCE = 1
            Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")
            Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
            Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
            Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Business Income Coverage Part:")
            Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")
            l_line_counter = l_line_counter + 3
          }
      }
    If SFPPRINT3:PRINT_FORM    = "Y" And
       SFPPRINT3:LOB_END_CODE  = L_LOB_END_CODE And
       L_LOB_END_CODE          = "F" And
       L_DO_ONCE               = 0 Then
      {
        L_DO_ONCE = 1

        Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")

        Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
        Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
        Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Farm Coverage Part:")

        Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")

        l_line_counter = l_line_counter + 3
      }

  End --End of procedure HEADINGS


Procedure LIABILITY
  Begin

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
    Writefile(L_FILE_NAME,"%s","Policy Term: ")
    Writefile(L_FILE_NAME,"%s",L_ARIAL)
    Writefile(L_FILE_NAME,"%s","<033>&a850h+0V")
    Writefile(L_FILE_NAME,"%s","From ")
    Writefile(L_FILE_NAME,"%s",Str(SFPNAME:EFF_DATE,"mm/dd/yyyy"))
    Writefile(L_FILE_NAME,"%s"," to ")
    Writefile(L_FILE_NAME,"%s",Str(SFPNAME:EXP_DATE,"mm/dd/yyyy"))
    Writefile(L_FILE_NAME,"%s"," 12:01 A.M. Standard Time at your mailing address shown above.")
    Writefile(L_FILE_NAME,"%s","<NL>")
    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 2

    Switch(SFPMASTER:FORM_OF_BUSINESS)
      Case 'C' : L_FOB = "Corporation"
      Case 'I' : L_FOB = "Individual"
      Case 'J' : L_FOB = "Joint Venture"
      Case 'O' : L_FOB = "Organization"
      Case 'P' : L_FOB = "Partnership"
      Case 'T' : L_FOB = SFPMASTER:FOB_DESCRIPTION
    End

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
    Writefile(L_FILE_NAME,"%s","You are a: ")
    Writefile(L_FILE_NAME,"%s",L_ARIAL)
    Writefile(L_FILE_NAME,"%s",Uppercase(L_FOB))

    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s",L_ARIAL_bold)
    Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
    Writefile(L_FILE_NAME,"%s","Your Business/Operation: ")
    Writefile(L_FILE_NAME,"%s",L_ARIAL)
    Writefile(L_FILE_NAME,"%s",Trun(CPPLIABILITY:BUSINESS_DESCRIPTION[1]))
    if CPPLIABILITY:BUSINESS_DESCRIPTION[2] <> "" then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a1461h+120V")
        Writefile(L_FILE_NAME,"%s",Trun(CPPLIABILITY:BUSINESS_DESCRIPTION[2]))
      }
    Writefile(L_FILE_NAME,"%s",L_POP)
    Writefile(L_FILE_NAME,"%s","<033>&a200h+360V")

    If CPPLIABLIMITS:NAME[1] = "" And
       CPPLIABLIMITS:NAME[2] = "" And
       CPPLIABLIMITS:NAME[3] = "" Then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a3000h+360V")
        L_LINE_COUNTER = L_LINE_COUNTER + 3
      }
    For L_LOOP = 1 to 3
      {
        If CPPLIABLIMITS:NAME[L_LOOP] <> "" Then
          {
            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
            Writefile(L_FILE_NAME,"%s",CPPLIABLIMITS:NAME[L_LOOP])
            L_LINE_COUNTER = L_LINE_COUNTER + 1
          }
      }
    For L_LOOP = 1 to 3
      {
        If CPPLIABLIMITS:ADDRESS[L_LOOP] <> "" Then
          {
            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
            Writefile(L_FILE_NAME,"%s",CPPLIABLIMITS:ADDRESS[L_LOOP])
            L_LINE_COUNTER = L_LINE_COUNTER + 1
          }
      }
    If CPPLIABLIMITS:CITY <> "" Then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
        Writefile(L_FILE_NAME,"%s",Trun(CPPLIABLIMITS:CITY))
        Writefile(L_FILE_NAME,"%s",", ")
        Writefile(L_FILE_NAME,"%s",CPPLIABLIMITS:STR_STATE)
        Writefile(L_FILE_NAME,"%s"," ")
        Writefile(L_FILE_NAME,"%s",L_CPPLIABLIMTS_ZIP)
        L_line_COUNTER = L_line_COUNTER +1
      }
    Writefile(L_FILE_NAME,"%s","<033>&a220h-120V")
    L_LINE_COUNTER = L_LINE_COUNTER + 1


    Writefile(L_FILE_NAME,"%s","IN RETURN FOR PAYMENT OF THE PREMIUM, AND SUBJECT TO ALL THE TERMS OF THIS POLICY, ")
    Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s","WE AGREE WITH YOU TO PROVIDE THE INSURANCE AS STATED IN THIS POLICY.  THERE ARE EXCLUSIONS,")
    Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
    Writefile(L_FILE_NAME,"%s","CONDITIONS AND LIMITATIONS CONTAINED IN THE POLICY FORMS AND ENDORSEMENTS.")
    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h10v0P","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 0.3

    Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
    Writefile(L_FILE_NAME,"%s","LIMITS OF INSURANCE")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
    Writefile(L_FILE_NAME,"%s","(")
    Writefile(L_FILE_NAME,"%s",trun(SCIPSCONTROL:BLANK_WORDING))
    Writefile(L_FILE_NAME,"%s"," MEANS NO COVERAGE)")
    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h2v0P","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER - 0.6

    Writefile(L_FILE_NAME,"%s","<033>*t600R")

    Writefile(L_FILE_NAME,"%s","<033>&a175h-116V")
    L_LINE_COUNTER = L_LINE_COUNTER - 1
    Writefile(L_FILE_NAME,"%s","<033>*c5G")
    Writefile(L_FILE_NAME,"%s","<033>*c2245a49b2P")

    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s","<033>&a220h+90V")
    L_LINE_COUNTER = L_LINE_COUNTER + 0.75
    Writefile(L_FILE_NAME,"%s","Each Occurrence Limit")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
    Writefile(L_FILE_NAME,"%s","$")

    If CPPLIABLIMITS:OCCURRENCE <> 0 Then
      {
        Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
        Writefile(L_FILE_NAME,"%s",Str(CPPLIABLIMITS:OCCURRENCE,"ZZZ,ZZZ,ZZZ"))
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
      }

    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h1v0P","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 0.25

    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s","<033>&a220h-30V")
    L_LINE_COUNTER = L_LINE_COUNTER - 0.25

    Writefile(L_FILE_NAME,"%s","General Aggregate Limit (Other Than Products-Completed Operations)")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    If CPPLIABLIMITS:GENERAL_AGGREGATE <> 0 Then
      {
        Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
        Writefile(L_FILE_NAME,"%s",Str(CPPLIABLIMITS:GENERAL_AGGREGATE,"ZZZ,ZZZ,ZZZ"))
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
      }

    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h1v0P","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 0.75

    Writefile(L_FILE_NAME,"%s","<033>&a175h-116V")
    L_LINE_COUNTER = L_LINE_COUNTER - 1
    Writefile(L_FILE_NAME,"%s","<033>*c5G")
    Writefile(L_FILE_NAME,"%s","<033>*c2245a49b2P")

    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s","<033>&a220h+90V")
    L_LINE_COUNTER = L_LINE_COUNTER + 0.75
    Writefile(L_FILE_NAME,"%s","Products-Completed Operations Aggregate Limit")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    If CPPLIABLIMITS:PRODUCTS <> 0 Then
      {
        Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
        Writefile(L_FILE_NAME,"%s",Str(CPPLIABLIMITS:PRODUCTS,"ZZZ,ZZZ,ZZZ"))
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
      }

    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h1v0P","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 0.25

    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s","<033>&a220h-30V")
    L_LINE_COUNTER = L_LINE_COUNTER - 0.25
    Writefile(L_FILE_NAME,"%s","Personal and Advertising Injury Limit")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    If CPPLIABLIMITS:ADVERTISING_PERSONAL_INJURY <> 0 Then
      {
        Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
        Writefile(L_FILE_NAME,"%s",Str(CPPLIABLIMITS:ADVERTISING_PERSONAL_INJURY,"ZZZ,ZZZ,ZZZ"))
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
      }

    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h1v0P","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER - 0.25

    Writefile(L_FILE_NAME,"%s","<033>&a175h-116V")
    L_LINE_COUNTER = L_LINE_COUNTER - 1
    Writefile(L_FILE_NAME,"%s","<033>*c5G")
    Writefile(L_FILE_NAME,"%s","<033>*c2245a49b2P")

    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s","<033>&a220h+90V")
    L_LINE_COUNTER = L_LINE_COUNTER + 0.75
    Writefile(L_FILE_NAME,"%s","Damage To Premises Rented To You Limit")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    If CPPLIABLIMITS:FIRE_LEGAL <> 0 Then
      {
        Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
        Writefile(L_FILE_NAME,"%s",Str(CPPLIABLIMITS:FIRE_LEGAL,"ZZZ,ZZZ,ZZZ"))
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
      }
    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h1v0P","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER - 0.25

    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s","<033>&a220h-30V")
    L_LINE_COUNTER = L_LINE_COUNTER - 0.75
    Writefile(L_FILE_NAME,"%s","Medical Expense Limit")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    If CPPLIABLIMITS:MEDICAL_PAYMENTS <> 0 Then
      {
        Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
        Writefile(L_FILE_NAME,"%s",Str(CPPLIABLIMITS:MEDICAL_PAYMENTS,"ZZZ,ZZZ,ZZZ"))
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
      }
    Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s","Any One Person")
    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h10v0P","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER - 0.75

    Do LOC_OF_PREM_YOU_OWN_RENT

    Writefile(L_FILE_NAME,"%s%s","<033>&a140h+40V<033>*c5455h10v0P","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 0.35

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
    Writefile(L_FILE_NAME,"%s",Uppercase("All known exposures at inception of the policy term are listed below:"))
    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h5v0P","<NL>")
    If sfscompany:company_id one of "LEBINS" then
      {
        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
        Writefile(L_FILE_NAME,"%s","<033>&a400h+0V")
        Writefile(L_FILE_NAME,"%s","See Supplemental Schedule")
      }

    Else
      {
        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
        Writefile(L_FILE_NAME,"%s","<033>&a400h+0V")
        L_LINE_COUNTER = L_LINE_COUNTER  - 0.67

        If L_SUPPLEMENTAL_SWITCH > 13 or
           cppliablimits:form = 2 Then
          {
            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
            Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
            Writefile(L_FILE_NAME,"%s","See Attached Premium Basis Supplemental for Details")
            Writefile(L_FILE_NAME,"%s","<033>&a200h+80V")
            L_LINE_COUNTER = L_LINE_COUNTER + 2.67
          }
        Else
          {
            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
            Writefile(L_FILE_NAME,"%s","<033>&a2800h+0V")
            Writefile(L_FILE_NAME,"%s","Premium Basis")
            Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
            Writefile(L_FILE_NAME,"%s","Advance Premium")

            Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
            L_LINE_COUNTER = L_LINE_COUNTER + 0.84
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","Classification")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            Writefile(L_FILE_NAME,"%s","<033>&a2000h+0V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","Code")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","Prem Ops")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            Writefile(L_FILE_NAME,"%s","<033>&a3400h+0V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","PR/CO")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            Writefile(L_FILE_NAME,"%s","<033>&a4585h+0V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","Prem Ops")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
            Writefile(L_FILE_NAME,"%s","<033>&a5240h+0V")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
            Writefile(L_FILE_NAME,"%s","PR/CO")
            Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)

            L_LOOP          = 0
            L_SUBTOTAL_PREM = 0
            L_SUBTOTAL_PRCO = 0

            If L_SUPPLEMENTAL_SWITCH > 13 or
               cppliablimits:form = 2 Then
              {
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
                Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
                Writefile(L_FILE_NAME,"%s","See Attached Premium Basis Supplemental for Details")
                Writefile(L_FILE_NAME,"%s","<033>&a200h+80V")
                L_LINE_COUNTER = L_LINE_COUNTER + 2.67
              }


            l_endorsement_total = 0
            Access CPPLIABILITY,
               Set CPPLIABILITY:POLICY_NO    = SFPPRINT1:POLICY_NO,
                   CPPLIABILITY:POL_YEAR     = SFPPRINT1:POL_YEAR,
                   CPPLIABILITY:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, generic

            l_first = "Y"

            While cppliability:POLICY_NO    = SFPPRINT1:POLICY_NO and
                  cppliability:POL_YEAR     = SFPPRINT1:POL_YEAR and
                  cppliability:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
              {
                If l_line_counter >= L_MAX_LINES - 5 Then
                  {
                    Do INSERT_NEWPAGE
                  }

                Access CPPGENERAL ,
                   Set CPPGENERAL:POLICY_NO    = SFPLOCATION:POLICY_NO,
                       CPPGENERAL:POL_YEAR     = SFPLOCATION:POL_YEAR,
                       CPPGENERAL:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
                       CPPGENERAL:PREM_NO      = SFPLOCATION:PREM_NO,
                       CPPGENERAL:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

                l_line_of_business = sfsline:rating_line_of_business
                Access CPSCLASS,
                   Set CPSCLASS:COMPANY_ID       = L_COMPANY_ID,
                       CPSCLASS:STATE            = L_STATE2,
                       CPSCLASS:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                       CPSCLASS:GROUP_NO         = CPPLIABILITY:GROUP_NO,
                       CPSCLASS:SUB_GROUP        = CPPLIABILITY:SUB_GROUP ,
                       CPSCLASS:CLASS_CODE       = CPPLIABILITY:CLASS_CODE,
                       cpsclass:sub_code         = cppliability:sub_code, Generic

                If (Val(SFPLOCATION:STR_ZIPCODE[6,9]) = 0) Then
                  {
                    l_sfplocation_zip = SFPLOCATION:STR_ZIPCODE[1,5]
                  }
                Else
                  {
                    l_sfplocation_zip = SFPLOCATION:STR_ZIPCODE[1,5] + "-" +
                                        SFPLOCATION:STR_ZIPCODE[6,9]
                  }

                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
                Writefile(L_FILE_NAME,"%s","Prem No. ")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",Str(cppliability:PREM_NO,"ZZZZ"))
                Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s","Bldg No. ")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",Str(cppliability:BUILD_NO,"ZZZZ"))
                L_LINE_COUNTER = L_LINE_COUNTER + 1

                Writefile(L_FILE_NAME,"%s","<033>&a2000h+0V")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",str(CPPLIABILITY:CLASS_CODE,"99999"))
                Writefile(L_FILE_NAME,"%s",L_ARIAL_9)

                l_exposure_base = CPPLIABILITY:EXPOSURE_base[1]

                Access CPSLIABEXPBASE,
                   Set CPSLIABEXPBASE:COMPANY_ID       = L_COMPANY_ID,
                       CPSLIABEXPBASE:STATE            = L_STATE2,
                       CPSLIABEXPBASE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                       CPSLIABEXPBASE:EXPOSURE_BASE    = l_exposure_base, Generic

                Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
                Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
                Writefile(L_FILE_NAME,"%s",trun(l_exposure_base))
                Writefile(L_FILE_NAME,"%s",") ")
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:exposure[1],"ZZ,ZZZ,ZZZ"))

                l_exposure_base = CPPLIABILITY:EXPOSURE_base[2]

                Access CPSLIABEXPBASE,
                   Set CPSLIABEXPBASE:COMPANY_ID       = L_COMPANY_ID,
                       CPSLIABEXPBASE:STATE            = L_STATE2,
                       CPSLIABEXPBASE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                       CPSLIABEXPBASE:EXPOSURE_BASE    = l_exposure_base, Generic

                Writefile(L_FILE_NAME,"%s","<033>&a3400h+0V")
                Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
                Writefile(L_FILE_NAME,"%s",trun(l_exposure_base))
                if cppliability:exposure[2] <> 0 then
                  begin
                    Writefile(L_FILE_NAME,"%s",") ")
                  end
                else
                if cppliablimits:products = 0 then
                  begin
                    writefile(l_file_name,"%s","EXCL")
                  end
                else
                if cppliability:products_limit_table = "-" then
                  begin
                    writefile(l_file_name,"%s","INCL")
                  end
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                If CPPLIABILITY:exposure[2] <> 0 Then
                  {
                    Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:exposure[2],"ZZ,ZZZ,ZZZ"))
                  }
                Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                Writefile(L_FILE_NAME,"%s","$")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                if sfpname:eff_date >= scipscontrol:show_account_mod_date then
                  begin
                    Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[1] +
                                      cppliability:minimum_premium_adjustment[1] +
                                      cppliability:fire_legal_premium +
                                      cppliability:total_irpm[1],"ZZZ,ZZZ"))
                  end
                else
                  begin
                    Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[1] +
                                 cppliability:minimum_premium_adjustment[1] +
                                 cppliability:fire_legal_premium,"ZZZ,ZZZ"))
                  end

                Writefile(L_FILE_NAME,"%s","<033>&a5115h+0V")
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                if cppliability:prem[2] <> 0 then
                  begin
                    Writefile(L_FILE_NAME,"%s","$")
                  end
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                if sfpname:eff_date >= scipscontrol:show_account_mod_date and
                   cppliability:prem[2] <> 0 then
                  begin
                    Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[2] +
                                         cppliability:minimum_premium_adjustment[2] +
                                         cppliability:total_irpm[2],"ZZZ,ZZZ"))
                    end
                else
                if cppliability:prem[2] <> 0 then
                  begin
                    Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[2] +
                            cppliability:minimum_premium_adjustment[2],"ZZZ,ZZZ"))
                  end
                else
                if cppliablimits:products = 0 then
                  begin
                    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
                    writefile(l_file_name,"%s","EXCL")
                  end
                else
                if cppliability:products_limit_table = "-" then
                  begin
                    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
                    writefile(l_file_name,"%s","INCL")
                  end

                Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
                L_LINE_COUNTER = L_LINE_COUNTER + 1

                If CPPLIABILITY:CLASS_DESCRIPTION <> "" Then
                  {
                    Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
                    Writefile(L_FILE_NAME,"%s",CPPLIABILITY:CLASS_DESCRIPTION)
                  }
                Else
                  {
                    L_FONT             = L_ARIAL_9
                    L_V_POSITION       = "+120"
                    L_H_POSITION       = "200"
                    L_CHARACTER_STRING = CPSCLASS:DESCRIPTION
                    L_MAX_CHAR         = 80
                    Include "line_spacing.inc"
                  }
                if sfpname:eff_date >= scipscontrol:show_account_mod_date then
                  begin
                    L_SUBTOTAL_PREM = L_SUBTOTAL_PREM +
                                      CPPLIABILITY:PREM[1] +
                                      cppliability:minimum_premium_adjustment[1] +
                                      cppliability:fire_legal_premium +
                                      cppliability:total_irpm[1]
                    L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO +
                                      CPPLIABILITY:PREM[2] +
                                      cppliability:minimum_premium_adjustment[2] +
                                      cppliability:total_irpm[2]
                  end
                else
                  begin
                    L_SUBTOTAL_PREM = L_SUBTOTAL_PREM + CPPLIABILITY:PREM[1] +
                                      cppliability:minimum_premium_adjustment[1] +
                                      cppliability:fire_legal_premium
                    L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO + CPPLIABILITY:PREM[2] +
                                      cppliability:minimum_premium_adjustment[2]
                  end

                Writefile(L_FILE_NAME,"%s","<033>&a5100h-20V")
                if sfpname:eff_date >= scipscontrol:show_account_mod_date then
                  begin
                    l_endorsement_total = l_endorsement_total +
                                          cppliability:total_endorsEments +
                                          cppliability:total_irpm[3] +
                                          cppliability:TOTAL_MISC +
                                          cppliability:total_irpm[4]
                  end
                else
                  begin
                    l_endorsement_total = l_endorsement_total +
                                          cppliability:total_endorsEments +
                                          cppliability:TOTAL_MISC
                 end
              Next cppliability
            }--end while
         }
          Do Insert_newpage
      }--END Else

  End -- End of Procedure LIABILITY

Procedure LOC_OF_PREM_YOU_OWN_RENT
Begin
                --****LOCATION OF PREMISES YOU OWN, RENT, OR OCCUPY*****

  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
  Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
  Writefile(L_FILE_NAME,"%s",Uppercase("Location of Premises you own, rent or occupy"))
  Writefile(L_FILE_NAME,"%s","<NL>")
  L_LINE_COUNTER = L_LINE_COUNTER + 1

  Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h5v0P","<NL>")
  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
  Writefile(L_FILE_NAME,"%s","<033>&a400h-120V")
  L_LINE_COUNTER = L_LINE_COUNTER  - 0.67

  --Check the location and cppliabiity file and count the number of lines it will take to print
  --all the lines that is needed for each location.


  l_loop = 0
  While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
        SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
        SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
    {
      if (trun(sfplocation:address) <> "") then
        {
          l_loop = l_loop + 1
        }
      for l_loop1 = 1 to 3
        {
          if trun(sfplocation:address1[l_loop]) <> "" then
            {
              l_loop = l_loop + 1
            }
        }
      l_loop = l_loop + 2  --this is for the Prem No. 1 Bldg No. 1 for each location and last line of city state zip
      l_endorsement_total = 0
      Access CPPLIABILITY,
         Set CPPLIABILITY:POLICY_NO    = SFPPRINT1:POLICY_NO,
             CPPLIABILITY:POL_YEAR     = SFPPRINT1:POL_YEAR,
             CPPLIABILITY:END_SEQUENCE = SFPPRINT1:END_SEQUENCE,
             CPPLIABILITY:PREM_NO      = SFPLOCATION:PREM_NO,
             CPPLIABILITY:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

      while CPPLIABILITY:POLICY_NO    = SFPPRINT1:POLICY_NO and
            CPPLIABILITY:POL_YEAR     = SFPPRINT1:POL_YEAR and
            CPPLIABILITY:END_SEQUENCE = SFPPRINT1:END_SEQUENCE and
            CPPLIABILITY:PREM_NO      = SFPLOCATION:PREM_NO and
            CPPLIABILITY:BUILD_NO     = SFPLOCATION:BUILD_NO
        {
          Access CPSCLASS,
             Set CPSCLASS:COMPANY_ID       = L_COMPANY_ID,
                 CPSCLASS:STATE            = L_STATE2,
                 CPSCLASS:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                 CPSCLASS:GROUP_NO         = CPPLIABILITY:GROUP_NO,
                 CPSCLASS:SUB_GROUP        = CPPLIABILITY:SUB_GROUP ,
                 CPSCLASS:CLASS_CODE       = CPPLIABILITY:CLASS_CODE,
                 cpsclass:sub_code         = cppliability:sub_code, Generic

          l_loop = l_loop + 2  --for the prem bldg no. code prem_ops date and description
          If len(trun(CPSCLASS:DESCRIPTION)) >= 80 Then  --if it goes more then one line
            {
              L_loop = L_loop + 1
            }
          l_endorsement_total = l_endorsement_total + cppliability:total_endorsEments + cppliability:TOTAL_MISC
          next cppliability
        }
      next sfplocation
    }

  L_SUPPLEMENTAL_SWITCH = l_loop

  If L_supplemental_switch > 13 or
     cppliablimits:form = 2 Then
    {
      Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
      Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
      Writefile(L_FILE_NAME,"%s","See Attached Location of Premises Supplemental for Details")
      Writefile(L_FILE_NAME,"%s","<NL>")
      L_LINE_COUNTER = L_LINE_COUNTER + 1
    }
  Else
    {    --location information

      Access SFPLOCATION,
         Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
             SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
             SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, generic

      While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
            SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
            SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
       {
         Access CPPLIABILITY,
            Set CPPLIABILITY:POLICY_NO    = SFplocation:POLICY_NO,
                CPPLIABILITY:POL_YEAR     = SFplocation:POL_YEAR,
                CPPLIABILITY:END_SEQUENCE = SFplocation:END_SEQUENCE,
                CPPLIABILITY:PREM_NO      = SFPLOCATION:PREM_NO,
                CPPLIABILITY:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic


           if CPPLIABILITY:POLICY_NO    = SFplocation:POLICY_NO and
              CPPLIABILITY:POL_YEAR     = SFplocation:POL_YEAR and
              CPPLIABILITY:END_SEQUENCE = SFplocation:END_SEQUENCE and
              CPPLIABILITY:PREM_NO      = SFPLOCATION:PREM_NO and
              CPPLIABILITY:BUILD_NO     = SFPLOCATION:BUILD_NO then
             {
               L_sfplocation_ZIP = If (Val(sfplocation:STR_ZIPCODE[6,9]) = 0) Then
                                       sfplocation:STR_ZIPCODE[1,5]
                                   Else
                                       sfplocation:STR_ZIPCODE[1,5] + "-" +
                                       sfplocation:STR_ZIPCODE[6,9]

               Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
               Writefile(L_FILE_NAME,"%s","<033>&a400h+120V")
               L_LINE_COUNTER = L_LINE_COUNTER + 1
               Writefile(L_FILE_NAME,"%s","Prem No. ")
               Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
               Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:PREM_NO,"ZZZZ"))
               Writefile(L_FILE_NAME,"%s","<033>&a1100h+0V")
               Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
               Writefile(L_FILE_NAME,"%s","Bldg No. ")
               Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
               Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:BUILD_NO,"ZZZZ"))
               Writefile(L_FILE_NAME,"%s",L_ARIAL_bold)

               L_LINE_COUNTER = L_LINE_COUNTER + 1

               Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
               Writefile(L_FILE_NAME,"%s","<033>&a400h+100V")
               L_LINE_COUNTER = L_LINE_COUNTER + 0.84
               Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:ADDRESS))
               Writefile(L_FILE_NAME,"%s","  ")
               Writefile(L_FILE_NAME,"%s","<033>&a400h+120V")
               for l_loop1 = 1 to 3
                 {
                   if trun(sfplocation:address1[l_loop1]) <> "" then
                     {
                       Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:address1[l_loop1]))
                       --Writefile(L_FILE_NAME,"%s","  ")
                       Writefile(L_FILE_NAME,"%s","<033>&a400h+120V")
                     }
                 }
               Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:CITY))
               Writefile(L_FILE_NAME,"%s",", ")
               Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:STR_STATE))
               Writefile(L_FILE_NAME,"%s","  ")
               Writefile(L_FILE_NAME,"%s",L_SFPLOCATION_ZIP)
               L_LINE_COUNTER = L_LINE_COUNTER + 1
            }
          Next SFPLOCATION
        }
    }
  End -- End of Procedure LOC_OF_PREM_YOU_OWN_RENT

  Procedure FORMS
  Begin          --*****Mandatory and Optional Endorsements*****

    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s","<033>&a220h-60V")
    Writefile(L_FILE_NAME,"%s","These Declarations together with the Forms and Endorsements, if any, issued to form a part thereof,")
    Writefile(L_FILE_NAME,"%s","<033>&a220h+100V")
    Writefile(L_FILE_NAME,"%s","completes the above numbered policy.")
    Writefile(L_FILE_NAME,"%s","<NL>")
    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 2

    Access sfsend,
       Set sfsend:COMPANY_ID          = L_COMPANY_ID,
           sfsend:STATE               = L_STATE2,
           sfsend:LINE_OF_BUSINESS    = L_LINE_OF_BUSINESS, generic

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a350h+0V")
    Writefile(L_FILE_NAME,"%s","Form Edition")
    Writefile(L_FILE_NAME,"%s","<033>&a1750h+0V")
    Writefile(L_FILE_NAME,"%s","Description")
    If sfscompany:company_id one of "LEBINS" then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a4830h+0V")
        Writefile(L_FILE_NAME,"%s","Premium")
      }
    Writefile(L_FILE_NAME,"%s","<NL>")
    l_line_counter = l_line_counter +1

    Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")

    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
    Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to ")
    If sfscompany:company_id one of "LEBINS" then
      {
        Writefile(L_FILE_NAME,"%s","all Coverage Parts:")
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s","the Common Coverage Part:")
      }
    Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")
    l_line_counter = l_line_counter + 3

    l_line_of_business = 2

    Access SFSMSOTERROR,
       Set SFSMSOTERROR:COMPANY_ID       = L_COMPANY_ID,
           SFSMSOTERROR:STATE            = L_STATE2,
           SFSMSOTERROR:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS, Generic

     While SFSMSOTERROR:COMPANY_ID       = L_COMPANY_ID And
           SFSMSOTERROR:STATE            = L_STATE2 And
           SFSMSOTERROR:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS
       begin
         if SFSMSOTERROR:EFF_DATE <= SFPNAME:EFF_DATE then
           {
             L_TERROR_FORM = SFSMSOTERROR:TERRORISM_FORM_TO_ADD
           }
         Next SFSMSOTERROR
       end
    l_line_of_business = 8
  /*  Access sfpend,
       Set sfpend:POLICY_NO    = SFPPRINT1:POLICY_NO,
           sfpend:POL_YEAR     = SFPPRINT1:POL_YEAR,
           sfpend:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

    While SFPEND:POLICY_NO    = SFPPRINT1:POLICY_NO And
          SFPEND:POL_YEAR     = SFPPRINT1:POL_YEAR And
          SFPEND:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
      {
        if sfpend:LOB_END_CODE one of "L","R" and
           sfpend:prem_no  = 0 and
           sfpend:build_no = 0 then
          {
            Writefile(L_FILE_NAME,"%s",L_ARIAL)
            Writefile(L_FILE_NAME,"%s","<033>&a350h+0V")
            Writefile(L_FILE_NAME,"%s",sfpend:FORM_EDITION)
            Writefile(L_FILE_NAME,"%s","<033>&a1750h+0V")
            Writefile(L_FILE_NAME,"%s",sfpend:DESCRIPTION)
            Writefile(L_FILE_NAME,"%s","<033>&a4850h+0V")
            if sfpend:terrorism_form = 1 then
              {
                Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
                Writefile(L_FILE_NAME,"%s","$")
                Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                Writefile(l_file_name,"%s",Str(sfpend:premium,"ZZZ,ZZZ,ZZZ"))
              }
            Writefile(L_FILE_NAME,"%s","<033>&a4850h+120V")
          }
        next sfpend
      }
  */
    Access sfpprint2,
       Set sfpprint2:POLICY_NO    = SFPPRINT1:POLICY_NO,
           sfpprint2:POL_YEAR     = SFPPRINT1:POL_YEAR,
           sfpprint2:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

      While sfpprint2:POLICY_NO    = SFPPRINT1:POLICY_NO And
            sfpprint2:POL_YEAR     = SFPPRINT1:POL_YEAR And
            sfpprint2:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
        {
          If l_line_counter >= L_MAX_LINES - 2 Then
            {
              Do INSERT_NEWPAGE
            }
          If SFPPRINT2:LOB_END_CODE one of "L","A" Then
            {
              Writefile(L_FILE_NAME,"%s",L_ARIAL)
              Writefile(L_FILE_NAME,"%s","<033>&a350h+0V")
              Writefile(L_FILE_NAME,"%s",sfpprint2:FORM_EDITION)
              Writefile(L_FILE_NAME,"%s","<033>&a1750h+0V")
              Writefile(L_FILE_NAME,"%s",sfpprint2:DESCRIPTION)

              If SFPPRINT2:CODE = L_TERROR_FORM Then
                {

                  Writefile(L_FILE_NAME,"%s","<033>&a4850h+0V")
                  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
                  Writefile(L_FILE_NAME,"%s","$")
                  Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                  Writefile(L_FILE_NAME,"%s",Str(l_terrorism_premium,"ZZZ,ZZZ,ZZZ"))
                }

              Writefile(L_FILE_NAME,"%s","<NL>")
              l_line_counter = l_line_counter +1
            }
          Next sfpprint2
        }--End outside While SFPPRINT2

     Access SFPPRINT3,
        Set SFPPRINT3:POLICY_NO    = SFPPRINT1:POLICY_NO,
            SFPPRINT3:POL_YEAR     = SFPPRINT1:POL_YEAR,
            SFPPRINT3:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

     L_DO_ONCE = 0

      While SFPPRINT3:POLICY_NO    = SFPPRINT1:POLICY_NO And
            SFPPRINT3:POL_YEAR     = SFPPRINT1:POL_YEAR And
            SFPPRINT3:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
         {
           If l_line_counter >= L_MAX_LINES - 2 Then
             {
               Do INSERT_NEWPAGE
             }
           Do HEADINGS
           If SFPPRINT3:PRINT_FORM = "Y" And
              SFPPRINT3:LOB_END_CODE  one of "L","R" Then
             {
               Writefile(L_FILE_NAME,"%s",L_ARIAL)
               Writefile(L_FILE_NAME,"%s","<033>&a350h+0V")
               Writefile(L_FILE_NAME,"%s",SFPPRINT3:FORM_EDITION)
               Writefile(L_FILE_NAME,"%s","<033>&a1750h+0V")
               Writefile(L_FILE_NAME,"%s",Trun(SFPPRINT3:DESCRIPTION))

               If SFPPRINT3:CODE = L_TERROR_FORM Then
                 {
                   Access sfpend_alias,
                      Set sfpend_alias:POLICY_NO    = sfpprint3:POLICY_NO,
                          sfpend_alias:POL_YEAR     = sfpprint3:POL_YEAR,
                          sfpend_alias:END_SEQUENCE = sfpprint3:END_SEQUENCE,generic

                    While sfpend_alias:POLICY_NO    = sfpprint3:POLICY_NO and
                          sfpend_alias:POL_YEAR     = sfpprint3:POL_YEAR and
                          sfpend_alias:END_SEQUENCE = sfpprint3:END_SEQUENCE
                      {
                        If sfpend_alias:code one of l_terror_form then
                          {
                            Writefile(L_FILE_NAME,"%s","<033>&a4850h+0V")
                            Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
                            Writefile(L_FILE_NAME,"%s","$")
                            Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                            Writefile(L_FILE_NAME,"%s",Str(sfpend_alias:premium,"ZZZ,ZZZ,ZZZ"))
                            --Writefile(L_FILE_NAME,"%s",Str(SFPPRINT3:total_premium,"ZZZ,ZZZ,ZZZ"))
                          }
                        next sfpend_alias
                      }
                 }
               Else
                 if sfpprint3:total_premium <> 0 then
                   {
                     Writefile(L_FILE_NAME,"%s","<033>&a4850h+0V")
                     Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
                     Writefile(L_FILE_NAME,"%s","$")
                     Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
                     Writefile(L_FILE_NAME,"%s",Str(sfpprint3:total_premium,"ZZZ,ZZZ,ZZZ"))
                   }

                 Writefile(L_FILE_NAME,"%s","<NL>")
                 l_line_counter = l_line_counter + 1
             }

           Next SFPPRINT3
         }--End oputside While SFPPRINT3
       Writefile(L_FILE_NAME,"%s",L_ARIAL)
       Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
       Writefile(L_FILE_NAME,"%s","* Mandatory Forms")
       Writefile(L_FILE_NAME,"%s","<NL>")
       l_line_counter = l_line_counter +1

       Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h-40V<033>*c5455h10v0P","<NL>","<NL>")
       l_line_counter = l_line_counter +2

       If L_LINE_COUNTER >= L_MAX_LINES - 6 Then
         {
           Do INSERT_NEWPAGE
         }
  End --END OF POCEDURE FORMS

Procedure liability_rate_supplemental
  Begin

    Writefile(L_FILE_NAME,"%s","<FF>")
    L_LINE_COUNTER = 0
    L_PAGE_NUMBER = L_PAGE_NUMBER + 1
    If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
      {
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
        Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
        Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
        Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
      }
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
    Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
    Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
    Writefile(L_FILE_NAME,"%s","Page ")
    Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a200h120V")
    L_LINE_COUNTER = L_LINE_COUNTER + 1
    Writefile(L_FILE_NAME,"%s",uppercase("commercial general liability coverage part supplemental schedule"))
    Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
    Writefile(L_FILE_NAME,"%s","Policy No. ")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
    Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
    Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

    Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
    L_LINE_COUNTER = L_LINE_COUNTER + 2.33

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
    Writefile(L_FILE_NAME,"%s",uppercase("* a minimum premium applies"))

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a1900h+200V")
    Writefile(L_FILE_NAME,"%s","Premium Basis")
    Writefile(L_FILE_NAME,"%s","<033>&a3700h+0V")
    Writefile(L_FILE_NAME,"%s","Rate")
    Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
    Writefile(L_FILE_NAME,"%s","Advance Premium")
    L_LINE_COUNTER = L_LINE_COUNTER + 2

    Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
    L_LINE_COUNTER = L_LINE_COUNTER + 0.83
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","Classification")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a1100h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","Code")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a1600h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","Prem Ops")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","PR/CO")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a3350h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","Prem Ops")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a4000h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","PR/CO")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)

    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a4585h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","Prem Ops")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
    Writefile(L_FILE_NAME,"%s","<033>&a5240h+0V")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
    Writefile(L_FILE_NAME,"%s","PR/CO")
    Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)

    L_SUBTOTAL_PREM = 0
    L_SUBTOTAL_PRCO = 0
    l_endorsement_total = 0

    Access CPPLIABILITY,
       Set CPPLIABILITY:POLICY_NO    = SFPPRINT1:POLICY_NO,
           CPPLIABILITY:POL_YEAR     = SFPPRINT1:POL_YEAR,
           CPPLIABILITY:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, generic

    l_first = "Y"

    While cppliability:POLICY_NO    = SFPPRINT1:POLICY_NO and
          cppliability:POL_YEAR     = SFPPRINT1:POL_YEAR and
          cppliability:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
       {
         If l_line_counter >= L_MAX_LINES - 5 Then
           {
             If L_PAGE_NUMBER = 1 Then
               {
                 Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
                 Writefile(L_FILE_NAME,"%s","<033>&a5000h7250V")
                 Writefile(L_FILE_NAME,"%s","Page ")
                 Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)
               }
             Writefile(L_FILE_NAME,"%s","<FF>")
             L_LINE_COUNTER = 0
             If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
               {
                 Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
                 Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
                 Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
                 Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
               }
             L_PAGE_NUMBER = L_PAGE_NUMBER + 1

             Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
             Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
             Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
             Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
             Writefile(L_FILE_NAME,"%s","Page ")
             Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

             Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
             Writefile(L_FILE_NAME,"%s","<033>&a200h120V")
             L_LINE_COUNTER = L_LINE_COUNTER + 1

             Writefile(L_FILE_NAME,"%s","PREMIUM BASIS SUPPLEMENTAL")
             Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
             Writefile(L_FILE_NAME,"%s","Policy No. ")
             Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
             Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
             Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

             Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
             L_LINE_COUNTER = L_LINE_COUNTER + 2.33

             Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
             Writefile(L_FILE_NAME,"%s","<033>&a2800h+0V")
             Writefile(L_FILE_NAME,"%s","Premium Basis")
             Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
             Writefile(L_FILE_NAME,"%s","Advance Premium")

             Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
             L_LINE_COUNTER = L_LINE_COUNTER + 0.83
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
             Writefile(L_FILE_NAME,"%s","Classification")
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
             Writefile(L_FILE_NAME,"%s","<033>&a1700h+0V")
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
             Writefile(L_FILE_NAME,"%s","Code")
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
             Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
             Writefile(L_FILE_NAME,"%s","Prem Ops")
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
             Writefile(L_FILE_NAME,"%s","<033>&a3400h+0V")
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
             Writefile(L_FILE_NAME,"%s","PR/CO")
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
             Writefile(L_FILE_NAME,"%s","<033>&a4585h+0V")
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
             Writefile(L_FILE_NAME,"%s","Prem Ops")
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
             Writefile(L_FILE_NAME,"%s","<033>&a5240h+0V")
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
             Writefile(L_FILE_NAME,"%s","PR/CO")
             Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
           }--End If l_line_counter >= L_MAX_LINES - 5

         Access CPPGENERAL ,
            Set CPPGENERAL:POLICY_NO    = SFPLOCATION:POLICY_NO,
                CPPGENERAL:POL_YEAR     = SFPLOCATION:POL_YEAR,
                CPPGENERAL:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
                CPPGENERAL:PREM_NO      = SFPLOCATION:PREM_NO,
                CPPGENERAL:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

         l_line_of_business = sfsline:rating_line_of_business
         Access CPSCLASS,
            Set CPSCLASS:COMPANY_ID       = L_COMPANY_ID,
                CPSCLASS:STATE            = L_STATE2,
                CPSCLASS:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                CPSCLASS:GROUP_NO         = CPPLIABILITY:GROUP_NO,
                CPSCLASS:SUB_GROUP        = CPPLIABILITY:SUB_GROUP ,
                CPSCLASS:CLASS_CODE       = CPPLIABILITY:CLASS_CODE,
                cpsclass:sub_code         = cppliability:sub_code, Generic

         If (Val(SFPLOCATION:STR_ZIPCODE[6,9]) = 0) Then
           {
             l_sfplocation_zip = SFPLOCATION:STR_ZIPCODE[1,5]
           }
         Else
           {
             l_sfplocation_zip = SFPLOCATION:STR_ZIPCODE[1,5] + "-" +
                                 SFPLOCATION:STR_ZIPCODE[6,9]
           }

         Writefile(L_FILE_NAME,"%s",L_PUSH)
         Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
         Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
         Writefile(L_FILE_NAME,"%s","Prem No. ")
         Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
         Writefile(L_FILE_NAME,"%s",Str(cppliability:PREM_NO,"ZZZZ"))
         Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
         Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
         Writefile(L_FILE_NAME,"%s","Bldg No.  ")
         Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
         Writefile(L_FILE_NAME,"%s",Str(cppliability:BUILD_NO,"ZZZZ"))
         L_LINE_COUNTER = L_LINE_COUNTER + 1

         Writefile(L_FILE_NAME,"%s",L_POP)
         Writefile(L_FILE_NAME,"%s","<033>&a1100h+120V")
         Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
         Writefile(L_FILE_NAME,"%s",str(CPPLIABILITY:CLASS_CODE,"99999"))
         Writefile(L_FILE_NAME,"%s",L_ARIAL_9)

         l_exposure_base = CPPLIABILITY:EXPOSURE_base[1]

         Access CPSLIABEXPBASE,
            Set CPSLIABEXPBASE:COMPANY_ID       = L_COMPANY_ID,
                CPSLIABEXPBASE:STATE            = L_STATE2,
                CPSLIABEXPBASE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                CPSLIABEXPBASE:EXPOSURE_BASE    = l_exposure_base, Generic

         Writefile(L_FILE_NAME,"%s","<033>&a1600h+0V")
         Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
         Writefile(L_FILE_NAME,"%s",trun(l_exposure_base))
         Writefile(L_FILE_NAME,"%s",") ")
         Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
         Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
         Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:exposure[1],"ZZ,ZZZ,ZZZ"))

         l_exposure_base = CPPLIABILITY:EXPOSURE_base[2]

         Access CPSLIABEXPBASE,
            Set CPSLIABEXPBASE:COMPANY_ID       = L_COMPANY_ID,
                CPSLIABEXPBASE:STATE            = L_STATE2,
                CPSLIABEXPBASE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
                CPSLIABEXPBASE:EXPOSURE_BASE    = l_exposure_base, Generic

         Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
         Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
         Writefile(L_FILE_NAME,"%s",trun(l_exposure_base))
         if cppliability:exposure[2] <> 0 then
           begin
             Writefile(L_FILE_NAME,"%s",") ")
           end
         else
           if cppliablimits:products = 0 then
             begin
                writefile(l_file_name,"%s","EXCL")
              end
           else
             if cppliability:products_limit_table = "-" then
               begin
                 writefile(l_file_name,"%s","INCL")
               end
         Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
         Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
         If CPPLIABILITY:exposure[2] <> 0 Then
           {
             Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:exposure[2],"ZZ,ZZZ,ZZZ"))
           }
         Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
         Writefile(L_FILE_NAME,"%s","<033>&a3350h+0V")
         Writefile(L_FILE_NAME,"%n",cppliability:adjusted_rate[1])
         Writefile(L_FILE_NAME,"%s","<033>&a4000h+0V")
         Writefile(L_FILE_NAME,"%n",cppliability:adjusted_rate[2])

         Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
         Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
         Writefile(L_FILE_NAME,"%s","$")
         Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
         if l_first = "Y" and
            cppliability:prem[1] > sfpmaster:other_totals[17] then
             begin
             if sfpname:eff_date >= scipscontrol:show_account_mod_date then
                 begin
                 Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[1] +
                                 cppliability:minimum_premium_adjustment[1] +
                                 (sfpmaster:other_totals[17] * -1) +
                                 cppliability:fire_legal_premium +
                                 cppliability:total_irpm[1],"ZZZ,ZZZ"))
                 If cppliability:minimum_premium_adjustment[1] <> 0 then
                     {
                     Writefile(L_FILE_NAME,"%s","*")
                     }
                 end
             else
                 begin
                 Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[1] +
                         cppliability:minimum_premium_adjustment[1] +
                         (sfpmaster:other_totals[17] * -1) +
                         cppliability:fire_legal_premium,"ZZZ,ZZZ"))
                 If cppliability:minimum_premium_adjustment[1] <> 0 then
                     {
                     Writefile(L_FILE_NAME,"%s","*")
                     }
                 end
             end
         else
             begin
             if sfpname:eff_date >= scipscontrol:show_account_mod_date then
                 begin
                 Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[1] +
                                 cppliability:minimum_premium_adjustment[1] +
                                 cppliability:fire_legal_premium +
                                 cppliability:total_irpm[1],"ZZZ,ZZZ"))
                 If cppliability:minimum_premium_adjustment[1] <> 0 then
                     {
                     Writefile(L_FILE_NAME,"%s","*")
                     }
                 end
             else
                 begin
                 Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[1] +
                         cppliability:minimum_premium_adjustment[1] +
                         cppliability:fire_legal_premium,"ZZZ,ZZZ"))
                 If cppliability:minimum_premium_adjustment[1] <> 0 then
                     {
                     Writefile(L_FILE_NAME,"%s","*")
                     }
                 end
             end

         Writefile(L_FILE_NAME,"%s","<033>&a5115h+0V")
         Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
       --  Writefile(L_FILE_NAME,"%s","-->")
         if cppliability:prem[2] <> 0 then
           begin
             Writefile(L_FILE_NAME,"%s","$")
           end
         Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
         if sfpname:eff_date >= scipscontrol:show_account_mod_date and
            cppliability:prem[2] <> 0 then
           begin
             Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[2] +
                              cppliability:minimum_premium_adjustment[2] +
                              cppliability:total_irpm[2],"ZZZ,ZZZ"))
             If cppliability:minimum_premium_adjustment[2] <> 0 then
               {
                 Writefile(L_FILE_NAME,"%s","*")
               }
           end
         else
           if cppliability:prem[2] <> 0 then
             begin
               Writefile(L_FILE_NAME,"%s",Str(CPPLIABILITY:PREM[2] +
                           cppliability:minimum_premium_adjustment[2],"ZZZ,ZZZ"))
               If cppliability:minimum_premium_adjustment[2] <> 0 then
                 {
                   Writefile(L_FILE_NAME,"%s","*")
                 }
             end
           else
             if cppliablimits:products = 0 then
               begin
                 Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
                 writefile(l_file_name,"%s","EXCL")
               end
             else
               if cppliability:products_limit_table = "-" then
                 begin
                   Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
                   writefile(l_file_name,"%s","INCL")
                 end
         Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
         L_LINE_COUNTER = L_LINE_COUNTER + 1

         If CPPLIABILITY:CLASS_DESCRIPTION <> "" Then
           {
             Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
             L_LINE_COUNTER = L_LINE_COUNTER + 1
             Writefile(L_FILE_NAME,"%s",CPPLIABILITY:CLASS_DESCRIPTION)
           }
         Else
           {
             L_FONT             = L_ARIAL_9
             L_V_POSITION       = "+120"
             L_H_POSITION       = "200"
             L_CHARACTER_STRING = "CPSCLASS"--CPSCLASS:DESCRIPTION
             L_MAX_CHAR         = 80
             Include "line_spacing.inc"
           }


          if l_first = "Y" and
             cppliability:prem[1] > sfpmaster:other_totals[17] then
              begin
              l_first = "N"
              if sfpname:eff_date >= scipscontrol:show_account_mod_date then
                  begin
                  L_SUBTOTAL_PREM = L_SUBTOTAL_PREM +
                                CPPLIABILITY:PREM[1] +
                                cppliability:minimum_premium_adjustment[1] +
                                (sfpmaster:other_totals[17] * -1) +
                                cppliability:fire_legal_premium +
                                cppliability:total_irpm[1]
                  L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO +
                                CPPLIABILITY:PREM[2] +
                                cppliability:minimum_premium_adjustment[2] +
                                cppliability:total_irpm[2]
                  end
              else
                  begin
                  L_SUBTOTAL_PREM = L_SUBTOTAL_PREM + CPPLIABILITY:PREM[1] +
                                cppliability:minimum_premium_adjustment[1] +
                                (sfpmaster:other_totals[17] * -1) +
                                cppliability:fire_legal_premium
                  L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO + CPPLIABILITY:PREM[2] +
                                cppliability:minimum_premium_adjustment[2]
                  end
              end
          else
              begin
              if sfpname:eff_date >= scipscontrol:show_account_mod_date then
                  begin
                  L_SUBTOTAL_PREM = L_SUBTOTAL_PREM +
                                CPPLIABILITY:PREM[1] +
                                cppliability:minimum_premium_adjustment[1] +
                                cppliability:fire_legal_premium +
                                cppliability:total_irpm[1]
                  L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO +
                                CPPLIABILITY:PREM[2] +
                                cppliability:minimum_premium_adjustment[2] +
                                cppliability:total_irpm[2]
                  end
              else
                  begin
                  L_SUBTOTAL_PREM = L_SUBTOTAL_PREM + CPPLIABILITY:PREM[1] +
                                cppliability:minimum_premium_adjustment[1] +
                                cppliability:fire_legal_premium
                  L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO + CPPLIABILITY:PREM[2] +
                                cppliability:minimum_premium_adjustment[2]
                  end
              end

          Writefile(L_FILE_NAME,"%s","<033>&a5100h-20V")
          L_LINE_COUNTER = L_LINE_COUNTER - 0.17
          if sfpname:eff_date >= scipscontrol:show_account_mod_date then
            begin
              l_endorsement_total = l_endorsement_total +
                                    cppliability:total_endorsEments +
                                    cppliability:total_irpm[3] +
                                    cppliability:TOTAL_MISC +
                                    cppliability:total_irpm[4]
            end
          else
            begin
              l_endorsement_total = l_endorsement_total +
                                    cppliability:total_endorsEments +
                                    cppliability:TOTAL_MISC
            end

         Next cppliability
       }--End of outside While

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3000h+380V")
    L_LINE_COUNTER = L_LINE_COUNTER + 1.67
    Writefile(L_FILE_NAME,"%s","Prem Ops and Pr/Co Premium")
    Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
    Writefile(L_FILE_NAME,"%s",Str(L_SUBTOTAL_PREM,"ZZZ,ZZZ"))

    Writefile(L_FILE_NAME,"%s","<033>&a5115h+0V")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    if l_subtotal_prco <> 0 then
      begin
        Writefile(L_FILE_NAME,"%s","$")
      end
    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
    if l_subtotal_prco <> 0 then
      begin
        Writefile(L_FILE_NAME,"%s",Str(L_SUBTOTAL_PRCO,"ZZZ,ZZZ"))
      end
    else
    if cppliablimits:products = 0 then
      begin
        Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
        writefile(l_file_name,"%s","EXCL")
      end
    else
    if cppliability:products_limit_table = "-" then
      begin
        Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
        writefile(l_file_name,"%s","INCL")
      end

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
    Writefile(L_FILE_NAME,"%s","Endorsement Premium")
    Writefile(L_FILE_NAME,"%s","<033>&a4900h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
    Writefile(L_FILE_NAME,"%s",Str(l_endorsement_total,"ZZZ,ZZ9"))

    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
    Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
    L_LINE_COUNTER = L_LINE_COUNTER + 1
    Writefile(L_FILE_NAME,"%s","Total Advance Premium")
    Writefile(L_FILE_NAME,"%s","<033>&a4900h+0V")
    Writefile(L_FILE_NAME,"%s","$")

    Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_10)
    if sfpname:eff_date >= scipscontrol:show_account_mod_date then
      begin
        Writefile(L_FILE_NAME,"%s",Str(l_total_5 +
                                   l_total_11,"ZZZ,ZZZ"))
      end
    else
      begin
        Writefile(L_FILE_NAME,"%s",Str(l_total_5,"ZZZ,ZZZ"))
      end

    If l_minimum_premium_1 = "Y" Then
      {
        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
        Writefile(L_FILE_NAME,"%s"," MP")
      }
    if l_page_number mod 2 = 1 then   --make sure that the supplemental ends on a even page.
      {
        Writefile(L_FILE_NAME,"%s","<FF>")
        l_page_number = l_page_number + 1
      }
  end

End --END OF PROGRAM CPPDEC003b
