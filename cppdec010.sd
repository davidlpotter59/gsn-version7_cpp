%%
/*
Date Written: November 26, 2002

Name: cppdec010.sd

Copyright (c) 2000, SCIPS.com Inc.

Modify
Date                   By                  Comment
--------------------------------------------------------------
11/26/2002             RMG            Starting to add FAKE data to finish the
                                      structure of the form.. Search for the
                                      word FAKE! to find the temporary data.
===========================
*/

Program
  Name = "cppdec010";
  Type = "File";
  Domain = "SFPPRINT1";
  Padcharacter = Space;

 String L_FILE_NAME[12] = "cppdec010.cq";
 String L_SIGNATURE_STRING[100],
        L_FONT[35];
 String L_VERT_POS_1[5];
 String L_COPY_NAME[20] ;
 String I_REV_NAME2[50] ;
 String L_POLICY_FORM;
 String L_TYPE_STR[35];
 String L_POLICY_DECLARATION[60];
 String L_TRANS_EFF;
 String L_AUDIT;
 String L_PREV_STRING;
 String L_INSURED_CITY_STATE[50];
 String L_SFPNAME_ZIP="";
 String L_SFSAGENT;
 String L_SFSMORT_ZIP[10];
 String L_SFPSUPP_ZIP[10];
 String L_AGENT_ADDRESS;
 String L_FOB[75];
 String L_AGENT_TEL[13];
 String L_AGENT_ZIP[10];
 String L_MORGAGE_ID[10];
 String L_COMPANY_ID[10];
 String L_LOB_CODE[10];
 String L_MORTGAGE_TYPE_1[1];
 String L_BILL_PLAN[2];
 String L_STATE;
 String L_COMPANY_ZIP[10];
 String L_CPPLIABLIMTS_ZIP[10];
 String L_SFPLOCATION_ZIP[10];
 String L_TERROR_FORM[7];
 string L_EXPOSURE_base[2];
 Number L_TRANS_CODE;
 Number L_MM_1;
 Number L_DD_1;
 Number L_YY_1;
 Number L_RENEWAL[9];

 Unsigned Ascii Number L_SUPPLEMENTAL_SWITCH;
 Unsigned Ascii Number L_DECIPOINT;
 Unsigned Ascii Number L_CHARACTER_PER_INCH;
 Unsigned Ascii Number L_LEN_STRING;
 Unsigned Ascii Number L_PAGE_MIDDLE;
 Unsigned Ascii Number L_HALF_MULTIPLIER;
 Unsigned Ascii Number L_CHAR_MULTIPLIER[10]/decimals=4;
 Unsigned Ascii Number L_PAGE_NUMBER = 1;
 Unsigned Ascii Number L_ITEM_COUNTER;
 Unsigned Ascii Number L_LINE_COUNTER/decimals=2;
 Unsigned Ascii Number L_MED_LIMIT;
 Unsigned Ascii Number L_S_LINE_FOR_AGENT = 0; --start line for agent
 Unsigned Ascii Number L_S_LINE_FOR_LOCATION = 0; --start line for location
 Unsigned Ascii Number L_BIGGER_LINE =0;
 Unsigned Ascii Number L_SCREEN_COR= 0;
 Unsigned Ascii Number L_E_LINE_FOR_INSURED = 0;
 Unsigned Ascii Number L_PAGENUMBER;
 Unsigned Ascii Number L_MAX_LINES;
 Unsigned Ascii Number L_LOCATION_COUNTER;
 Unsigned Ascii Number L_SIZE_COUNTER;
 Unsigned Ascii Number L_first_time;
 Unsigned Ascii Number L_LIABILITY;
 Unsigned Ascii Number L_LINE_OF_BUSINESS[4];
 Signed ascii number l_endorsement_total[8];
 Unsigned Ascii Number L_INSURED_COUNTER;
 Unsigned Ascii Number L_AGENT_COUNTER;
 Unsigned Ascii Number L_TWO_PLACER;
 Unsigned Ascii Number L_SFSFORM[2];
 Unsigned Ascii Number L_SFSEND_FORM[2];
 Unsigned Ascii Number L_SFPMASTER_FORM[1];
 Unsigned Ascii Number L_LOOP;
 Unsigned Ascii Number L_LOOP1;
 Unsigned Ascii Number L_TOTAL[9];
 Unsigned Ascii Number L_STATE2[2];
 Unsigned Ascii Number L_COUNTY[3];
 Unsigned Ascii Number I_STATE[2];
 Unsigned Ascii Number l_prem_no[4] = 0001;
 Unsigned Ascii Number l_build_no[4] = 0001;
 String l_name_code[7] = "Name   ";
 Unsigned Ascii Number L_SUBTOTAL_PREM[9];
 Unsigned Ascii Number L_SUBTOTAL_PRCO[9];
 String L_STATE_STR[2];
 String L_CHARACTER_STRING[1000]           = "";
 String L_V_POSITION                       = "";
 String L_H_POSITION                       = "";
 Unsigned Ascii Number L_START_PRINT[4]    = 0;   --point to start printing.
 Unsigned Ascii Number L_END_PRINT[4]      = 0;
-- Unsigned Ascii Number L_LEN_STRING[4]     = 0;
 Unsigned Ascii Number L_CHARACTER_BREAK   = 0;
 Unsigned Ascii Number L_CHARACTER_COUNTER = 0;
 Unsigned Ascii Number L_MAX_CHAR          = 0;
 Unsigned Ascii Number L_ADD_SPACE[4];
 String L_NEWLINE;
 String L_NEWPAGE_WORDING[100];


  Wdate L_MESSAGE_EFF_DATE;
  Wdate L_MESSAGE_EXP_DATE;

 Include "csfonts.inc"
 Include "sfsrevname7.var"
 Include "header.var"

Initialization
Deletefile (L_FILE_NAME);

L_COPY_NAME = Uppercase(COMMANDLINE[1,20])

Update

Access SFPNAME,
   Set SFPNAME:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPNAME:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPNAME:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access CPPGENERAL ,
   Set CPPGENERAL:POLICY_NO    = SFPPRINT1:POLICY_NO,
       CPPGENERAL:POL_YEAR     = SFPPRINT1:POL_YEAR,
       CPPGENERAL:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPMASTER,
   Set SFPMASTER:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPMASTER:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPMASTER:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access CPPUMBRELLA,
   Set CPPUMBRELLA:POLICY_NO    = SFPPRINT1:POLICY_NO,
       CPPUMBRELLA:POL_YEAR     = SFPPRINT1:POL_YEAR,
       CPPUMBRELLA:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access cppfarmliab,
   Set cppfarmliab:POLICY_NO    = SFPPRINT1:POLICY_NO,
       cppfarmliab:POL_YEAR     = SFPPRINT1:POL_YEAR,
       cppfarmliab:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPLOCATION,
   Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPEND,
   Set SFPEND:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPEND:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPEND:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPPRINT3,
   Set SFPPRINT3:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPPRINT3:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPPRINT3:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

L_COMPANY_ID = SFPNAME:COMPANY_ID
L_STATE2 = SFPMASTER:STATE
L_COUNTY = cppfarmliab:COUNTY

Access SFSCOMPANY,
   Set SFSCOMPANY:COMPANY_ID = SFPNAME:COMPANY_ID, Exact

Access SFPCURRENT,
   Set SFPCURRENT:POLICY_NO = SFPPRINT1:POLICY_NO, Exact

l_line_of_business = sfpname:line_of_business

Access SFSLINE,
   Set SFSLINE:COMPANY_ID       = L_COMPANY_ID,
       SFSLINE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS,
       sfsline:lob_subline      = "00", Generic

Access SFSAGENT,
   Set SFSAGENT:COMPANY_ID = SFPNAME:COMPANY_ID,
       SFSAGENT:AGENT_NO   = SFPNAME:AGENT_NO, Exact

Access SFSSTATE,
   Set SFSSTATE:COMPANY_ID = L_COMPANY_ID,
       SFSSTATE:STATE      = L_STATE2,
       SFSSTATE:COUNTY     = L_COUNTY, Exact

Access cppfarmliab,
   Set cppfarmliab:POLICY_NO    = SFPPRINT1:POLICY_NO,
       cppfarmliab:POL_YEAR     = SFPPRINT1:POL_YEAR,
       cppfarmliab:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access CPSCLASS,
   Set CPSCLASS:COMPANY_ID       = L_COMPANY_ID,
       CPSCLASS:STATE            = L_STATE2,
       CPSCLASS:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
       CPSCLASS:GROUP_NO         = cppfarmliab:GROUP_NO,
       CPSCLASS:SUB_GROUP        = cppfarmliab:SUB_GROUP ,
       CPSCLASS:CLASS_CODE       = cppfarmliab:CLASS_CODE, Generic

Access cppfarmlimits,
   Set cppfarmlimits:POLICY_NO    = SFPPRINT1:POLICY_NO,
       cppfarmlimits:POL_YEAR     = SFPPRINT1:POL_YEAR,
       cppfarmlimits:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

Access SFPSUPP,
   Set SFPSUPP:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPSUPP:POL_YEAR     = SFPPRINT1:POL_YEAR ,
       SFPSUPP:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic;

L_SFSFORM = SFPMASTER:FORM


L_LOB_CODE = SFSLINE:LOB_CODE

I_STATE = SFPMASTER:STATE

Access SCIPSCONTROL,
   Set SCIPSCONTROL:COMPANY_ID          = L_COMPANY_ID,
       SCIPSCONTROL:STATE               = I_STATE,
       SCIPSCONTROL:LOB_CODE            = L_LOB_CODE, generic

Access SFSMESSAGE,
   Set SFSMESSAGE:COMPANY_ID       = L_COMPANY_ID,
       SFSMESSAGE:STATE            = L_STATE2,
       SFSMESSAGE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS, generic

while SFSMESSAGE:COMPANY_ID       = SFPNAME:COMPANY_ID and
      SFSMESSAGE:STATE            = L_STATE2 and
      SFSMESSAGE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS
        begin
        if sfpname:eff_date <= sfsmessage:exp_date and
           sfpname:eff_date >= sfsmessage:eff_date then
            begin
            L_message_eff_date = sfsmessage:eff_date
            L_message_exp_date = sfsmessage:exp_date
            end
        else
            begin
            l_message_eff_date = 0
            l_message_exp_date = 0
            end

        Next SFSMESSAGE
        end

Access SFSMESSAGE,
   Set SFSMESSAGE:COMPANY_ID       = L_COMPANY_ID,
       SFSMESSAGE:STATE            = L_STATE2,
       SFSMESSAGE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS,
       SFSMESSAGE:EFF_DATE         = L_MESSAGE_EFF_DATE,
       SFSMESSAGE:EXP_DATE         = L_MESSAGE_EXP_DATE, generic


L_PREV_STRING = If (SFPNAME:PREVIOUS_POLICY_NO <> 0) Then
                   Str(SFPNAME:PREVIOUS_POLICY_NO)
               Else
                   Str(SFPNAME:POLICY_NO)

L_POLICY_DECLARATION = Trun(SFSLINE:DESCRIPTION) + " " + "POLICY DECLARATIONS"

L_AGENT_TEL = SFSAGENT:TELEPHONE[1];

L_SFSAGENT = If (Val(SFSAGENT:ZIPCODE_1_4) = 0) Then
                      SFSAGENT:ZIPCODE_5_9
                    Else
                      SFSAGENT:ZIPCODE_5_9 + "-" + SFSAGENT:ZIPCODE_1_4

L_SFPNAME_ZIP = If (Val(SFPNAME:STR_ZIPCODE[6,9]) = 0) Then
                        SFPNAME:STR_ZIPCODE[1,5]
                        Else
                        SFPNAME:STR_ZIPCODE[1,5] + "-" +
                        SFPNAME:STR_ZIPCODE[6,9]

L_CPPLIABLIMTS_ZIP = If (Val(cppfarmlimits:STR_ZIPCODE[6,9]) = 0) Then
                        cppfarmlimits:STR_ZIPCODE[1,5]
                        Else
                        cppfarmlimits:STR_ZIPCODE[1,5] + "-" +
                        cppfarmlimits:STR_ZIPCODE[6,9]


L_INSURED_CITY_STATE = Trun(SFPNAME:CITY) + ", " + SFPNAME:STR_STATE + "  " + L_SFPNAME_ZIP

L_AGENT_ZIP =  If (Val(SFSAGENT:STR_ZIPCODE[6,9]) = 0) Then
                  SFSAGENT:STR_ZIPCODE[1,5]
                  Else
                  SFSAGENT:STR_ZIPCODE[1,5] + "-" +
                  SFSAGENT:STR_ZIPCODE[6,9]

L_COMPANY_ZIP =  If (Val(SFSCOMPANY:STR_ZIPCODE[6,9]) = 0) Then
                       SFSCOMPANY:STR_ZIPCODE[1,5]
                     Else
                       SFSCOMPANY:STR_ZIPCODE[1,5] + "-" +
                       SFSCOMPANY:STR_ZIPCODE[6,9]

L_COMPANY_ID = SFPNAME:COMPANY_ID

L_AGENT_ADDRESS = SFSAGENT:CITY + ", " + SFSAGENT:STR_STATE

L_MED_LIMIT = SFPMASTER:MEDICAL_LIMIT

Switch(SFPMASTER:FORM_OF_BUSINESS)
  Case 'C' : L_FOB = "Corporation"
  Case 'I' : L_FOB = "Individual"
  Case 'J' : L_FOB = "Joint Venture"
  Case 'O' : L_FOB = "Organization"
  Case 'P' : L_FOB = "Partnership"
  Case 'T' : L_FOB = SFPMASTER:FOB_DESCRIPTION
End

L_TRANS_CODE = SFPMASTER:TRANS_CODE
L_MM_1 = Month(SFPMASTER:TRANS_EFF)
L_DD_1 = Day(SFPMASTER:TRANS_EFF)
L_YY_1 = Year(SFPMASTER:TRANS_EFF)
L_AUDIT = SFPMASTER:AUDIT

L_TRANS_EFF = Str(L_MM_1) + "/" + Str(L_DD_1) + "/" + Str(L_YY_1)
Include "swudeccs.inc"

Switch(SFPMASTER:LIABILITY_CODE)
                 Case 1 : L_LIABILITY = 300000
                 Case 2 : L_LIABILITY = 500000
                 Case 3 : L_LIABILITY = 1000000
End

L_MAX_LINES = 60
L_SIZE_COUNTER = 0
L_LINE_COUNTER = 1
L_PAGENUMBER = 1
L_LOCATION_COUNTER = 1
L_INSURED_COUNTER = 0
L_AGENT_COUNTER = 0
L_STATE_STR = SFSCOMPANY:STR_STATE

Writefile(L_FILE_NAME,"%s",L_LEDUP)

If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
  {
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")
    Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --
    Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P")
  }

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
Writefile(L_FILE_NAME,"%s","Page ")
Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

L_POLICY_DECLARATION = uppercase(SCIPSCONTROL:CPP_HEADING[6])
Include "header3.inc"

Writefile(L_FILE_NAME,"%s%s","<NL>","<033>&f0S") --pushed memory location on stack
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s%s%s%s","<033>&f1S",trun(L_ARIAL_12),"<033>&a300h+30V",
                      "Policy Number","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s%s%s",trun(L_ARIAL_BOLD_14),
                      "<033>&a300h+20V",Trun(SFSLINE:ALPHA),
                      trun(str(SFPPRINT1:POLICY_NO)))

If SCIPSCONTROL:DONT_PRINT_PAYOR_CODE_ALL_COPY = 1 then
  {
    If SCIPSCONTROL:PAYOR_CODES = 1 and
       trun(uppercase(SCIPSCONTROL:PAY_CODE_COPY_NAME)) = trun(uppercase(L_COPY_NAME)) Then
       {
        L_BILL_PLAN = SFPNAME:BILL_PLAN
        If SFPSUPP:MORTGAGE_TYPE_1 = "" Then
          {
            L_MORTGAGE_TYPE_1 = " "
          }
        Else
          {
            L_MORTGAGE_TYPE_1 = SFPSUPP:MORTGAGE_TYPE_1
          }
        Access SFSPAYCODE,
           Set SFSPAYCODE:COMPANY_ID      = L_COMPANY_ID,
               SFSPAYCODE:BILL_PLAN       = L_BILL_PLAN,
               SFSPAYCODE:MORTGAGE_TYPE_1 = L_MORTGAGE_TYPE_1, Generic

        Writefile(L_FILE_NAME,"%s%s%s%s%s%s",trun(L_ARIAL_BOLD),"<033>&a+0h+0V"," - ",
                              SFPNAME:BILL_PLAN," - ",SFSPAYCODE:PAY_CODE)
      }
  }
Else
If SCIPSCONTROL:PAYOR_CODES = 1 Then
  {
    L_BILL_PLAN = SFPNAME:BILL_PLAN
    If (SFPSUPP:MORTGAGE_TYPE_1 = "") Then
      {
        L_MORTGAGE_TYPE_1 = " "
      }
    Else
      {
        L_MORTGAGE_TYPE_1 = SFPSUPP:MORTGAGE_TYPE_1
      }
    Access SFSPAYCODE,
            Set SFSPAYCODE:COMPANY_ID      = L_COMPANY_ID,
                SFSPAYCODE:BILL_PLAN       = L_BILL_PLAN,
                SFSPAYCODE:MORTGAGE_TYPE_1 = L_MORTGAGE_TYPE_1, Exact

    Writefile(L_FILE_NAME,"%s%s%s%s%s%s",trun(L_ARIAL_BOLD),"<033>&a+0h+0V"," -",
                          SFPNAME:BILL_PLAN,"-",SFSPAYCODE:PAY_CODE)
  }

If (SFPNAME:POLICY_TYPE = "W") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%s%s","<NL>",trun(L_ARIAL_BOLD_12),"<033>&a300h+80V",
                          "Rewrite of ",L_PREV_STRING)
    L_LINE_COUNTER = L_LINE_COUNTER + 1
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%s","<NL>",trun(L_ARIAL_BOLD_12),
                           "<033>&a300h+80V",L_TYPE_STR)
    L_LINE_COUNTER = L_LINE_COUNTER + 1
  }

If (L_TRANS_CODE One Of 12,13) Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%n",trun(L_ARIAL_BOLD_12),"<033>&a3900h+0V",
    "Endorsement #",SFPNAME:ENDORSEMENT_NUMBER)
  }
Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%n%s","<NL>","<NL>",trun(L_ARIAL_BOLD),
                      "<033>&a200h+0V","",
                      "<033>&a350h+0V","Named Insured and Mailing Address",
                      "<033>&a3000h+0V","Agent -","<033>&a3400h+0V",
                      SFSAGENT:AGENT_NO,"<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 3

Writefile(L_FILE_NAME,"%s%s","<033>&f0S",trun(L_ARIAL))

I_NAME=SFPNAME:NAME[1,1,40]
Include "sfsrevname7.pro"
If SFPNAME:NAME[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

I_NAME=SFPNAME:NAME[2,1,40]
Include "sfsrevname7.pro"
If SFPNAME:NAME[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

I_NAME=SFPNAME:NAME[3,1,40]
Include "sfsrevname7.pro"
If SFPNAME:NAME[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

If (SFPNAME:ADDRESS[1,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",SFPNAME:ADDRESS[1],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
If (SFPNAME:ADDRESS[2,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",SFPNAME:ADDRESS[2],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
If (SFPNAME:ADDRESS[3,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",SFPNAME:ADDRESS[3],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",L_INSURED_CITY_STATE,"<NL>")
L_INSURED_COUNTER = L_INSURED_COUNTER +1

Writefile(L_FILE_NAME,"%s%s","<033>&f1S",trun(L_ARIAL))
Writefile(L_FILE_NAME,"%s","<033>&f0S") --Push

Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",
                        SFSAGENT:NAME[1],"<NL>")
L_AGENT_COUNTER = L_AGENT_COUNTER +1

If SFSAGENT:NAME[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:NAME[2],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER + 1
  }
If SFSAGENT:NAME[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:NAME[3],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[1],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[2],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[3],
                          "<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a3000h+0V",Trun(SFSAGENT:CITY),", ",
                      SFSAGENT:STR_STATE," ",L_AGENT_ZIP,"<NL>")
L_AGENT_COUNTER = L_AGENT_COUNTER +1

If SFSAGENT:TELEPHONE[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%s %s-%s%s","<033>&a3000h+0V",
                      "(",L_AGENT_TEL[1,3],")",L_AGENT_TEL[4,6],
                      L_AGENT_TEL[7,10],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If L_INSURED_COUNTER < L_AGENT_COUNTER Then
  {
    L_TWO_PLACER = L_AGENT_COUNTER * 100 + 40
    L_LINE_COUNTER = L_LINE_COUNTER + L_AGENT_COUNTER
  }
Else
  {
    L_TWO_PLACER = L_INSURED_COUNTER * 100 + 40
    L_LINE_COUNTER = L_LINE_COUNTER + L_INSURED_COUNTER
  }

Writefile(L_FILE_NAME,"%s","<033>&f1S") --POP

Writefile(L_FILE_NAME,"%s%n%s","<033>&a140h+",L_TWO_PLACER,"V")
Writefile(L_FILE_NAME,"%s%s","<033>*c5455h20v0P","<NL>") --under name horizontal line to
L_LINE_COUNTER = L_LINE_COUNTER + 0.5

Writefile(L_FILE_NAME,"%s","<033>&f0S")

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","Policy Term: ")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL))
Writefile(L_FILE_NAME,"%s","<033>&a850h+0V")
Writefile(L_FILE_NAME,"%s","From ")
Writefile(L_FILE_NAME,"%s",Str(SFPNAME:EFF_DATE,"mm/dd/yyyy"))
Writefile(L_FILE_NAME,"%s"," to ")
Writefile(L_FILE_NAME,"%s",Str(SFPNAME:EXP_DATE,"mm/dd/yyyy"))
Writefile(L_FILE_NAME,"%s"," 12:01 A.M. Standard Time at your mailing address shown above.")
Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Switch(SFPMASTER:FORM_OF_BUSINESS)
  Case 'C' : L_FOB = "Corporation"
  Case 'I' : L_FOB = "Individual"
  Case 'J' : L_FOB = "Joint Venture"
  Case 'O' : L_FOB = "Organization"
  Case 'P' : L_FOB = "Partnership"
  Case 'T' : L_FOB = SFPMASTER:FOB_DESCRIPTION
End

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","You are a: ")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL))
Writefile(L_FILE_NAME,"%s",Uppercase(L_FOB))

Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

/*Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","Your Business/Operation: ")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL))
Writefile(L_FILE_NAME,"%s",Trun(cppfarmliab:BUSINESS_DESCRIPTION[1]))
Writefile(L_FILE_NAME,"%s"," ")
Writefile(L_FILE_NAME,"%s",Trun(cppfarmliab:BUSINESS_DESCRIPTION[2]))*/

Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s","<033>&f1S")

If cppfarmlimits:NAME[1] = "" And
   cppfarmlimits:NAME[2] = "" And
   cppfarmlimits:NAME[3] = "" Then
  {
    Writefile(L_FILE_NAME,"%s","<033>&a3000h+360V")
  }
For L_LOOP = 1 to 3
  {
    If cppfarmlimits:NAME[L_LOOP] <> "" Then
      {
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
        Writefile(L_FILE_NAME,"%s",cppfarmlimits:NAME[L_LOOP])
      }
  }
For L_LOOP = 1 to 3
  {
    If cppfarmlimits:ADDRESS[L_LOOP] <> "" Then
      {
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
        Writefile(L_FILE_NAME,"%s",cppfarmlimits:ADDRESS[L_LOOP])
      }
  }
If cppfarmlimits:CITY <> "" Then
  {
    Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
    Writefile(L_FILE_NAME,"%s",Trun(cppfarmlimits:CITY))
    Writefile(L_FILE_NAME,"%s",", ")
    Writefile(L_FILE_NAME,"%s",cppfarmlimits:STR_STATE)
    Writefile(L_FILE_NAME,"%s"," ")
    Writefile(L_FILE_NAME,"%s",L_CPPLIABLIMTS_ZIP)
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }


Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","IN RETURN FOR PAYMENT OF THE PREMIUM, AND SUBJECT TO ALL THE TERMS OF THIS POLICY, ")
Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s","WE AGREE WITH YOU TO PROVIDE THE INSURANCE AS STATED IN THIS POLICY.  THERE ARE EXCLUSIONS,")
Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
Writefile(L_FILE_NAME,"%s","CONDITIONS AND LIMITATIONS CONTAINED IN THE POLICY FORMS AND ENDORSEMENTS.")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h10v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3

Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
Writefile(L_FILE_NAME,"%s","LIMITS OF INSURANCE")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
Writefile(L_FILE_NAME,"%s","(N/A MEANS NO COVERAGE)")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h2v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3

Writefile(L_FILE_NAME,"%s","<033>*t600R")

Writefile(L_FILE_NAME,"%s","<033>&a175h-116V")
Writefile(L_FILE_NAME,"%s","<033>*c5G")
Writefile(L_FILE_NAME,"%s","<033>*c2245a49b2P")

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
Writefile(L_FILE_NAME,"%s","<033>&a220h+90V")
Writefile(L_FILE_NAME,"%s","Each Occurrence Limit")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
Writefile(L_FILE_NAME,"%s","$")

If cppfarmlimits:OCCURRENCE <> 0 Then
  {
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(cppfarmlimits:OCCURRENCE,"ZZZ,ZZZ,ZZZ"))
  }
Else
  {
    Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
  }

Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h1v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
Writefile(L_FILE_NAME,"%s","<033>&a220h-30V")
Writefile(L_FILE_NAME,"%s","General Aggregate Limit (Other Than Products-Completed Operations)")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
Writefile(L_FILE_NAME,"%s","$")
If cppfarmlimits:GENERAL_AGGREGATE <> 0 Then
  {
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(cppfarmlimits:GENERAL_AGGREGATE,"ZZZ,ZZZ,ZZZ"))
  }
Else
  {
    Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
  }

Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h1v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3

Writefile(L_FILE_NAME,"%s","<033>&a175h-116V")
Writefile(L_FILE_NAME,"%s","<033>*c5G")
Writefile(L_FILE_NAME,"%s","<033>*c2245a49b2P")

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
Writefile(L_FILE_NAME,"%s","<033>&a220h+90V")
Writefile(L_FILE_NAME,"%s","Products-Completed Operations Aggregate Limit")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
Writefile(L_FILE_NAME,"%s","$")
If cppfarmlimits:PRODUCTS <> 0 Then
  {
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(cppfarmlimits:PRODUCTS,"ZZZ,ZZZ,ZZZ"))
  }
Else
  {
    Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
  }

Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h1v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
Writefile(L_FILE_NAME,"%s","<033>&a220h-30V")
Writefile(L_FILE_NAME,"%s","Personal and Advertising Injury Limit")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
Writefile(L_FILE_NAME,"%s","$")
If cppfarmlimits:ADVERTISING_PERSONAL_INJURY <> 0 Then
  {
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(cppfarmlimits:ADVERTISING_PERSONAL_INJURY,"ZZZ,ZZZ,ZZZ"))
  }
Else
  {
    Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
  }


Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h1v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3

Writefile(L_FILE_NAME,"%s","<033>&a175h-116V")
Writefile(L_FILE_NAME,"%s","<033>*c5G")
Writefile(L_FILE_NAME,"%s","<033>*c2245a49b2P")

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
Writefile(L_FILE_NAME,"%s","<033>&a220h+90V")
Writefile(L_FILE_NAME,"%s","Fire Legal Liability Limit")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
Writefile(L_FILE_NAME,"%s","$")
If cppfarmlimits:FIRE_LEGAL <> 0 Then
  {
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(cppfarmlimits:FIRE_LEGAL,"ZZZ,ZZZ,ZZZ"))
  }
Else
  {
    Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
  }

Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
Writefile(L_FILE_NAME,"%s","Any One Fire")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h1v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
Writefile(L_FILE_NAME,"%s","<033>&a220h-30V")
Writefile(L_FILE_NAME,"%s","Medical Expense Limit")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a3500h+0V")
Writefile(L_FILE_NAME,"%s","$")
If cppfarmlimits:MEDICAL_PAYMENTS <> 0 Then
  {
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(cppfarmlimits:MEDICAL_PAYMENTS,"ZZZ,ZZZ,ZZZ"))
  }
Else
  {
    Writefile(L_FILE_NAME,"%s","<033>&a3940h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
  }
Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
Writefile(L_FILE_NAME,"%s","Any One Person")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-90V<033>*c5455h10v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s",Uppercase("Location of Premises you own, rent or occupy"))
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h5v0P","<NL>")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
Writefile(L_FILE_NAME,"%s","<033>&a400h-120V")

--Check the location and cppliabiity file and count the number of lines it will take to print
--all the lines that is needed for each location.


l_loop = 0
While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
      SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
      SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE

{
  if (trun(sfplocation:address) <> "") then
    {
      l_loop = l_loop + 1
    }
  for l_loop1 = 1 to 3
    {
      if trun(sfplocation:address1[l_loop]) <> "" then
        {
          l_loop = l_loop + 1
        }
    }
  l_loop = l_loop + 2  --this is for the Prem No. 1 Bldg No. 1 for each location and last line of city state zip
  l_endorsement_total = 0
  Access cppfarmliab,
     Set cppfarmliab:POLICY_NO    = SFPPRINT1:POLICY_NO,
         cppfarmliab:POL_YEAR     = SFPPRINT1:POL_YEAR,
         cppfarmliab:END_SEQUENCE = SFPPRINT1:END_SEQUENCE,
         cppfarmliab:PREM_NO      = SFPLOCATION:PREM_NO,
         cppfarmliab:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

  while cppfarmliab:POLICY_NO    = SFPPRINT1:POLICY_NO and
        cppfarmliab:POL_YEAR     = SFPPRINT1:POL_YEAR and
        cppfarmliab:END_SEQUENCE = SFPPRINT1:END_SEQUENCE and
        cppfarmliab:PREM_NO      = SFPLOCATION:PREM_NO and
        cppfarmliab:BUILD_NO     = SFPLOCATION:BUILD_NO
    {
      Access CPSCLASS,
         Set CPSCLASS:COMPANY_ID       = L_COMPANY_ID,
             CPSCLASS:STATE            = L_STATE2,
             CPSCLASS:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
             CPSCLASS:GROUP_NO         = cppfarmliab:GROUP_NO,
             CPSCLASS:SUB_GROUP        = cppfarmliab:SUB_GROUP ,
             CPSCLASS:CLASS_CODE       = cppfarmliab:CLASS_CODE,
             cpsclass:sub_code         = cppfarmliab:sub_code, Generic

      l_loop = l_loop + 2  --for the prem bldg no. code prem_ops date and description
      If len(trun(CPSCLASS:DESCRIPTION)) >= 80 Then  --if it goes more then one line
        {
          L_loop = L_loop + 1
        }
      l_endorsement_total = l_endorsement_total + cppfarmliab:total_endorsEments + cppfarmliab:TOTAL_MISC
      next cppfarmliab
    }
  next sfplocation
}

Access SFPLOCATION,
   Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
       SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
       SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

L_SUPPLEMENTAL_SWITCH = l_loop

If L_supplemental_switch > 13 or
   cppfarmlimits:form = 2 Then
  {
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
    Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
    Writefile(L_FILE_NAME,"%s","See Attached Location of Premises Supplemental for Details")
    Writefile(L_FILE_NAME,"%s","<NL>")
  }
Else
  {    --location information
   While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
         SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
         SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
     {
       L_sfplocation_ZIP = If (Val(sfplocation:STR_ZIPCODE[6,9]) = 0) Then
                              sfplocation:STR_ZIPCODE[1,5]
                           Else
                              sfplocation:STR_ZIPCODE[1,5] + "-" +
                              sfplocation:STR_ZIPCODE[6,9]

       Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
       Writefile(L_FILE_NAME,"%s","<033>&a400h+120V")
       Writefile(L_FILE_NAME,"%s","Prem No. ")
       Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
       Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:PREM_NO,"ZZZZ"))
       Writefile(L_FILE_NAME,"%s","<033>&a1100h+0V")
       Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
       Writefile(L_FILE_NAME,"%s","Bldg No. ")
       Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
       Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:BUILD_NO,"ZZZZ"))
       Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))

       L_LINE_COUNTER = L_LINE_COUNTER + 1

       Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
       Writefile(L_FILE_NAME,"%s","<033>&a400h+100V")
       Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:ADDRESS))
       Writefile(L_FILE_NAME,"%s","  ")
       Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:CITY))
       Writefile(L_FILE_NAME,"%s",", ")
       Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:STR_STATE))
       Writefile(L_FILE_NAME,"%s","  ")
       Writefile(L_FILE_NAME,"%s",L_SFPLOCATION_ZIP)
       L_LINE_COUNTER = L_LINE_COUNTER + 1
       Next SFPLOCATION
     }
 }
Writefile(L_FILE_NAME,"%s%s","<033>&a140h+40V<033>*c5455h10v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s",Uppercase("All known exposures at inception of the policy term are listed below:"))
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h5v0P","<NL>")


Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a2800h+0V")
Writefile(L_FILE_NAME,"%s","Premium Basis")
Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
Writefile(L_FILE_NAME,"%s","Advance Premium")

Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Classification")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a2000h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Code")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Prem Ops")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a3400h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","PR/CO")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a4585h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","Prem Ops")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
Writefile(L_FILE_NAME,"%s","<033>&a5240h+0V")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
Writefile(L_FILE_NAME,"%s","PR/CO")
Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)

L_LOOP = 0
L_SUBTOTAL_PREM = 0
L_SUBTOTAL_PRCO = 0

If L_SUPPLEMENTAL_SWITCH > 13 or
   cppfarmlimits:form = 2 Then
  {
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
    Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
    Writefile(L_FILE_NAME,"%s","See Attached Premium Basis Supplemental for Details")
    Writefile(L_FILE_NAME,"%s","<033>&a200h+80V")
  }
Else
  {
    l_endorsement_total = 0
    Access cppfarmliab,
       Set cppfarmliab:POLICY_NO    = SFPPRINT1:POLICY_NO,
           cppfarmliab:POL_YEAR     = SFPPRINT1:POL_YEAR,
           cppfarmliab:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, generic

    While cppfarmliab:POLICY_NO    = SFPPRINT1:POLICY_NO and
          cppfarmliab:POL_YEAR     = SFPPRINT1:POL_YEAR and
          cppfarmliab:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
      {
        If l_line_counter >= L_MAX_LINES - 5 Then
          {
            Do INSERT_NEWPAGE
          }

        Access CPPGENERAL ,
           Set CPPGENERAL:POLICY_NO    = SFPLOCATION:POLICY_NO,
               CPPGENERAL:POL_YEAR     = SFPLOCATION:POL_YEAR,
               CPPGENERAL:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
               CPPGENERAL:PREM_NO      = SFPLOCATION:PREM_NO,
               CPPGENERAL:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

        l_line_of_business = sfsline:rating_line_of_business
        Access CPSCLASS,
           Set CPSCLASS:COMPANY_ID       = L_COMPANY_ID,
               CPSCLASS:STATE            = L_STATE2,
               CPSCLASS:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
               CPSCLASS:GROUP_NO         = cppfarmliab:GROUP_NO,
               CPSCLASS:SUB_GROUP        = cppfarmliab:SUB_GROUP ,
               CPSCLASS:CLASS_CODE       = cppfarmliab:CLASS_CODE,
               cpsclass:sub_code         = cppfarmliab:sub_code, Generic

        If (Val(SFPLOCATION:STR_ZIPCODE[6,9]) = 0) Then
          {
            l_sfplocation_zip = SFPLOCATION:STR_ZIPCODE[1,5]
          }
        Else
          {
            l_sfplocation_zip = SFPLOCATION:STR_ZIPCODE[1,5] + "-" +
                                SFPLOCATION:STR_ZIPCODE[6,9]
          }

        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
        Writefile(L_FILE_NAME,"%s","Prem No. ")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:PREM_NO,"ZZZZ"))
        Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","Bldg No. ")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:BUILD_NO,"ZZZZ"))
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        Writefile(L_FILE_NAME,"%s","<033>&a2000h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",str(cppfarmliab:CLASS_CODE,"9999"))
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))

        l_exposure_base = cppfarmliab:EXPOSURE_base[1]

        Access CPSLIABEXPBASE,
           Set CPSLIABEXPBASE:COMPANY_ID       = L_COMPANY_ID,
               CPSLIABEXPBASE:STATE            = L_STATE2,
               CPSLIABEXPBASE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
               CPSLIABEXPBASE:EXPOSURE_BASE    = l_exposure_base, Generic

        Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
        Writefile(L_FILE_NAME,"%s",trun(l_exposure_base))
        Writefile(L_FILE_NAME,"%s",") ")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:exposure[1],"ZZ,ZZZ,ZZZ"))

        l_exposure_base = cppfarmliab:EXPOSURE_base[2]

        Access CPSLIABEXPBASE,
           Set CPSLIABEXPBASE:COMPANY_ID       = L_COMPANY_ID,
               CPSLIABEXPBASE:STATE            = L_STATE2,
               CPSLIABEXPBASE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
               CPSLIABEXPBASE:EXPOSURE_BASE    = l_exposure_base, Generic
        Writefile(L_FILE_NAME,"%s","<033>&a3400h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
        Writefile(L_FILE_NAME,"%s",trun(l_exposure_base))
        Writefile(L_FILE_NAME,"%s",") ")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        If cppfarmliab:exposure[2] <> 0 Then
          {
            Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:exposure[2],"ZZ,ZZZ,ZZZ"))
          }
        Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","$")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:PREM[1],"ZZZ,ZZZ"))

        Writefile(L_FILE_NAME,"%s","<033>&a5115h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","$")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:PREM[2],"ZZZ,ZZZ"))
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        If cppfarmliab:CLASS_DESCRIPTION <> "" Then
          {
            Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
            Writefile(L_FILE_NAME,"%s",cppfarmliab:CLASS_DESCRIPTION)
          }
        Else
          {
            L_FONT             = trun(L_ARIAL_9)
            L_V_POSITION       = "+120"
            L_H_POSITION       = "200"
            L_CHARACTER_STRING = CPSCLASS:DESCRIPTION
            L_MAX_CHAR         = 80
            Include "line_spacing.inc"
          }
        L_SUBTOTAL_PREM = L_SUBTOTAL_PREM + cppfarmliab:PREM[1]
        L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO + cppfarmliab:PREM[2]

        Writefile(L_FILE_NAME,"%s","<033>&a5100h-20V")
        l_endorsement_total = l_endorsement_total + cppfarmliab:total_endorsEments + cppfarmliab:TOTAL_MISC
      Next cppfarmliab
    }

If L_SUPPLEMENTAL_SWITCH <= 13 and
   cppfarmlimits:form <> 2 Then
  {
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
    Writefile(L_FILE_NAME,"%s","<033>&a3000h+180V")
    Writefile(L_FILE_NAME,"%s","Prem Ops and Pr/Co Premium")
    Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(L_SUBTOTAL_PREM,"ZZZ,ZZZ"))

    Writefile(L_FILE_NAME,"%s","<033>&a5115h+0V")
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(L_SUBTOTAL_PRCO,"ZZZ,ZZZ"))
    L_LINE_COUNTER = L_LINE_COUNTER + 1
  }
}

If L_SUPPLEMENTAL_SWITCH <= 13 and
   cppfarmlimits:form <> 2 Then
  {
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
    Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
    Writefile(L_FILE_NAME,"%s","Endorsement Premium")
    Writefile(L_FILE_NAME,"%s","<033>&a4900h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))

    Writefile(L_FILE_NAME,"%s",Str(l_endorsement_total,"ZZZ,ZZZ"))

Access SFSLINE,
   Set SFSLINE:COMPANY_ID       = L_COMPANY_ID,
       SFSLINE:LINE_OF_BUSINESS = SFPNAME:LINE_OF_BUSINESS, Generic

/*
If SFSLINE:LOB_CODE = "LIABILITY" Then
  {
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
    Writefile(L_FILE_NAME,"%s","<033>&a3490h+120V")
    Writefile(L_FILE_NAME,"%s","Total Advance Premium")
    Writefile(L_FILE_NAME,"%s","<033>&a5115h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(SFPMASTER:TOTAL[10] +
                                   SFPMASTER:TOTAL[8],"ZZZ,ZZZ"))
  }
Else
  { */

    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
    Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
    Writefile(L_FILE_NAME,"%s","Total Advance Premium")
    Writefile(L_FILE_NAME,"%s","<033>&a4900h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(SFPMASTER:TOTAL[10],"ZZZ,ZZZ"))
--  }
    If SFPMASTER:MINIMUM_PREMIUM[5] = "Y" Then
      {
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s"," MP")
      }
  }
Writefile(L_FILE_NAME,"%s%s","<033>&a140h+40V<033>*c5455h15v0P","<NL>")

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_16))
Writefile(L_FILE_NAME,"%s","<033>&a420h+120V")
Writefile(L_FILE_NAME,"%s","This Policy Contains Aggregate Limits: See Part II D 2 for Details")

If L_LINE_COUNTER >= L_MAX_LINES - 10 Then
  {
    Do INSERT_NEWPAGE
  }

Writefile(L_FILE_NAME,"%s","<033>&a420h+360V")

If (SCIPSCONTROL:SIGNATURE = 1) Then
  {

    L_SIGNATURE_STRING = "<033>" + Trun(SCIPSCONTROL:SIGNATURE_SYMBOL_SET) +
                         "<033>" + Trun(SCIPSCONTROL:SIGNATURE_DEFINITION)

    If SCIPSCONTROL:SIGNATURE_VERT_POS[1] = "-" Then
      {
        L_VERT_POS_1 = "-" + SCIPSCONTROL:SIGNATURE_VERT_POS[2,5]
      }
    Else
      If SCIPSCONTROL:SIGNATURE_VERT_POS[1] = "+" Then
        {
          L_VERT_POS_1 = "+" + SCIPSCONTROL:SIGNATURE_VERT_POS[2,5]
        }

    Writefile(L_FILE_NAME,"%s","<033>&a")
    Writefile(L_FILE_NAME,"%n",SCIPSCONTROL:SIGNATURE_HOZ_POS)
    Writefile(L_FILE_NAME,"%s","h")
    Writefile(L_FILE_NAME,"%s",Trun(SCIPSCONTROL:SIGNATURE_VERT_POS))
    Writefile(L_FILE_NAME,"%s","V")
    Writefile(L_FILE_NAME,"%s",trun(L_SIGNATURE_STRING))
    Writefile(L_FILE_NAME,"%s",Trun(SCIPSCONTROL:SIGNATURE_STRING_TO_PRINT))
    Writefile(L_FILE_NAME,"%s","<033>&a0h")
    Writefile(L_FILE_NAME,"%s",Trun(L_VERT_POS_1))
    Writefile(L_FILE_NAME,"%s","V")
  }

if scipscontrol:dont_print_countersignature[3] = 0 then
  {
    Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s",trun(L_ARIAL),"<033>&a200h+0V<033>*c2000h5v0P",
                         "<033>&a2575h+0V","By:","<033>&a2750h-0V<033>*c2800h5v0P",
                         "<NL>")
    Writefile(L_FILE_NAME,"%s%s%s%s","<033>&a800h+0V","Countersignature Date",
                         "<033>&a3200h+0V","Representative")
    If (SCIPSCONTROL:COUNTERSIGNATURE_DATE = 1) Then
      {
        Writefile(L_FILE_NAME,"%s%d%s","<033>&a800h-120V",TODAYSDATE,
                              "<033>&a+0h+20V")
      }
  }


If ((SFSMESSAGE:NEW = 1 and
   sfpmaster:trans_code one of 10) or
   (SFSMESSAGE:RENEWAL = 1 and
   sfpmaster:trans_code one of 14) or
   (SFSMESSAGE:ENDORSEMENT = 1 and
   sfpmaster:trans_code one of 12, 13) or
   (SFSMESSAGE:CANCELLATION = 1 and
   sfpmaster:trans_code one of 11) or
   (SFSMESSAGE:REINSTATEMENT = 1 and
   sfpmaster:trans_code one of 16) or
   SFSMESSAGE:ALL = 1) then
    begin
    If (L_LINE_COUNTER > (L_MAX_LINES - 10)) Then
        begin
        Do INSERT_NEWPAGE
        end
    Writefile(L_FILE_NAME,"%s","<033>&a220h+320V")
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_12))
    Writefile(L_FILE_NAME,"%s","Important Messages")
    end

If L_TRANS_CODE one of 10 and
   SFSMESSAGE:NEW = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }

    L_FONT             = trun(L_ARIAL)
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:NEW_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 11 and
   SFSMESSAGE:CANCELLATION = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = trun(L_ARIAl)
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:CANCELLATION_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 14 and
   SFSMESSAGE:RENEWAL = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = trun(L_ARIAL)
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:RENEWAL_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 16 and
   SFSMESSAGE:NEW = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = trun(L_ARIAL)
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:REINSTATEMENT_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 12,13 and
   SFSMESSAGE:ENDORSEMENT = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = trun(L_ARIAL)
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:ENDORSEMENT_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If SFSMESSAGE:ALL = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = trun(L_ARIAL)
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:ALL_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }

Writefile(L_FILE_NAME,"%s%s%s%s",trun(L_ARIAL_BOLD),"<033>&a200h7250V","Issue Date ",
                      Str(SFPNAME:TRANS_DATE,"mm/dd/yyyy"))

If L_SUPPLEMENTAL_SWITCH > 13 or
   cppfarmlimits:form = 2  Then
  {
    Do LOCATION
  }
if l_supplemental_switch > 13 or
   cppfarmlimits:form = 2 then
  {
    Do PREMIUM_BASIS
  }

Screen Exit
Writefile(L_FILE_NAME,"%s%s",L_FORMFEED ,L_RESET )
Closefile(L_FILE_NAME)

Procedure Definition

Procedure INSERT_NEWPAGE

{
  Writefile(L_FILE_NAME,"%s","<FF>")
  L_LINE_COUNTER = 0
  If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
      Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
      Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
    }
  L_PAGE_NUMBER = L_PAGE_NUMBER + 1
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
  Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
  Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
  Writefile(L_FILE_NAME,"%s","Page ")
  Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
  Writefile(L_FILE_NAME,"%s","<033>&a200h120V")

  Writefile(L_FILE_NAME,"%s",uppercase(L_POLICY_DECLARATION))
  Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
  Writefile(L_FILE_NAME,"%s","Policy No. ")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
  Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
  Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

  Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
  L_LINE_COUNTER = L_LINE_COUNTER + 2
--  Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5a120b0P")   --left vertical line
}

Procedure LOCATION

{
  Writefile(L_FILE_NAME,"%s","<FF>")
  L_LINE_COUNTER = 0
  L_PAGE_NUMBER = 0
  If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
      Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
      Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
    }
  L_PAGE_NUMBER = L_PAGE_NUMBER + 1

  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
  Writefile(L_FILE_NAME,"%s",L_COPY_NAME)

  Writefile(L_FILE_NAME,"%s","<033>&a200h300V")
  Writefile(L_FILE_NAME,"%s","LOCATION OF PREMISES SUPPLEMENTAL")
  L_LINE_COUNTER = L_LINE_COUNTER + 1

  Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
  L_LINE_COUNTER = L_LINE_COUNTER + 3

  Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
  Writefile(L_FILE_NAME,"%s","Policy # ")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
  Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
  Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

  Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
  Writefile(L_FILE_NAME,"%s","SCHEDULE")
  L_LINE_COUNTER = L_LINE_COUNTER + 2

  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
  Writefile(L_FILE_NAME,"%s","Location of Premises you own, rent or occupy")
  L_LINE_COUNTER = L_LINE_COUNTER + 2

  Access SFPLOCATION,
     Set SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO,
         SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR,
         SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, Generic

  While SFPLOCATION:POLICY_NO    = SFPPRINT1:POLICY_NO And
        SFPLOCATION:POL_YEAR     = SFPPRINT1:POL_YEAR And
        SFPLOCATION:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
    {
      L_NEWPAGE_WORDING = "LOCATION OF PREMISES SUPPLEMENTAL DECLARATIONS"
      do new_supplemental_page
      Access cppfarmliab,
         Set cppfarmliab:POLICY_NO    = SFPPRINT1:POLICY_NO,
             cppfarmliab:POL_YEAR     = SFPPRINT1:POL_YEAR,
             cppfarmliab:END_SEQUENCE = SFPPRINT1:END_SEQUENCE,
             cppfarmliab:PREM_NO      = SFPLOCATION:PREM_NO,
             cppfarmliab:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

      Access CPSCLASS,
         Set CPSCLASS:COMPANY_ID       = L_COMPANY_ID,
             CPSCLASS:STATE            = L_STATE2,
             CPSCLASS:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
             CPSCLASS:GROUP_NO         = cppfarmliab:GROUP_NO,
             CPSCLASS:SUB_GROUP        = cppfarmliab:SUB_GROUP ,
             CPSCLASS:CLASS_CODE       = cppfarmliab:CLASS_CODE,
             cpsclass:sub_code         = cppfarmliab:sub_code, generic

      L_sfplocation_ZIP = If (Val(sfplocation:STR_ZIPCODE[6,9]) = 0) Then
                             sfplocation:STR_ZIPCODE[1,5]
                          Else
                             sfplocation:STR_ZIPCODE[1,5] + "-" +
                             sfplocation:STR_ZIPCODE[6,9]

      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
      Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
      Writefile(L_FILE_NAME,"%s","Prem No. ")
      Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
      Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:PREM_NO,"ZZZZ"))
      Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
      Writefile(L_FILE_NAME,"%s","Bldg No. ")
      Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
      Writefile(L_FILE_NAME,"%s",Str(SFPLOCATION:BUILD_NO,"ZZZZ"))
      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
      L_LINE_COUNTER = L_LINE_COUNTER + 2

      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
      Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
      Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:ADDRESS))
      L_LINE_COUNTER = L_LINE_COUNTER + 1

      Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
      Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:CITY))
      Writefile(L_FILE_NAME,"%s",", ")
      Writefile(L_FILE_NAME,"%s",Trun(SFPLOCATION:STR_STATE))
      Writefile(L_FILE_NAME,"%s","  ")
      Writefile(L_FILE_NAME,"%s",L_SFPLOCATION_ZIP)
      L_LINE_COUNTER = L_LINE_COUNTER + 1

      Next SFPLOCATION
    }

  If L_LINE_COUNTER < L_MAX_LINES - 9  and
     cppfarmlimits:form = 2 Then
    {
      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
      Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
      Writefile(L_FILE_NAME,"%s","CONTRACTORS MAILING ADDRESS")
      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
    }

  if cppfarmlimits:form = 2 then  --CONTRACTORS ADDRESS if form 2
    {
      access cppendorse,
             cppendorse:policy_no    = sfpprint1:policy_no,
             cppendorse:pol_year     = sfpprint1:pol_year,
             cppendorse:end_sequence = sfpprint1:end_sequence,
             cppendorse:prem_no      = l_prem_no,
             cppendorse:build_no     = l_build_no,
             cppendorse:code         = L_name_code, generic

      while  cppendorse:policy_no    = sfpprint1:policy_no and
             cppendorse:pol_year     = sfpprint1:pol_year and
             cppendorse:end_sequence = sfpprint1:end_sequence and
             cppendorse:prem_no      = l_prem_no and
             cppendorse:build_no     = l_build_no and
             cppendorse:code         = L_name_code
        {
          Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
          L_NEWPAGE_WORDING = "CONTRACTORS MAILING SUPPLEMENTAL DECLARATIONS"
          do new_supplemental_page
          L_LINE_COUNTER = L_LINE_COUNTER + 1
          for l_loop = 1 to 3
            {
              if trun(cppendorse:name[l_loop]) <> "" then
                {
                  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
                  Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
                  Writefile(L_FILE_NAME,"%s",Trun(cppendorse:name[l_loop]))
                  L_LINE_COUNTER = L_LINE_COUNTER + 1
                }
            }
          Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
          Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
          Writefile(L_FILE_NAME,"%s",Trun(cppendorse:address))
          L_LINE_COUNTER = L_LINE_COUNTER + 1
          for l_loop = 1 to 2
            {
              if trun(cppendorse:address1[l_loop]) <> "" then
                {
                  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
                  Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
                  Writefile(L_FILE_NAME,"%s",Trun(cppendorse:address1[l_loop]))
                  L_LINE_COUNTER = L_LINE_COUNTER + 1
                }
            }
          Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
          Writefile(L_FILE_NAME,"%s",Trun(cppendorse:CITY))
          Writefile(L_FILE_NAME,"%s",", ")
          Writefile(L_FILE_NAME,"%s",Trun(cppendorse:STR_STATE))
          Writefile(L_FILE_NAME,"%s","  ")
          L_sfplocation_ZIP = If (Val(cppendorse:STR_ZIPCODE[6,9]) = 0) Then
                                cppendorse:STR_ZIPCODE[1,5]
                              Else
                                cppendorse:STR_ZIPCODE[1,5] + "-" +
                                cppendorse:STR_ZIPCODE[6,9]

          Writefile(L_FILE_NAME,"%s",L_SFPLOCATION_ZIP)
          L_LINE_COUNTER = L_LINE_COUNTER + 1
          next cppendorse
        } -- while
    }  -- if
  If L_PAGE_NUMBER Mod 2 = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<FF>")
    }
}

procedure new_supplemental_page

{
  If L_LINE_COUNTER > L_MAX_LINES - 7 Then
    {
      If L_PAGE_NUMBER = 1 Then
        {
          Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
          Writefile(L_FILE_NAME,"%s","<033>&a5000h7250V")
          Writefile(L_FILE_NAME,"%s","Page ")
          Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)
        }
      Writefile(L_FILE_NAME,"%s","<FF>")
      L_LINE_COUNTER = 0
      If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
        {
          Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
          Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
          Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
          Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
        }
      L_PAGE_NUMBER = L_PAGE_NUMBER + 1

      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
      Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
      Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
      Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
      Writefile(L_FILE_NAME,"%s","Page ")
      Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
      Writefile(L_FILE_NAME,"%s","<033>&a200h120V")

      Writefile(L_FILE_NAME,"%s",TRUN(L_NEWPAGE_WORDING))
      Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
      Writefile(L_FILE_NAME,"%s","Policy No. ")
      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
      Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
      Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

      Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
      L_LINE_COUNTER = L_LINE_COUNTER + 2
    }
}

Procedure PREMIUM_BASIS

{
  Writefile(L_FILE_NAME,"%s","<FF>")
  L_LINE_COUNTER = 0
  L_PAGE_NUMBER = 0
  If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
      Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
      Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
    }
  L_PAGE_NUMBER = L_PAGE_NUMBER + 1

  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
  Writefile(L_FILE_NAME,"%s",L_COPY_NAME)

  Writefile(L_FILE_NAME,"%s","<033>&a200h300V")
  Writefile(L_FILE_NAME,"%s","PREMIUM BASIS SUPPLEMENTAL")
  L_LINE_COUNTER = L_LINE_COUNTER + 1

  Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
  L_LINE_COUNTER = L_LINE_COUNTER + 3

  Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
  Writefile(L_FILE_NAME,"%s","Policy # ")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
  Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
  Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

  Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")
  Writefile(L_FILE_NAME,"%s","SCHEDULE")
  L_LINE_COUNTER = L_LINE_COUNTER + 2

  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
  Writefile(L_FILE_NAME,"%s","<033>&a2800h+240V")
  Writefile(L_FILE_NAME,"%s","Premium Basis")
  Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
  Writefile(L_FILE_NAME,"%s","Advance Premium")
  L_LINE_COUNTER = L_LINE_COUNTER + 2

  Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
  Writefile(L_FILE_NAME,"%s","Classification")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
  Writefile(L_FILE_NAME,"%s","<033>&a1700h+0V")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
  Writefile(L_FILE_NAME,"%s","Code")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
  Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
  Writefile(L_FILE_NAME,"%s","Prem Ops")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
  Writefile(L_FILE_NAME,"%s","<033>&a3400h+0V")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
  Writefile(L_FILE_NAME,"%s","PR/CO")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
  Writefile(L_FILE_NAME,"%s","<033>&a4585h+0V")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
  Writefile(L_FILE_NAME,"%s","Prem Ops")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
  Writefile(L_FILE_NAME,"%s","<033>&a5240h+0V")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
  Writefile(L_FILE_NAME,"%s","PR/CO")
  Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
  L_LINE_COUNTER = L_LINE_COUNTER + 1

  L_SUBTOTAL_PREM = 0
  L_SUBTOTAL_PRCO = 0
  l_endorsement_total = 0

  Access cppfarmliab,
     Set cppfarmliab:POLICY_NO    = SFPPRINT1:POLICY_NO,
         cppfarmliab:POL_YEAR     = SFPPRINT1:POL_YEAR,
         cppfarmliab:END_SEQUENCE = SFPPRINT1:END_SEQUENCE, generic

    While cppfarmliab:POLICY_NO    = SFPPRINT1:POLICY_NO and
          cppfarmliab:POL_YEAR     = SFPPRINT1:POL_YEAR and
          cppfarmliab:END_SEQUENCE = SFPPRINT1:END_SEQUENCE
      {
        If l_line_counter >= L_MAX_LINES - 5 Then
          {
           If L_PAGE_NUMBER = 1 Then
            {
              Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
              Writefile(L_FILE_NAME,"%s","<033>&a5000h7250V")
              Writefile(L_FILE_NAME,"%s","Page ")
              Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)
            }
          Writefile(L_FILE_NAME,"%s","<FF>")
          L_LINE_COUNTER = 0
          If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
            {
              Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
              Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
              Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
              Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
            }
          L_PAGE_NUMBER = L_PAGE_NUMBER + 1

          Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
          Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
          Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
          Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
          Writefile(L_FILE_NAME,"%s","Page ")
          Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

          Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
          Writefile(L_FILE_NAME,"%s","<033>&a200h120V")
          L_LINE_COUNTER = L_LINE_COUNTER + 1

          Writefile(L_FILE_NAME,"%s","PREMIUM BASIS SUPPLEMENTAL")
          Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
          Writefile(L_FILE_NAME,"%s","Policy No. ")
          Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
          Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
          Writefile(L_FILE_NAME,"%n",SFPPRINT1:POLICY_NO)

          Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
          L_LINE_COUNTER = L_LINE_COUNTER + 2

          Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
          Writefile(L_FILE_NAME,"%s","<033>&a2800h+0V")
          Writefile(L_FILE_NAME,"%s","Premium Basis")
          Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
          Writefile(L_FILE_NAME,"%s","Advance Premium")

          Writefile(L_FILE_NAME,"%s","<033>&a200h+100V")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
          Writefile(L_FILE_NAME,"%s","Classification")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
          Writefile(L_FILE_NAME,"%s","<033>&a1700h+0V")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
          Writefile(L_FILE_NAME,"%s","Code")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
          Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
          Writefile(L_FILE_NAME,"%s","Prem Ops")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
          Writefile(L_FILE_NAME,"%s","<033>&a3400h+0V")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
          Writefile(L_FILE_NAME,"%s","PR/CO")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
          Writefile(L_FILE_NAME,"%s","<033>&a4585h+0V")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
          Writefile(L_FILE_NAME,"%s","Prem Ops")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
          Writefile(L_FILE_NAME,"%s","<033>&a5240h+0V")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_START)
          Writefile(L_FILE_NAME,"%s","PR/CO")
          Writefile(L_FILE_NAME,"%s",L_UNDERLINE_END)
          L_LINE_COUNTER = L_LINE_COUNTER + 1
        }

        Access CPPGENERAL ,
           Set CPPGENERAL:POLICY_NO    = SFPLOCATION:POLICY_NO,
               CPPGENERAL:POL_YEAR     = SFPLOCATION:POL_YEAR,
               CPPGENERAL:END_SEQUENCE = SFPLOCATION:END_SEQUENCE,
               CPPGENERAL:PREM_NO      = SFPLOCATION:PREM_NO,
               CPPGENERAL:BUILD_NO     = SFPLOCATION:BUILD_NO, Generic

        l_line_of_business = sfsline:rating_line_of_business
        Access CPSCLASS,
           Set CPSCLASS:COMPANY_ID       = L_COMPANY_ID,
               CPSCLASS:STATE            = L_STATE2,
               CPSCLASS:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
               CPSCLASS:GROUP_NO         = cppfarmliab:GROUP_NO,
               CPSCLASS:SUB_GROUP        = cppfarmliab:SUB_GROUP ,
               CPSCLASS:CLASS_CODE       = cppfarmliab:CLASS_CODE,
               cpsclass:sub_code         = cppfarmliab:sub_code, Generic

        If (Val(SFPLOCATION:STR_ZIPCODE[6,9]) = 0) Then
          {
            l_sfplocation_zip = SFPLOCATION:STR_ZIPCODE[1,5]
          }
        Else
          {
            l_sfplocation_zip = SFPLOCATION:STR_ZIPCODE[1,5] + "-" +
                                SFPLOCATION:STR_ZIPCODE[6,9]
          }

        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
        Writefile(L_FILE_NAME,"%s","Prem No. ")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:PREM_NO,"ZZZZ"))
        Writefile(L_FILE_NAME,"%s","<033>&a900h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","Bldg No. ")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:BUILD_NO,"ZZZZ"))
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        Writefile(L_FILE_NAME,"%s","<033>&a2000h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",str(cppfarmliab:CLASS_CODE,"9999"))
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))

        l_exposure_base = cppfarmliab:EXPOSURE_base[1]

        Access CPSLIABEXPBASE,
           Set CPSLIABEXPBASE:COMPANY_ID       = L_COMPANY_ID,
               CPSLIABEXPBASE:STATE            = L_STATE2,
               CPSLIABEXPBASE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
               CPSLIABEXPBASE:EXPOSURE_BASE    = l_exposure_base, Generic

        Writefile(L_FILE_NAME,"%s","<033>&a2500h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
        Writefile(L_FILE_NAME,"%s",trun(l_exposure_base))
        Writefile(L_FILE_NAME,"%s",") ")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:exposure[1],"ZZ,ZZZ,ZZZ"))

        l_exposure_base = cppfarmliab:EXPOSURE_base[2]

        Access CPSLIABEXPBASE,
           Set CPSLIABEXPBASE:COMPANY_ID       = L_COMPANY_ID,
               CPSLIABEXPBASE:STATE            = L_STATE2,
               CPSLIABEXPBASE:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS,
               CPSLIABEXPBASE:EXPOSURE_BASE    = l_exposure_base, Generic

        Writefile(L_FILE_NAME,"%s","<033>&a3400h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
        Writefile(L_FILE_NAME,"%s",trun(l_exposure_base))
        Writefile(L_FILE_NAME,"%s",") ")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        If cppfarmliab:exposure[2] <> 0 Then
          {
            Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:exposure[2],"ZZ,ZZZ,ZZZ"))
          }
        Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","$")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:PREM[1],"ZZZ,ZZZ"))

        Writefile(L_FILE_NAME,"%s","<033>&a5115h+0V")
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","$")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(cppfarmliab:PREM[2],"ZZZ,ZZZ"))
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        If cppfarmliab:CLASS_DESCRIPTION <> "" Then
          {
            Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
            Writefile(L_FILE_NAME,"%s",cppfarmliab:CLASS_DESCRIPTION)
          }
        Else
          {
            L_FONT             = trun(L_ARIAL_9)
            L_V_POSITION       = "+120"
            L_H_POSITION       = "200"
            L_CHARACTER_STRING = CPSCLASS:DESCRIPTION
            L_MAX_CHAR         = 80
            Include "line_spacing.inc"
          }
        L_SUBTOTAL_PREM = L_SUBTOTAL_PREM + cppfarmliab:PREM[1]
        L_SUBTOTAL_PRCO = L_SUBTOTAL_PRCO + cppfarmliab:PREM[2]

        Writefile(L_FILE_NAME,"%s","<033>&a5100h-20V")
        l_endorsement_total = l_endorsement_total + cppfarmliab:total_endorsEments + cppfarmliab:TOTAL_MISC
        if (len(trun(cpsclass:description))) > 80 then
          Writefile(L_FILE_NAME,"%s","<033>&a200h+120V")
      Next cppfarmliab
    }

  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
  Writefile(L_FILE_NAME,"%s","<033>&a3000h+180V")
  Writefile(L_FILE_NAME,"%s","Prem Ops and Pr/Co Premium")
  Writefile(L_FILE_NAME,"%s","<033>&a4600h+0V")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
  Writefile(L_FILE_NAME,"%s","$")
  Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
  Writefile(L_FILE_NAME,"%s",Str(L_SUBTOTAL_PREM,"ZZZ,ZZZ"))

  Writefile(L_FILE_NAME,"%s","<033>&a5115h+0V")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
  Writefile(L_FILE_NAME,"%s","$")
  Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
  Writefile(L_FILE_NAME,"%s",Str(L_SUBTOTAL_PRCO,"ZZZ,ZZZ"))

  L_LINE_COUNTER = L_LINE_COUNTER + 1
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
  Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
  Writefile(L_FILE_NAME,"%s","Endorsement Premium")
  Writefile(L_FILE_NAME,"%s","<033>&a4900h+0V")
  Writefile(L_FILE_NAME,"%s","$")
  Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
  Writefile(L_FILE_NAME,"%s",Str(l_endorsement_total,"ZZZ,ZZZ"))

  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
  Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
  Writefile(L_FILE_NAME,"%s","Total Advance Premium")
  Writefile(L_FILE_NAME,"%s","<033>&a4900h+0V")
  Writefile(L_FILE_NAME,"%s","$")
  Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
  Writefile(L_FILE_NAME,"%s",Str(SFPMASTER:TOTAL[10],"ZZZ,ZZZ"))

  If SFPMASTER:MINIMUM_PREMIUM[5] = "Y" Then
    {
      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
      Writefile(L_FILE_NAME,"%s"," MP")
    }
}

End
